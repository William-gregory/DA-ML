<?xml version="1.0"?> <!-- FRE Usage documentation: http://www.gfdl.noaa.gov/fms/fre --> <!-- Quick start guide
=================
1;95;0c
module load fre/bronx-19
fremake -x OM4_1deg_SICDA-MLexp2.xml -p ncrc4.intel16 -t repro,openmp OM4_1deg_K_nonsymMOM6_ens_exec_OM4
frerun  -x OM4_1deg_SICDA-MLexp2.xml -p ncrc4.intel18 -t repro,openmp OM4_1deg_JRA_SICDA-ML2_F02 -q urgent 

```
use SPEAR_K_nonsymMOM6_exec_OM4 here for ocean only


SPEAR (Seamless system for Predictions and EArth system Research)

The experiment name `SPEAR_c96_o1_Control_1850_A01` has the following meanings:
  * `c96` means atmosphere has c96 resolution
  * `o1` means 1 degree ocean model
  * `Control_1850`  means constant 1850 radiative forcing
  * `A` is a letter for whatever code version you have
  * `01` indicates the parameter settings ("01" will indicate that we are using the
    same settings as "C39", but this gives the flexibility for future physics changes)

SPEAR_c96_o1_Hist_AllForc_IC1851_A01_ens_01
  * `c96`, `o1`, `A01` same meanings as before
  * `Hist_AllForc_IC1851` indicate it is a historical run using All Forcings, and starts from 1851
  * `ens_01` indicates it is a single ensemble member; we could also have ens_02, ens_03, etc, as
    individual ensemble members

SPEAR_c96_o1_Hist_AllForc_IC1851_A01_ens_01_05
  * `ens_01_05` single job run as 5 member ensemble, historical run using All Forcings, starting from 1851

SPEAR_c96_o1_Control_1850_A01_IC101_1PctTo2_ens2X
  * single job running idealized 1% per year CO2 increase to doubling, starting from year 101 of an 1850 control

SPEAR_c96_pres_SST_HIST_AllForc_IC1979_A01_ens_01
  * AMIP style run with prescribed SSTs, historical radiative forcing

SPEAR_c96_oml1_Control_2010_A01
  * atmosphere coupled to ocean mixed layer model, 1 degree resolution (oml1), with constant 2010 radiative forcing

SPEAR_c192_omlp25_Control_2010_A01
  * c192 atmosphere coupled to ocean mixed layer model, 0.25 degree resolution, with constant 2010 radiative forcing
-->

<experimentSuite rtsVersion="4" xmlns:xi="http://www.w3.org/2001/XInclude">

  <!--User should set the following properties according to the plan for the production run-->	

  <!-- Properties for the source code versions -->
  <property name="RELEASE" value="xanadu" />                   <!-- Default git branch/tag for source code -->
  <property name="MOM6_DATE"    value=""/>              <!-- git tag date for MOM6 source code -->
  <property name="MOM6_GIT_TAG" value="om4/v1.0.4"/> <!-- git tag for MOM6 source code -->
  <property name="AWG_GIT_TAG"  value="$(RELEASE)"/>           <!-- git tag for AWG source code -->
  <property name="LAND_GIT_TAG"  value="$(RELEASE)"/>    <!-- git tag for Land source code -->
  <property name="OM4_ANALYSIS" value="ice_ocean_SIS2/OM4_025"/>  <!--example containing .frepp scripts for analysis-->

  <!-- FRE specific properties -->
  <property name="FRE_STEM" value="SPEAR_experiments_K_xanadu" />   <!-- Stem use in FRE directories -->
  <property name="FRE_VERSION" value="bronx-19" />              <!-- FRE version for use in this XML -->
  <property name="ANALYSIS_SWITCH" value="on"/>
  <property name="ANALYSIS_ESM_SWITCH" value="off"/>
  <property name="MDBIswitch" value="off"/>                       <!-- on/off switch for MDBI database -->

  <property name="PROD_SIMTIME"     value="40"/>   <!--simulation length in years-->
  <property name="fyear"       value="1958"/>
  <property name="PP_START_YEAR"   value="1958"/>
  <property name="PP_START_YEAR_HIST"   value="1958"/>

  <property name="PP_AMIP_CHUNK" value="5yr"/>
  <property name="PP_AMIP_START_YEAR"  value="1981"/>
  <property name="ANA_AMIP_START" value="1981"/>
  <property name="ANA_AMIP_END"   value="2011"/>
  <property name="ANA_AMIP_LEN"   value="30yr"/>

   <property name="CHUNK_LENGTH_A" value="1yr"/>
   <property name="CHUNK_LENGTH_B" value="100yr"/>
   <property name="CHUNK_LENGTH_C" value="1000yr"/>
   <property name="CHUNK_LENGTH_A_c384" value="10yr"/>
   <property name="CHUNK_LENGTH_B_c384" value="100yr"/>
   <property name="CHUNK_LENGTH_C_c384" value="1000yr"/>
   <property name="ANA_START" value="1"/>
   <property name="ANA_END"   value="40"/> <!-- Same as CHUNK_LENGTH_B -->

  <property name="PROD_RUNTIME"     value="16:00:00"/><!--Maximum wall clock per simulation-->
  <property name="PROD_SEGTIME"     value="01:30:00"/><!--Wall clock per segment (usually 1 year)-->

  <!--The following properties need to be set only if the user wants to monitor the run progress at MDBI
      and are not needed for the run or post-processing -->   
  <property name="EXP_CPLD_START"   value="1958"/> <!--simulation start year--> 
  <property name="EXP_CPLD_END"     value="2008"/> <!--simulation end   year--> 

  <property name="PLATFORM_GS_GFDL" value="/archive/h1g/INPUT/c96_awg" />
  <property name="PLATFORM_GS_GAEA" value="$DEV/Huan.Guo/INPUT/grid" />

  <!--The rest of the properties need not to be changed by the user unless to customize the run-->

 
  <!-- Reference release tag for existing files in the archives for answer comparison. Used in "REFERENCE" property. -->
  <property name="reference_tag"   value="verona_answers"/>
                          
  <property name="DEBUGLEVEL" value="_0"/>
  <property name="PLATINFO"   value=""/>  <!--This is necessary only if you want to run exact same experiment on multiple platforms-->
                                          <!--In that case you will need to put an identifier string for the value to distinguish the /nbhome-->
  <!--property name="JRA_dataset"  value="/lustre/f2/dev/Niki.Zadeh/archive/gold/datasets/reanalysis/JRA55-do-1-3/v20180412/padded_dataset"/-->
  <property name="JRA_dataset"  value="/lustre/f2/dev/Raphael.Dussin/forcings/JRA55v1.5.0/pad_JRA/padded/"/>
  <property name="append_to_setup_csh"  value="set fyear=1958"/><!--The start year of forcing dataset-->

  <!--========================================-->
  <!--Do not change the rest of the properties-->
  <!--========================================-->

<!--
GFDL FAIR USE POLICY

GFDL recognizes the essential nature of collaboration in the scientific
enterprise, including the importance of novel application and analysis of our
models. In order to maximize mutual benefit from collaboration, the use of
experimental GFDL models** should be done in a manner that ensures that
individuals involved in model development receive proper credit for their
work; in order to minimize the potential for misapplication of experimental
models, collaborations should actively engage model developers. Publication of
results using experimental GFDL models should be done in consultation with
scientists that participated in the model development. Consultation with GFDL
model developers should occur before submission of publications based on
experimental GFDL models, and should include agreement on the appropriate level
of acknowledgment, co-authorship and participation by the model developers.
Since experimental models have not been thoroughly vetted, experimental GFDL
models and their output should be distributed only after consultation with the
developers of the model. After a GFDL model has been described in a
peer-reviewed publication it is no longer experimental, and results based on
the model should cite the publication(s) describing the model.

** "Experimental GFDL models" refers to models (e.g., a coupled climate model),
model components (e.g., parameterization schemes), model configurations (e.g.,
the specific arrangement and parameter settings of model components) arising
from model development efforts at GFDL, but whose formulation and configuration
have not yet been documented in the peer-reviewed literature, as well as outputs
from integrations with these models.
-->

<!--====================-->
<!--= AMIP EXPERIMENTS =-->
<!--====================-->

<!--
AMIP simulations are configured to start in 1980 with the first year being a
spin-up year. Postprocessing and analysis are performed starting in 1981. The
length of the simulation and analysis period can be controlled by changing
properties below.
-->



   <!--Users need not change the following properties -->
   <property name="LIBS_ROOT"   value="OM4_1deg_K_ens_nonsymMOM6"/>
   <property name="FMS_LIB_DIR" value="./$(LIBS_ROOT)/$(platform)-$(target)/exec"/>
   <property name="LIBS_ROOT_NONSYM"   value="OM4_1deg_K_ens_nonsymMOM6"/>
   <property name="FMS_LIB_DIR_NONSYM" value="./$(LIBS_ROOT_NONSYM)/$(platform)-$(target)/exec"/>
   

   <!-- The following properties are for testing/debugging purposes and should normally be empty-->
   <property name="MODIFIER"     value=""/>  

  <setup>
    <fmsRelease>riga</fmsRelease>

<!--=================-->
<!--= CHANGING NPES =-->
<!--=================-->

<!--
This xml includes a number of predefined options for the number of PEs.
Changing the number of PEs can be accomplished by simply
modifying 'npes' and segment 'runTime' in the xml <production> block:

    <production simTime="$(EXP_AMIP_LEN)" units="years" npes="864" runTime="16:00:00">
      <segment simTime="12" units="months" runTime="1:30:00"/>
    </production>

Choosing a particular PE number is a balancing act. The higher npes,
the faster the model throughput, but also the lower the model efficiency
(i.e. the overall simulation will cost more in terms of core hours).


Available options for c96L33:
"""""""""""""""""""""""""""""

  +========+======================+====================+
  |        |  Suggested run time for 12 month segment  |
  |        |  layout      |     c3       |     c4      |
  +========+==============+==============+=============+
  |   108  |  A36x2_O36   |              |  13:30:00   |
  |   128  |  A60x1_O64   |  14:50:00    |             |
  |   144  |  A36x2_O72   |              |  12:50:00   |
  |   144  |  A54x2_O36   |              |  10:45:00   |
  |   160  |  A48x2_O64   |  10:45:00    |             |
  |   216  |  A60x2_O96   |  08:40:00    |             |
  |   216  |  A72x2_O72   |              |  06:50:00   |
  |   252  |  A72x2_O108  |              |  06:20:00   |
  |   288  |  A96x2_O96   |  06:10:00    |             |
  |   288  |  A108x2_O72  |              |  05:40:00   |
  |   324  |  A108x2_O108 |              |  05:00:00   |
  |   368  |  A120x2_O128 |  05:00:00    |             |
  |   416  |  A144x2_O128 |  04:20:00    |             |
  |   432  |  A144x2_O144 |              |  03:50:00   |
  |   828  |  A288x2_O252 |  03:10:00    |             |
  |   832  |  A288x2_O256 |              |  02:45:00   |
  |   864  |  A288x2_O288 |              |  02:30:00   |
  |  1296  |  A432x2_O432 |              |  02:00:00   |
  |  1312  |  A432x2_O448 |  03:00:00    |             |
  |  1344  |  A432x2_O480 |  02:30:00    |             |
  |  1656  |  A576x2_O504 |              |  01:45:00   |
  |  1664  |  A576x2_O512 |  02:30:00    |             |
  |  1688  |  A576x2_O540 |              |  01:45:00   |
  |  1696  |  A576x2_O544 |  02:30:00    |             |
  |  2496  |  A864x2_O756 |  02:15:00    |  01:40:00   |
  |  2592  |  A864x2_O864 |  02:15:00    |  01:35:00   |
  +========+==============+==============+=============+

**Note:** default settings are highlighted in **bold**. Suggested
run time values may need to be adjusted for your specific
configuration.
-->

    <!-- GFDL Analysis/PP Platforms -->

    <platform name="gfdl.postprocess">
      <freVersion>$(FRE_VERSION)</freVersion>

      <property name="NB_ROOT"            value="/nbhome/$USER/$(FRE_STEM)$(DEBUGLEVEL)/$(name)"/>
      <property name="F2003_FLAGS"        value="-DINTERNAL_FILE_NML"/>
      <property name="AWG_ARCHIVE_ROOT"   value="/archive/cjg/mdt"/>
      <property name="LWH_ARCHIVE_ROOT"   value="/archive"/>
      <property name="CMIP6_ARCHIVE_ROOT" value="/archive/oar.gfdl.cmip6/datasets"/>
      <property name="NCORE_PER_NODE"     value="1"/>
      <property name="platform_gs"        value="$(PLATFORM_GS_GFDL)"/>

      <directory stem="$(FRE_STEM)" >
        <root>/home/$USER/SPEAR</root>
        <archive>/archive/$USER/SPEAR/$(name)</archive>
        <include>$(rootDir)/SPEAR_include</include> 
        <analysis>/nbhome/$USER/$(stem)/$(name)</analysis>
      </directory>

      <csh><![CDATA[
        module load git
        setenv NBROOT $(NB_ROOT)
        setenv FREVERSION fre/$(FRE_VERSION)
        ]]>
      </csh>
    </platform>

    <platform name="gfdl.ncrc3-intel">
      <xi:include xpointer="xpointer(//setup/platform[@name='gfdl.postprocess']/node())" />
    </platform>

    <platform name="gfdl.ncrc3-intel16">
      <xi:include xpointer="xpointer(//setup/platform[@name='gfdl.postprocess']/node())" />
    </platform>

    <platform name="gfdl.ncrc4-intel">
      <xi:include xpointer="xpointer(//setup/platform[@name='gfdl.postprocess']/node())" />
    </platform>

    <platform name="gfdl.ncrc4-intel16">
      <xi:include xpointer="xpointer(//setup/platform[@name='gfdl.postprocess']/node())" />
    </platform>

    <platform name="gfdl.ncrc4-intel18">
      <xi:include xpointer="xpointer(//setup/platform[@name='gfdl.postprocess']/node())" />
    </platform>

    <platform name="gfdl.ncrc4-gnu">
      <xi:include xpointer="xpointer(//setup/platform[@name='gfdl.postprocess']/node())" />
    </platform>

    <!-- NCRC Platforms -->
    <platform name="ncrc3.intel16">
      <freVersion>$(FRE_VERSION)</freVersion>
      <compiler type="intel" version="16.0.3.210" />

      <property name="F2003_FLAGS"      value="-DINTERNAL_FILE_NML"/>
      <property name="AWG_ARCHIVE_ROOT"   value="/lustre/f2/pdata/gfdl/gfdl_M/cjg/archive/mdt"/>
      <property name="LWH_ARCHIVE_ROOT"  value="$PDATA/gfdl/gfdl_M"/>
      <property name="NCORE_PER_NODE"      value="32"/>
      <property name="CMIP6_ARCHIVE_ROOT"   value="$PDATA/gfdl/cmip6/datasets"/>
      <property name="NB_ROOT"          value="/nbhome/$USER/$(FRE_STEM)$(DEBUGLEVEL)/$(name)"/>
      <property name="platform_gs"      value="$(PLATFORM_GS_GAEA)"/>
 
      <project>gfdl_o</project>

      <directory stem="$(FRE_STEM)">
        <scripts>$CTMP/unswept/$USER/SPEAR/$(name)/$(platform)-$(target)/scripts</scripts>
        <include>$(xmlDir)/SPEAR_include</include>
      </directory>

      <!-- Uncomment the <csh> section if needing to run with DDT -->
      <!--
      <csh><![CDATA[
         module load ddt
         setenv DDTMPIRUN /opt/cray/alps/default/bin/aprun
         alias runCommand ddt  -n $npes  ./$executable:t 
        ]]>
      </csh>
      -->
    </platform>

    <platform name="ncrc3.intel">
      <xi:include xpointer="xpointer(//setup/platform[@name='ncrc3.intel16']/node())" />
    </platform>

    <platform name="ncrc4.intel16">
      <freVersion>$(FRE_VERSION)</freVersion>
      <compiler type="intel" version="16.0.3.210" />
      <property name="EXEC_ROOT"          value="/lustre/f2/dev/$USER/$(stem)"/>
      <property name="F2003_FLAGS"      value="-DINTERNAL_FILE_NML"/>
      <property name="AWG_ARCHIVE_ROOT"  value="/lustre/f2/pdata/gfdl/gfdl_M/cjg/archive/mdt"/>
      <property name="LWH_ARCHIVE_ROOT"  value="$PDATA/gfdl/gfdl_M"/>
      <property name="CMIP6_ARCHIVE_ROOT"   value="$PDATA/gfdl/cmip6/datasets"/>
      <property name="NB_ROOT"          value="/nbhome/$USER/$(FRE_STEM)$(DEBUGLEVEL)/$(name)"/>
      <property name="platform_gs"      value="$(PLATFORM_GS_GAEA)"/>
      <property name="NCORE_PER_NODE"      value="36"/>
      <project>gfdl_o</project>

      <directory stem="$(FRE_STEM)">
        <root>/lustre/f2/dev/$USER/$(FRE_STEM)</root>
        <scripts>/lustre/f2/dev/$USER/$(FRE_STEM)$(DEBUGLEVEL)/$(name)/$(platform)-$(target)/scripts</scripts>
        <state>/lustre/f2/dev/$USER/$(FRE_STEM)$(DEBUGLEVEL)/$(name)/$(platform)-$(target)/state</state>
        <src>/lustre/f2/dev/$USER/$(FRE_STEM)/$(name)/src</src>
        <exec>/lustre/f2/dev/$USER/$(FRE_STEM)/$(name)/$(platform)-$(target)/exec</exec>
        <archive>/lustre/f2/scratch/$USER/$(stem)$(DEBUGLEVEL)/$(name)/$(platform)-$(target)/archive</archive>
        <work>/lustre/f2/scratch//$USER/work/$(stem)/$FRE_JOBID</work>
        <include>$HOME/xml/SPEAR_include</include>
      </directory>

      <!-- Uncomment the <csh> section if needing to run with DDT -->
      <!--
      <csh><![CDATA[
         module load ddt
         setenv DDTMPIRUN /opt/cray/alps/default/bin/aprun
         alias runCommand ddt  -n $npes  ./$executable:t 
        ]]>
      </csh>
      -->
    </platform>

    <platform name="ncrc4.intel18">
      <freVersion>$(FRE_VERSION)</freVersion>
      <compiler type="intel" version="18.0.6.288" />

      <property name="F2003_FLAGS"      value="-DINTERNAL_FILE_NML"/>
      <property name="WFC_ARCHIVE_ROOT"  value="/lustre/f2/dev/gfdl/William.Cooke"/>
      <property name="DJP_ARCHIVE_ROOT"  value="/lustre/f2/pdata/gfdl/gfdl_M/David.Paynter"/>
      <property name="CMIP6_ARCHIVE_ROOT"   value="$PDATA/gfdl/cmip6/datasets"/>
      <!-- Change the following to lustre/f2/pdata/gfdl_SD when it becomes available. -->
      <property name="NCORE_PER_NODE"      value="32"/>
      <!-- Change the following to lustre/f2/pdata/gfdl_SD when it becomes available. -->
      <property name="NB_ROOT"          value="/nbhome/$USER/$(FRE_STEM)$(DEBUGLEVEL)/$(name)"/>

      <project>gfdl_o</project>

      <directory stem="$(FRE_STEM)">
        <scripts>/lustre/f2/dev/gfdl/$USER/SPEAR/$(name)/$(platform)-$(target)/scripts</scripts>
        <include>$(xmlDir)/SPEAR_include</include>
        <!--
        <include>$HOME/SPEAR/SPEAR_include</include>
        -->
      </directory>

    </platform>
    <platform name="ncrc4.intel">
      <xi:include xpointer="xpointer(//setup/platform[@name='ncrc4.intel16']/node())" />
    </platform>

    <platform name="ncrc4.gnu">
      <freVersion>$(FRE_VERSION)</freVersion>
      <compiler type="gnu" version="7.2.0" />

      <property name="F2003_FLAGS"      value="-DINTERNAL_FILE_NML"/>
      <property name="AWG_ARCHIVE_ROOT"  value="/lustre/f2/pdata/gfdl/gfdl_M/cjg/archive/mdt"/>
      <property name="LWH_ARCHIVE_ROOT"  value="$PDATA/gfdl/gfdl_M"/>
      <property name="CMIP6_ARCHIVE_ROOT"   value="$PDATA/gfdl/cmip6/datasets"/>
      <property name="NCORE_PER_NODE"      value="36"/>
      <property name="NB_ROOT"          value="/nbhome/$USER/$(FRE_STEM)$(DEBUGLEVEL)/$(name)"/>
      <property name="platform_gs"      value="$(PLATFORM_GS_GAEA)"/>
 
      <project>gfdl_o</project>

      <directory stem="$(FRE_STEM)">
        <scripts>$CTMP/unswept/$USER/SPEAR/$(name)/$(platform)-$(target)/scripts</scripts>
        <include>$(xmlDir)/SPEAR_include</include>
        <!--
        <include>$HOME/SPEAR/SPEAR_include</include>
        -->
      </directory>
    </platform>

  </setup>

<!--===========-->
<!--= COMPILE =-->
<!--===========-->

  <!--The property MOM6_EXAMPLES should point to the mom6 directory that is checked out. It is needed by MOM6 to access its inpu data files-->
   <property name="MOM6_EXAMPLES"  value="$root/$(LIBS_ROOT)/src/mom6"/>

  <experiment name="OM4_1deg_K_nonsymMOM6_ens_exec_OM4_noleap_sstrest_Mar2022">
    <description>
      Experiment to build executable. See git log for source code provenance.
    </description>

    <component name="fms"
               paths="shared">
      <description domainName="infrastructure"
                   communityName="FMS"
                   communityVersion="$(RELEASE)"
                   communityGrid=""/>
      <source versionControl="git"
              root="http://gitlab.gfdl.noaa.gov/fms">
        <codeBase version="$(RELEASE)">
          shared.git
        </codeBase>
      </source>
      <compile>
        <cppDefs>
          $(F2003_FLAGS)
          -Duse_libMPI
          -Duse_netCDF
          -DMAXFIELDMETHODS_=500
        </cppDefs>
      </compile>
    </component>

    <component name="atmos_null"
               requires="fms"
               paths="atmos_null
                      atmos_param/monin_obukhov
		      atmos_param/diag_integral">
      <description domainName=""
                   communityName=""
                   communityVersion="$(RELEASE)"
                   communityGrid=""/>
      <source versionControl="git"
              root="http://gitlab.gfdl.noaa.gov/fms">
        <codeBase version="$(RELEASE)">
          atmos_null.git
          atmos_param.git
        </codeBase>
      </source>
      <compile>
        <cppDefs>
          $(F2003_FLAGS)
          -DCLUBB
          -DAM3_CHEM
        </cppDefs>
      </compile>
    </component>

    <component name="land_null"
               requires="fms"
               paths="land_null">
      <description domainName="NA"
                   communityName="NA"
                   communityVersion="NA"
                   communityGrid="NA"/>
      <source versionControl="git"
              root="http://gitlab.gfdl.noaa.gov/fms">
        <codeBase version="$(RELEASE)">
          land_null.git
        </codeBase>
      </source>
      <compile doF90Cpp="yes">
        <cppDefs>
          $(F2003_FLAGS)
          -nostdinc
        </cppDefs>
      </compile>
    </component>

    <component name="mom6"
               requires="fms"
               paths="MOM6/config_src/dynamic
                      MOM6/config_src/coupled_driver
                      MOM6/src/*/
                      MOM6/src/*/*/ ">
      <description domainName="Ocean"
                   communityName="GFDL-MOM6"
                   communityVersion="$(MOM6_GIT_TAG)"
                   communityGrid="Tripolar"/>
      <source versionControl="git"
              root="https://github.com/NOAA-GFDL">
        <codeBase version="dev/gfdl">
          MOM6.git
        </codeBase>
      </source>
      <compile>
        <cppDefs><![CDATA[
          $(F2003_FLAGS)
          -DMAX_FIELDS_=100
          ]]>
        </cppDefs>
         <makeOverrides>OPENMP=""</makeOverrides> <!-- openmp switch for MOM6 may cause crash -->
      </compile>
    </component>

  <component name="ice_param"
               requires="fms"
               paths="ice_param"
               includeDir="$(srcDir)/shared/include">
      <source versionControl="git"
              root="https://gitlab.gfdl.noaa.gov/fms">
        <codeBase version="$(RELEASE)">
          ice_param.git
        </codeBase>
      </source>
      <compile>
        <cppDefs><![CDATA[
          $(F2003_FLAGS)
          ]]>
        </cppDefs>
      </compile>
    </component>

    <component name="sis2"
               requires="fms
                         mom6
                         ice_param
                         icebergs"
               paths="SIS2/config_src/dynamic_symmetric
                      SIS2/src"
               includeDir="$(srcDir)/MOM6/src/framework" >
      <source versionControl="git"
              root="https://github.com/NOAA-GFDL">
        <codeBase version="dev/gfdl">
          SIS2.git
        </codeBase>
        <csh><![CDATA[
#          ( cd sis2 && git checkout ec1d06f )
          ]]>
        </csh>
      </source>
      <compile>
        <cppDefs><![CDATA[
          $(F2003_FLAGS)
          -DSYMMETRIC_MEMORY_
          ]]>
        </cppDefs>
      </compile>
    </component>

    <component name="icebergs"
               requires="fms"
               paths="icebergs">
      <description domainName="N/A"
                   communityName="N/A"
                   communityVersion="$(RELEASE)"
                   communityGrid="N/A"/>
      <source versionControl="git"
              root="http://github.com/NOAA-GFDL">
        <codeBase version="dev/gfdl">
          icebergs.git
        </codeBase>
        <csh><![CDATA[
#          ( cd icebergs && git checkout 9debf320 )
          ]]>
        </csh>
      </source>
      <compile>
        <cppDefs><![CDATA[
          ]]>
        </cppDefs>
      </compile>
    </component>

    <component name="coupler"
               paths="coupler"
               requires="fms
                         land_null
                         atmos_null
                         sis2
                         mom6
                         icebergs">
      <description domainName="FMS Coupler"
                   communityName="coupler"
                   communityVersion="$(RELEASE)"
                   communityGrid=""/>
      <source versionControl="git"
              root="http://gitlab.gfdl.noaa.gov/fms">
        <codeBase version="$(RELEASE)"> coupler.git </codeBase>
      </source>
      <compile>
        <cppDefs><![CDATA[
          $(F2003_FLAGS) -D_USE_LEGACY_LAND_ -Duse_AM3_physics -D_FILE_VERSION="'"`git-version-string $<`"'"
          ]]>
        </cppDefs>
      </compile>
    </component>
  </experiment>

  <freInclude name="JRA_data_table">
    <input>
      <dataTable>
"ATM" , "p_surf"        , "psl"     , "./INPUT/JRA_psl.nc"   , "bilinear" ,  1.0
"ATM" , "p_bot"         , "psl"     , "./INPUT/JRA_psl.nc"   , "bilinear" ,  1.0
"ATM" , "t_bot"         , "tas"     , "./INPUT/JRA_tas.nc"   , "bilinear" ,  1.0
"ATM" , "sphum_bot"     , "huss"    , "./INPUT/JRA_huss.nc"  , "bilinear" ,  1.0
"ATM" , "u_bot"         , "uas"     , "./INPUT/JRA_uas.nc"   , "bicubic",    1.0
"ATM" , "v_bot"         , "vas"     , "./INPUT/JRA_vas.nc"   , "bicubic",    1.0
"ATM" , "z_bot"         , ""            , ""             , "bilinear" ,  10.0
"ATM" , "gust"          , ""            , ""             , "bilinear" ,  1.0e-4
"ICE" , "lw_flux_dn"    , "rlds"    , "./INPUT/JRA_rlds.nc"  , "bilinear" ,  1.0
"ICE" , "sw_flux_vis_dir_dn", "rsds", "./INPUT/JRA_rsds.nc"  , "bilinear" ,  0.285
"ICE" , "sw_flux_vis_dif_dn", "rsds", "./INPUT/JRA_rsds.nc"  , "bilinear" ,  0.285
"ICE" , "sw_flux_nir_dir_dn", "rsds", "./INPUT/JRA_rsds.nc"  , "bilinear" ,  0.215
"ICE" , "sw_flux_nir_dif_dn", "rsds", "./INPUT/JRA_rsds.nc"  , "bilinear" ,  0.215
"ICE" , "lprec"         , "prra"    , "./INPUT/JRA_prra.nc"  , "bilinear" ,  0.9933
"ICE" , "fprec"         , "prsn"    , "./INPUT/JRA_prsn.nc"  , "bilinear" ,  0.9933
"ICE" , "runoff"        , "runoff"      , "./INPUT/runoff_2017_11_30_modbegin_1958.nc", "none" ,  1.0
"ICE" , "calving"       , ""            , ""                             , "none"  ,  0.0
"ICE" , "dhdt"          , ""            , ""                             , "none"  , 80.0
"ICE" , "dedt"          , ""            , ""                             , "none"  ,  2.0e-6
"ICE" , "drdt"          , ""            , ""                             , "none"  ,  10.0
"LND" , "t_surf"        , ""            , ""                             , "none"  ,  273.0
"LND" , "t_ca"          , ""            , ""                             , "none"  ,  273.0
"LND" , "q_ca"          , ""            , ""                             , "none"  ,  0.0
"LND" , "rough_mom"     , ""            , ""                             , "none"  ,  0.01
"LND" , "rough_heat"    , ""            , ""                             , "none"  ,  0.1
"LND" , "albedo"        , ""            , ""                             , "none"  ,  0.1
#"LND" , "t_ca"         , ""            , ""                             , "none"  ,  273.0
#"LND" , "t_surf"       , ""            , ""                             , "none"  ,  273.0
"LND" , "sphum_surf"    , ""            , ""                             , "none"  ,  0.0
"LND" , "sphum_ca"      , ""            , ""                             , "none"  ,  0.0
"LND" , "t_flux"        , ""            , ""                             , "none"  ,  0.0
"LND" , "sphum_flux"    , ""            , ""                             , "none"  ,  0.0
"LND" , "lw_flux"       , ""            , ""                             , "none"  ,  0.0
"LND" , "sw_flux"       , ""            , ""                             , "none"  ,  0.0
"LND" , "lprec"         , ""            , ""                             , "none"  ,  0.0
"LND" , "fprec"         , ""            , ""                             , "none"  ,  0.0
"LND" , "dhdt"          , ""            , ""                             , "none"  ,  5.0
"LND" , "dedt"          , ""            , ""                             , "none"  ,  2e-6
"LND" , "dedq"          , ""            , ""                             , "none"  ,  0.0
"LND" , "drdt"          , ""            , ""                             , "none"  ,  5.0
"LND" , "drag_q"        , ""            , ""                             , "none"  ,  0.0
"LND" , "p_surf"        , ""            , ""                             , "none"  ,  1.e5
      </dataTable>
    </input>
   </freInclude>

<!--============================-->
<!--= TEMPLATES FOR INPUT DATA =-->
<!--============================-->
  <freInclude name="common_LM4">
    <input>
      <dataFile label="input" target="INPUT/soil_type.nc" chksum="" size="" timestamp="">
         <dataSource platform="$(platform)">$PDATA/gfdl/cmip6/datasets/CM4/common/common_LM4/soil_type_hwsd_5minute.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$PDATA/gfdl/cmip6/datasets/CM4/common/common_LM4/biodata.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$PDATA/gfdl/cmip6/datasets/CM4/common/common_LM4/cover_type.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$PDATA/gfdl/cmip6/datasets/CM4/common/common_LM4/geohydrology.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$PDATA/gfdl/cmip6/datasets/CM4/common/common_LM4/geohydrology_table_2a2n.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$PDATA/gfdl/cmip6/datasets/CM4/common/common_LM4/ground_type.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$PDATA/gfdl/cmip6/datasets/CM4/common/common_LM4/landuse.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$PDATA/gfdl/cmip6/datasets/CM4/common/common_LM4/soil_brdf.nc</dataSource>
      </dataFile>
    </input>
  </freInclude>

 <freInclude name="c96_LM4_SPEAR">
    <input>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$PDATA/gfdl/gfdl_M/Huan.Guo/INPUT/drag/c96_topo_rough_land.nc.tar</dataSource>
      </dataFile>
    </input>
  </freInclude>

 <freInclude name="c192_LM4_SPEAR">
    <input>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource site="ncrc">/lustre/f2/dev/William.Cooke/MOM6_datasets/C192_OM360x320.080417/SPEAR_c192_hydrography_with_gage.tar</dataSource>
        <dataSource site="gfdl">/archive/wfc/gold/datasets/LOAR4/C192.OM360x320.080417/LOAR4_extended_c192_hydrography.tar</dataSource> 
      </dataFile>

     <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$DEV/Huan.Guo/INPUT/drag/c192_topo_rough_land.nc.tar</dataSource>
     </dataFile> 
    </input>
  </freInclude>

 <freInclude name="c384_LM4_SPEAR">
    <input>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource site="ncrc">/lustre/f2/dev/William.Cooke/MOM6_datasets/C384_OM360x320.20180503/SPEAR_c384_hydrography.v20180510.tar</dataSource>
        <dataSource site="gfdl">/archive/William.Cooke/gold/datasets/SPEAR/C384_OM360x320.20180503/SPEAR_c384_hydrography.v20180510.tar</dataSource> 
      </dataFile>

     <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">/lustre/f2/dev/Baoqiang.Xiang/archive/cm4_develop/C384/drag/c384_topo_rough_land.nc.tar</dataSource>
     </dataFile> 
    </input>
  </freInclude>

  <freInclude name="common_amip">
    <input>
      <dataTable>
"ICE", "sic_obs", "ice", "INPUT/hadisst_ice.data.nc", "bilinear", 0.01
"ICE", "sit_obs", "",    "INPUT/hadisst_ice.data.nc", "none",     2.0
"ICE", "sst_obs", "sst", "INPUT/hadisst_sst.data.nc", "bilinear", 1.0
"LND", "phot_co2","co2", "INPUT/co2_data.nc",         "bilinear", 1.e-6
      </dataTable>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
         <dataSource site="ncrc">/lustre/f2/pdata/gfdl/gfdl_M/cm3/ipcc_ar5/input/common/hadisst.186912-201301.tar</dataSource>
      </dataFile>
    </input>
  </freInclude>

  <freInclude name="common_cmip6">
    <input>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$PDATA/gfdl/cmip6/datasets/CM4/forcings/common_cmip6/cmip6_GHG_ODS_conc_2016.tar</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/chemlbf" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$PDATA/gfdl/cmip6/datasets/CM4/forcings/common_cmip6/chemlbf_CMIP6_merge_RCP45</dataSource>
      </dataFile>

      <dataFile label="input" target="INPUT/o3.climatology.nc" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$PDATA/gfdl/cmip6/datasets/CM4/forcings/common_cmip6/mmro3_CMIP6_184901-201512.nc</dataSource>
      </dataFile>

      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$PDATA/gfdl/cmip6/datasets/CM4/forcings/common_cmip6/emissions.isoprene.1x1.2000.nc</dataSource>
      </dataFile>
       <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$PDATA/gfdl/cmip6/datasets/CM4/forcings/common_cmip6/emissions.terpenes.1x1.2000.nc</dataSource>
      </dataFile>
   </input>
  </freInclude>

  <freInclude name="Volcano_Solar_TimeSeries_cmip6">
    <input>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$PDATA/gfdl/gfdl_M/David.Paynter/CMIP6_INPUT/Volcano/extsw_data.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$PDATA/gfdl/gfdl_M/David.Paynter/CMIP6_INPUT/Volcano/omgsw_data.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$PDATA/gfdl/gfdl_M/David.Paynter/CMIP6_INPUT/Volcano/asmsw_data.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$PDATA/gfdl/gfdl_M/David.Paynter/CMIP6_INPUT/Volcano/extlw_data.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$PDATA/gfdl/gfdl_M/David.Paynter/CMIP6_INPUT/Solar/lean_solar_spectral_data.dat</dataSource>
      </dataFile>
    </input>
  </freInclude>

  <freInclude name="Volcano_Solar_TimeSeries_cmip6_V2">
    <input>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$PDATA/gfdl/gfdl_M/David.Paynter/CMIP6_INPUT/Volcano_V2/extsw_data.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$PDATA/gfdl/gfdl_M/David.Paynter/CMIP6_INPUT/Volcano_V2/omgsw_data.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$PDATA/gfdl/gfdl_M/David.Paynter/CMIP6_INPUT/Volcano_V2/asmsw_data.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$PDATA/gfdl/gfdl_M/David.Paynter/CMIP6_INPUT/Volcano_V2/extlw_data.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$PDATA/gfdl/gfdl_M/David.Paynter/CMIP6_INPUT/Solar/lean_solar_spectral_data.dat</dataSource>
      </dataFile>
    </input>
  </freInclude>

  <freInclude name="Volcano_Solar_2010_cmip6">
    <input>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$PDATA/gfdl/gfdl_M/David.Paynter/CMIP6_INPUT/Volcano/AVG_2010/extsw_data.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$PDATA/gfdl/gfdl_M/David.Paynter/CMIP6_INPUT/Volcano/AVG_2010/omgsw_data.nc</dataSource>
      </dataFile>
        <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
      <dataSource platform="$(platform)">$PDATA/gfdl/gfdl_M/David.Paynter/CMIP6_INPUT/Volcano/AVG_2010/asmsw_data.nc</dataSource>
      </dataFile>
        <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
      <dataSource platform="$(platform)">$PDATA/gfdl/gfdl_M/David.Paynter/CMIP6_INPUT/Volcano/AVG_2010/extlw_data.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$PDATA/gfdl/gfdl_M/David.Paynter/CMIP6_INPUT/Solar/AVG_2010/lean_solar_spectral_data.dat</dataSource>
      </dataFile>
    </input>
  </freInclude>

  <freInclude name="Volcano_Solar_2010_cmip6_v2">
    <input>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$PDATA/gfdl/gfdl_M/David.Paynter/CMIP6_INPUT/Volcano_V2/AVG_2010/extsw_data.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$PDATA/gfdl/gfdl_M/David.Paynter/CMIP6_INPUT/Volcano_V2/AVG_2010/omgsw_data.nc</dataSource>
      </dataFile>
        <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
      <dataSource platform="$(platform)">$PDATA/gfdl/gfdl_M/David.Paynter/CMIP6_INPUT/Volcano_V2/AVG_2010/asmsw_data.nc</dataSource>
      </dataFile>
        <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
      <dataSource platform="$(platform)">$PDATA/gfdl/gfdl_M/David.Paynter/CMIP6_INPUT/Volcano_V2/AVG_2010/extlw_data.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$PDATA/gfdl/gfdl_M/David.Paynter/CMIP6_INPUT/Solar/AVG_2010/lean_solar_spectral_data.dat</dataSource>
      </dataFile>
    </input>
  </freInclude>

  <freInclude name="Volcano_Solar_1850_cmip6">
    <input>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$PDATA/gfdl/gfdl_M/David.Paynter/CMIP6_INPUT/Volcano/AVG_1850/extsw_data.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$PDATA/gfdl/gfdl_M/David.Paynter/CMIP6_INPUT/Volcano/AVG_1850/omgsw_data.nc</dataSource>
      </dataFile>
        <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
      <dataSource platform="$(platform)">$PDATA/gfdl/gfdl_M/David.Paynter/CMIP6_INPUT/Volcano/AVG_1850/asmsw_data.nc</dataSource>
      </dataFile>
        <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
      <dataSource platform="$(platform)">$PDATA/gfdl/gfdl_M/David.Paynter/CMIP6_INPUT/Volcano/AVG_1850/extlw_data.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$PDATA/gfdl/gfdl_M/David.Paynter/CMIP6_INPUT/Solar/AVG_1850/lean_solar_spectral_data.dat</dataSource>
      </dataFile>
    </input>
  </freInclude>

  <freInclude name="Volcano_Solar_1850_cmip6_v2">
    <input>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$(CMIP6_ARCHIVE_ROOT)/CM4/forcings/Volcano_Solar_1850_cmip6_v2/extsw_data.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$(CMIP6_ARCHIVE_ROOT)/CM4/forcings/Volcano_Solar_1850_cmip6_v2/omgsw_data.nc</dataSource>
      </dataFile>
        <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
      <dataSource platform="$(platform)">$(CMIP6_ARCHIVE_ROOT)/CM4/forcings/Volcano_Solar_1850_cmip6_v2/asmsw_data.nc</dataSource>
      </dataFile>
        <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
      <dataSource platform="$(platform)">$(CMIP6_ARCHIVE_ROOT)/CM4/forcings/Volcano_Solar_1850_cmip6_v2/extlw_data.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$(CMIP6_ARCHIVE_ROOT)/CM4/forcings/Volcano_Solar_1850_cmip6_v2/lean_solar_spectral_data.dat</dataSource>
      </dataFile>
    </input>
  </freInclude>

  <freInclude name="emissions_cmip6_v20170518">
    <input>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$(CMIP6_ARCHIVE_ROOT)/CM4/forcings/emissions_cmip6_v20170518/emissions.fastchem.0.5x0.5.1849-2017.tar</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/anthro_so2.1849_2017.nc" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$(CMIP6_ARCHIVE_ROOT)/CM4/forcings/emissions_cmip6_v20170518/emissions.simple.so2.0.5x0.5.1849-2017.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/co2_data.nc" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$PDATA/gfdl/gfdl_M/Huan.Guo/awg/input/cmip6/co2_data_2016.nc</dataSource>
      </dataFile>
    </input>
  </freInclude>

  <freInclude name="emissions_cmip6_v20161213">
    <input>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$PDATA/gfdl/gfdl_M/Vaishali.Naik/input/cmip6_forcing_dataset/emissions/v2016-12-13/1849_2016/emissions.0.5x0.5.1849-2016.tar</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/anthro_so2.1849_2016.nc" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$PDATA/gfdl/gfdl_M/Vaishali.Naik/input/cmip6_forcing_dataset/emissions/v2016-12-13/fast_chemistry/emissions.simple.so2.0.5x0.5.1849-2016.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/co2_data.nc" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$PDATA/gfdl/gfdl_M/Huan.Guo/awg/input/cmip6/co2_data_2016.nc</dataSource>
      </dataFile>
    </input>
  </freInclude>

<!--  <freInclude name="L32_gas_conc">
    <input>
      <dataFile label="input" target="INPUT/gas_conc_3D_am3p9.nc" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$(AWG_ARCHIVE_ROOT)/liteChem/input/aerosol/gas_conc_3D32L_am3p9.nc</dataSource>
      </dataFile>
    </input>
  </freInclude> -->

  <freInclude name="c96_stack_size">
    <input>
      <csh><![CDATA[
set domains_stack_size = "2097152"
      ]]></csh>
    </input>
  </freInclude>

  <freInclude name="c192_stack_size">
    <input>
      <csh><![CDATA[
set domains_stack_size = "3097152"
      ]]></csh>
    </input>
  </freInclude>

  <freInclude name="c384_stack_size">
    <input>
      <csh><![CDATA[
set domains_stack_size = "5097152"
      ]]></csh>
    </input>
  </freInclude>

<!--================================-->
<!--= LAYOUTS FOR C192 EXPERIMENTS =-->
<!--================================-->

   <freInclude name="resourceparams_A576x2_O108_production_c192">
             <resources jobWallclock="16:00:00"
                   segRuntime="4:20:00" >
               <atm ranks="576" threads="2"  layout = "8,12"   io_layout = "1,4" />
	       <lnd                          layout = "8,12"   io_layout = "1,4" />
	       <ice                          layout = "72,8"   io_layout = "1,1" />
	       <ocn ranks="108" threads="1"  layout = "12,9"   io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A576x4_O180_production_c192_c3">
             <resources jobWallclock="16:00:00"
                   segRuntime="4:00:00" >
               <atm ranks="576" threads="4"  layout = "8,12"   io_layout = "1,4" />
	       <lnd                          layout = "8,12"   io_layout = "1,4" />
	       <ice                          layout = "72,8"   io_layout = "1,1" />
	       <ocn ranks="180" threads="1"  layout = "9,20"   io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A576x4_O180_production_c192">
             <resources jobWallclock="15:00:00"
                   segRuntime="3:00:00" >
               <atm ranks="576" threads="4"  layout = "8,12"   io_layout = "1,4" />
	       <lnd                          layout = "8,12"   io_layout = "1,4" />
	       <ice                          layout = "72,8"   io_layout = "1,1" />
	       <ocn ranks="180" threads="1"  layout = "9,20"   io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A864x2_O180_production_c192">
             <resources jobWallclock="16:00:00"
                   segRuntime="4:30:00" >
               <atm ranks="864" threads="2"  layout = "12,12"  io_layout = "1,4" />
               <lnd                          layout = "12,12"  io_layout = "1,4" />
               <ice                          layout = "72,12"  io_layout = "1,1" />
               <ocn ranks="180" threads="1"  layout =  "9,20"  io_layout = "1,1" mask_table="MOM_mask_table" />
             </resources>
   </freInclude>

   <freInclude name="resourceparams_A864x4_O252_production_c192">
             <resources jobWallclock="16:00:00"
                   segRuntime="2:00:00" >
               <atm ranks="864" threads="4"  layout = "12,12"  io_layout = "1,4" />
               <lnd                          layout = "12,12"  io_layout = "1,4" />
               <ice                          layout = "72,12"  io_layout = "1,1" />
               <ocn ranks="252" threads="1"  layout = "18,14"  io_layout = "1,1" mask_table="MOM_mask_table" />
             </resources>
   </freInclude>

   <freInclude name="resourceparams_A288x1_O64_c192">
	     <resources jobWallclock="12:00:00">
               <atm ranks="288" threads="1"  layout = "6,8"   io_layout = "1,4" />
	       <lnd                          layout = "6,8"   io_layout = "1,4" />
	       <ice                          layout = "72,4"  io_layout = "1,1" />
	       <ocn ranks="64"  threads="1"  layout = "8,8"   io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A432x1_O64_c192">
	     <resources jobWallclock="12:00:00">
               <atm ranks="432" threads="1"  layout = "6,12"   io_layout = "1,4" />
	       <lnd                          layout = "6,12"   io_layout = "1,4" />
	       <ice                          layout = "72,6"  io_layout = "1,1" />
	       <ocn ranks="64"  threads="1"  layout = "8,8"   io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A576x1_O64_c192">
	     <resources jobWallclock="12:00:00">
               <atm ranks="576" threads="1"  layout = "8,12"   io_layout = "1,4" />
	       <lnd                          layout = "8,12"   io_layout = "1,4" />
	       <ice                          layout = "72,8"  io_layout = "1,1" />
	       <ocn ranks="64"  threads="1"  layout = "8,8"   io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A384x2_O64_c192">
	     <resources jobWallclock="10:00:00">
               <atm ranks="384" threads="2"  layout = "8,8"   io_layout = "1,4" />
	       <lnd                          layout = "8,8"   io_layout = "1,4" />
	       <ice                          layout = "48,8"  io_layout = "1,1" />
	       <ocn ranks="64"  threads="1"  layout = "8,8"   io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A432x2_O64_c192">
	     <resources jobWallclock="10:00:00">
               <atm ranks="432" threads="2"  layout = "6,12"   io_layout = "1,4" />
	       <lnd                          layout = "6,12"   io_layout = "1,4" />
	       <ice                          layout = "72,6"  io_layout = "1,1" />
	       <ocn ranks="64"  threads="1"  layout = "8,8"   io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A288x1_O72_c192">
	     <resources jobWallclock="08:00:00">
               <atm ranks="288" threads="1"  layout = "6,8"   io_layout = "1,4" />
	       <lnd                          layout = "6,8"   io_layout = "1,4" />
	       <ice                          layout = "72,4"  io_layout = "1,1" />
	       <ocn ranks="72"  threads="1"  layout = "12,6"   io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A432x1_O72_c192">
	     <resources jobWallclock="06:00:00">
               <atm ranks="432" threads="1"  layout = "6,12"   io_layout = "1,4" />
	       <lnd                          layout = "6,12"   io_layout = "1,4" />
	       <ice                          layout = "72,6"  io_layout = "1,1" />
	       <ocn ranks="72"  threads="1"  layout = "12,6"   io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A576x1_O72_c192">
	     <resources jobWallclock="06:00:00">
               <atm ranks="576" threads="1"  layout = "8,12"   io_layout = "1,4" />
	       <lnd                          layout = "8,12"   io_layout = "1,4" />
	       <ice                          layout = "72,8"  io_layout = "1,1" />
	       <ocn ranks="72"  threads="1"  layout = "12,6"   io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A384x2_O72_c192">
	     <resources jobWallclock="05:00:00">
               <atm ranks="384" threads="2"  layout = "8,8"   io_layout = "1,4" />
	       <lnd                          layout = "8,8"   io_layout = "1,4" />
	       <ice                          layout = "48,8"  io_layout = "1,1" />
	       <ocn ranks="72"  threads="1"  layout = "12,6"   io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A432x2_O72_c192">
	     <resources jobWallclock="05:00:00">
               <atm ranks="432" threads="2"  layout = "6,12"   io_layout = "1,4" />
	       <lnd                          layout = "6,12"   io_layout = "1,4" />
	       <ice                          layout = "72,6"  io_layout = "1,1" />
	       <ocn ranks="72"  threads="1"  layout = "12,6"   io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

<!--================================-->
<!--= LAYOUTS FOR C96 EXPERIMENTS  =-->
<!--================================-->

   <freInclude name="resourceparams_A108x2_O72_production">
	     <resources jobWallclock="8:00:00"
                   segRuntime="8:00:00" >
               <atm ranks="108" threads="2"   layout = "3,6"  io_layout = "1,1" />
	       <lnd                           layout = "3,6"  io_layout = "1,1" />
	       <ice                           layout = "54,2"  io_layout = "1,1" />
	       <ocn ranks="72"  threads="1"   layout = "6,12" io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A288x2_O180_production">
	     <resources jobWallclock="16:00:00"
                   segRuntime="2:40:00" >
               <atm ranks="288" threads="2"   layout = "6,8"   io_layout = "1,1" />
	       <lnd                           layout = "6,8"   io_layout = "1,1" />
	       <ice                           layout = "72,4" io_layout = "1,1" />
	       <ocn ranks="180" threads="1"   layout = "9,20"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A288x2_O180_production_c3">
	     <resources jobWallclock="16:00:00"
                   segRuntime="4:00:00" >
               <atm ranks="288" threads="2"   layout = "6,8"   io_layout = "1,1" />
	       <lnd                           layout = "6,8"   io_layout = "1,1" />
	       <ice                           layout = "72,4" io_layout = "1,1" />
	       <ocn ranks="180" threads="1"   layout = "9,20"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A864x2_O720_production_c192">
	     <resources jobWallclock="16:00:00"
                   segRuntime="4:00:00" >
               <atm ranks="864" threads="2"   layout = "12,12"  io_layout = "1,4" />
	       <lnd                           layout = "12,12"  io_layout = "1,4" />
	       <ice                           layout = "72,12"  io_layout = "1,1" />
	       <ocn ranks="720" threads="1"   layout = "18,40"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A864x2_O720_production">
	     <resources jobWallclock="16:00:00"
                   segRuntime="1:36:00" >
               <atm ranks="864" threads="2"   layout = "12,12"  io_layout = "1,4" />
	       <lnd                           layout = "12,12"  io_layout = "1,4" />
	       <ice                           layout = "72,12"  io_layout = "1,1" />
	       <ocn ranks="720" threads="1"   layout = "18,40"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A864x2_O720_production_c3">
	     <resources jobWallclock="16:00:00"
                   segRuntime="2:40:00" >
               <atm ranks="864" threads="2"   layout = "12,12"  io_layout = "1,4" />
	       <lnd                           layout = "12,12"  io_layout = "1,4" />
	       <ice                           layout = "72,12"  io_layout = "1,1" />
	       <ocn ranks="720" threads="1"   layout = "18,40"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A144x1_O72_test">
	     <resources jobWallclock="1:00:00"
                   segRuntime="0:30:00" >
               <atm ranks="144" threads="1"   layout = "4,6"   io_layout = "1,1" />
	       <lnd                           layout = "4,6"   io_layout = "1,1" />
	       <ice                           layout = "144,1" io_layout = "1,1" />
	       <ocn ranks="72" threads="1"    layout = "6,12"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A144x1_O72_debug">
	     <resources jobWallclock="1:00:00" >
               <atm ranks="144" threads="1"   layout = "4,6"   io_layout = "1,1" />
	       <lnd                           layout = "4,6"   io_layout = "1,1" />
	       <ice                           layout = "144,1" io_layout = "1,1" />
	       <ocn ranks="72" threads="1"    layout = "6,12"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A144x2_O144_production">
	     <resources jobWallclock="16:00:00"
                   segRuntime="4:00:00" >
               <atm ranks="144" threads="2"   layout = "2,12"  io_layout = "1,1" />
	       <lnd                           layout = "2,12"  io_layout = "1,1" />
	       <ice                           layout = "72,2"  io_layout = "1,1" />
	       <ocn ranks="144" threads="1"   layout = "12,12" io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

<!--================================-->
<!--= LAYOUTS FOR C48 EXPERIMENTS  =-->
<!--================================-->

   <freInclude name="resourceparams_A60x1_O32">
	     <resources jobWallclock="05:00:00">
               <atm ranks="60" threads="1"    layout = "2,5"   io_layout = "1,1" />
	       <lnd                           layout = "2,5"   io_layout = "1,1" />
	       <ice                           layout = "60,1"  io_layout = "1,1" />
	       <ocn ranks="32" threads="1"    layout = "8,4" io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A60x1_O64">
	     <resources jobWallclock="05:00:00">
               <atm ranks="60" threads="1"    layout = "2,5"   io_layout = "1,1" />
	       <lnd                           layout = "2,5"   io_layout = "1,1" />
	       <ice                           layout = "60,1"  io_layout = "1,1" />
	       <ocn ranks="64" threads="1"    layout = "8,8" io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A36x2_O36">
	     <resources jobWallclock="05:00:00">
               <atm ranks="36" threads="2"    layout = "2,3"   io_layout = "1,1" />
	       <lnd                           layout = "2,3"   io_layout = "1,1" />
	       <ice                           layout = "36,1"  io_layout = "1,1" />
	       <ocn ranks="36" threads="1"    layout = "9,4" io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A36x2_O72">
	     <resources jobWallclock="05:00:00">
               <atm ranks="36" threads="2"    layout = "2,3"   io_layout = "1,1" />
	       <lnd                           layout = "2,3"   io_layout = "1,1" />
	       <ice                           layout = "36,1"  io_layout = "1,1" />
	       <ocn ranks="72" threads="1"    layout = "9,8" io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A48x2_O32">
	     <resources jobWallclock="05:00:00">
               <atm ranks="48" threads="2"    layout = "1,8"   io_layout = "1,4" />
	       <lnd                           layout = "1,8"   io_layout = "1,4" />
	       <ice                           layout = "12,4"  io_layout = "1,1" />
	       <ocn ranks="32" threads="1"    layout = "2,16" io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A48x2_O64">
	     <resources jobWallclock="05:00:00">
               <atm ranks="48" threads="2"    layout = "1,8"   io_layout = "1,4" />
	       <lnd                           layout = "1,8"   io_layout = "1,4" />
	       <ice                           layout = "48,1"  io_layout = "1,1" />
	       <ocn ranks="64" threads="1"    layout = "8,8"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A54x2_O36">
	     <resources jobWallclock="05:00:00">
               <atm ranks="54" threads="2"    layout = "3,3"   io_layout = "1,1" />
	       <lnd                           layout = "3,3"   io_layout = "1,1" />
	       <ice                           layout = "18,3"  io_layout = "1,1" />
	       <ocn ranks="36" threads="1"    layout = "6,6" io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A54x2_O72">
	     <resources jobWallclock="05:00:00">
               <atm ranks="54" threads="2"    layout = "3,3"   io_layout = "1,1" />
	       <lnd                           layout = "3,3"   io_layout = "1,1" />
	       <ice                           layout = "18,3"  io_layout = "1,1" />
	       <ocn ranks="72" threads="1"    layout = "12,6" io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A108x2_O72">
	     <resources jobWallclock="01:40:00">
               <atm ranks="108" threads="2"   layout = "3,6"  io_layout = "1,1" />
	       <lnd                           layout = "3,6"  io_layout = "1,1" />
	       <ice                           layout = "12,9" io_layout = "1,1" />
	       <ocn ranks="72" threads="1"    layout = "6,12" io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A108x2_O108">
	     <resources jobWallclock="01:40:00">
               <atm ranks="108" threads="2"   layout = "3,6"  io_layout = "1,1" />
	       <lnd                           layout = "3,6"  io_layout = "1,1" />
	       <ice                           layout = "12,9" io_layout = "1,1" />
	       <ocn ranks="108" threads="1"   layout = "9,12" io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A144x2_O96">
	     <resources jobWallclock="01:30:00">
               <atm ranks="144" threads="2"   layout = "4,6"   io_layout = "1,1" />
	       <lnd                           layout = "4,6"   io_layout = "1,1" />
	       <ice                           layout = "12,12" io_layout = "1,1" />
	       <ocn ranks="96" threads="1"    layout = "6,16"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A144x2_ice144_1">
	     <resources jobWallclock="00:30:00">
               <atm ranks="144" threads="2"   layout = "4,6"   io_layout = "1,1" />
	       <lnd                           layout = "4,6"   io_layout = "1,1" />
	       <ice                           layout = "144,1" io_layout = "1,1" />
	       <ocn ranks="96" threads="1"    layout = "6,16"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A144x2_ice72_2">
	     <resources jobWallclock="00:30:00">
               <atm ranks="144" threads="2"   layout = "4,6"   io_layout = "1,1" />
	       <lnd                           layout = "4,6"   io_layout = "1,1" />
	       <ice                           layout = "72,2" io_layout = "1,1" />
	       <ocn ranks="96" threads="1"    layout = "6,16"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A144x2_ice48_3">
	     <resources jobWallclock="00:30:00">
               <atm ranks="144" threads="2"   layout = "4,6"   io_layout = "1,1" />
	       <lnd                           layout = "4,6"   io_layout = "1,1" />
	       <ice                           layout = "48,3" io_layout = "1,1" />
	       <ocn ranks="96" threads="1"    layout = "6,16"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A144x2_ice36_4">
	     <resources jobWallclock="00:30:00">
               <atm ranks="144" threads="2"   layout = "4,6"   io_layout = "1,1" />
	       <lnd                           layout = "4,6"   io_layout = "1,1" />
	       <ice                           layout = "36,4" io_layout = "1,1" />
	       <ocn ranks="96" threads="1"    layout = "6,16"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A144x2_ice24_6">
	     <resources jobWallclock="00:30:00">
               <atm ranks="144" threads="2"   layout = "4,6"   io_layout = "1,1" />
	       <lnd                           layout = "4,6"   io_layout = "1,1" />
	       <ice                           layout = "24,6" io_layout = "1,1" />
	       <ocn ranks="96" threads="1"    layout = "6,16"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A144x2_ice18_8">
	     <resources jobWallclock="00:30:00">
               <atm ranks="144" threads="2"   layout = "4,6"   io_layout = "1,1" />
	       <lnd                           layout = "4,6"   io_layout = "1,1" />
	       <ice                           layout = "18,8" io_layout = "1,1" />
	       <ocn ranks="96" threads="1"    layout = "6,16"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A144x2_ice16_9">
	     <resources jobWallclock="01:30:00">
               <atm ranks="144" threads="2"   layout = "4,6"   io_layout = "1,1" />
	       <lnd                           layout = "4,6"   io_layout = "1,1" />
	       <ice                           layout = "16,9"  io_layout = "1,1" />
	       <ocn ranks="96" threads="1"    layout = "6,16"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A60x2_O36">
	     <resources jobWallclock="02:00:00">
               <atm ranks="60" threads="2"    layout = "2,5"   io_layout = "1,1" />
	       <lnd                           layout = "2,5"   io_layout = "1,1" />
	       <ice                           layout = "60,1"  io_layout = "1,1" />
	       <ocn ranks="36" threads="1"    layout = "3,12"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A60x2_O96">
	     <resources jobWallclock="02:00:00">
               <atm ranks="60" threads="2"    layout = "2,5"   io_layout = "1,1" />
	       <lnd                           layout = "2,5"   io_layout = "1,1" />
	       <ice                           layout = "60,1"  io_layout = "1,1" />
	       <ocn ranks="96" threads="1"    layout = "6,16"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A72x2_O72">
	     <resources jobWallclock="03:00:00">
               <atm ranks="72"  threads="2"   layout = "4,3"   io_layout = "1,1" />
	       <lnd                           layout = "4,3"   io_layout = "1,1" />
	       <ice                           layout = "72,1"  io_layout = "1,1" />
	       <ocn ranks="72"  threads="1"   layout = "6,12"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A72x2_O108">
	     <resources jobWallclock="02:30:00">
               <atm ranks="72"  threads="2"   layout = "4,3"   io_layout = "1,1" />
	       <lnd                           layout = "4,3"   io_layout = "1,1" />
	       <ice                           layout = "18,4"  io_layout = "1,1" />
	       <ocn ranks="108" threads="1"   layout = "9,12"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A96x2_O96">
	     <resources jobWallclock="02:00:00">
               <atm ranks="96" threads="2"    layout = "4,4"   io_layout = "1,1" />
	       <lnd                           layout = "4,4"   io_layout = "1,1" />
	       <ice                           layout = "48,2"  io_layout = "1,1" />
	       <ocn ranks="96" threads="1"    layout = "6,16"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A96x1_O128">
	     <resources jobWallclock="03:00:00">
               <atm ranks="96" threads="1"    layout = "4,4"   io_layout = "1,1" />
	       <lnd                           layout = "4,4"   io_layout = "1,1" />
	       <ice                           layout = "48,2"  io_layout = "1,1" />
	       <ocn ranks="128" threads="1"   layout = "8,16"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A108x2_O216_rts_1x2day">
        <run days="2">
	     <resources jobWallclock="01:00:00">
               <atm ranks="108" threads="2"   layout = "3,6"  io_layout = "1,1" />
	       <lnd                           layout = "3,6"  io_layout = "1,1" />
	       <ice                           layout = "54,2"  io_layout = "1,1" />
	       <ocn ranks="216" threads="1"   layout = "12,18" io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
        </run>
   </freInclude>

   <freInclude name="resourceparams_A108x2_O216_rts_2x1day">
        <run days="1 1">
	     <resources jobWallclock="01:00:00">
               <atm ranks="108" threads="2"   layout = "3,6"  io_layout = "1,1" />
	       <lnd                           layout = "3,6"  io_layout = "1,1" />
	       <ice                           layout = "54,2"  io_layout = "1,1" />
	       <ocn ranks="216" threads="1"   layout = "12,18" io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
        </run>
   </freInclude>

   <freInclude name="resourceparams_A120x2_O128">
	     <resources jobWallclock="02:00:00">
               <atm ranks="120" threads="2"   layout = "4,5"   io_layout = "1,1" />
	       <lnd                           layout = "4,5"   io_layout = "1,1" />
	       <ice                           layout = "60,2"  io_layout = "1,1" />
	       <ocn ranks="128" threads="1"   layout = "8,16"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A144x2_O128">
	     <resources jobWallclock="01:00:00">
               <atm ranks="144" threads="2"   layout = "2,12"  io_layout = "1,1" />
	       <lnd                           layout = "2,12"  io_layout = "1,1" />
	       <ice                           layout = "72,2"  io_layout = "1,1" />
	       <ocn ranks="128" threads="1"   layout = "8,16" io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A144x2_O144">
	     <resources jobWallclock="01:00:00">
               <atm ranks="144" threads="2"   layout = "2,12"  io_layout = "1,1" />
	       <lnd                           layout = "2,12"  io_layout = "1,1" />
	       <ice                           layout = "72,2"  io_layout = "1,1" />
	       <ocn ranks="144" threads="1"   layout = "12,12" io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A192x2_O180">
	     <resources jobWallclock="01:00:00">
               <atm ranks="192" threads="2"   layout = "4,8"   io_layout = "1,4" />
	       <lnd                           layout = "4,8"   io_layout = "1,4" />
	       <ice                           layout = "48,4"  io_layout = "1,1" />
	       <ocn ranks="180" threads="1"   layout = "9,20"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A216x2_O180">
	     <resources jobWallclock="03:00:00">
               <atm ranks="216" threads="2"   layout = "3,12"  io_layout = "1,4" />
	       <lnd                           layout = "3,12"  io_layout = "1,4" />
	       <ice                           layout = "108,2" io_layout = "1,1" />
	       <ocn ranks="180"  threads="1"  layout = "9,20"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A288x2_O180_long">
	     <resources jobWallclock="05:00:00">
               <atm ranks="288" threads="2"   layout = "6,8"   io_layout = "1,4" />
	       <lnd                           layout = "6,8"   io_layout = "1,4" />
	       <ice                           layout = "36,8" io_layout = "1,1" />
	       <ocn ranks="180" threads="1"   layout = "9,20"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>


   <freInclude name="resourceparams_A288x2_O180">
	     <resources jobWallclock="01:00:00">
               <atm ranks="288" threads="2"   layout = "6,8"   io_layout = "1,4" />
	       <lnd                           layout = "6,8"   io_layout = "1,4" />
	       <ice                           layout = "72,4" io_layout = "1,1" />
	       <ocn ranks="180" threads="1"   layout = "9,20"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>
   <freInclude name="resourceparams_A288x2_O252">
	     <resources jobWallclock="01:00:00">
               <atm ranks="288" threads="2"   layout = "6,8"   io_layout = "1,4" />
	       <lnd                           layout = "6,8"   io_layout = "1,4" />
	       <ice                           layout = "72,4" io_layout = "1,1" />
	       <ocn ranks="252" threads="1"   layout = "18,14"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A288x2_O288">
	     <resources jobWallclock="01:00:00">
               <atm ranks="288" threads="2"   layout = "6,8"   io_layout = "1,4" />
	       <lnd                           layout = "6,8"   io_layout = "1,4" />
	       <ice                           layout = "144,2" io_layout = "1,1" />
	       <ocn ranks="288" threads="1"   layout = "16,18"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A432x2_O72">
	     <resources jobWallclock="01:00:00">
               <atm ranks="432" threads="2"   layout = "6,12"   io_layout = "1,4" />
	       <lnd                           layout = "6,12"   io_layout = "1,4" />
	       <ice                           layout = "12,36"  io_layout = "1,1" />
	       <ocn ranks="72"  threads="1"   layout = "12,6"   io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A432x2_O432">
	     <resources jobWallclock="01:00:00">
               <atm ranks="432" threads="2"   layout = "6,12"   io_layout = "1,4" />
	       <lnd                           layout = "6,12"   io_layout = "1,4" />
	       <ice                           layout = "12,36"  io_layout = "1,1" />
	       <ocn ranks="432"  threads="1"  layout = "12,36"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A432x2_O448">
	     <resources jobWallclock="01:00:00">
               <atm ranks="432" threads="2"   layout = "6,12"   io_layout = "1,4" />
	       <lnd                           layout = "6,12"   io_layout = "1,4" />
	       <ice                           layout = "12,36"  io_layout = "1,1" />
	       <ocn ranks="448"  threads="1"  layout = "14,32"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A432x2_O480">
	     <resources jobWallclock="01:00:00">
               <atm ranks="432" threads="2"   layout = "6,12"   io_layout = "1,4" />
	       <lnd                           layout = "6,12"   io_layout = "1,4" />
	       <ice                           layout = "12,36"  io_layout = "1,1" />
	       <ocn ranks="480"  threads="1"  layout = "15,32"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A576x2_O108">
	     <resources jobWallclock="05:00:00">
               <atm ranks="576" threads="2"   layout = "8,12"   io_layout = "1,4" />
	       <lnd                           layout = "8,12"   io_layout = "1,4" />
	       <ice                           layout = "72,8"  io_layout = "1,1" />
	       <ocn ranks="108"  threads="1"  layout = "12,9"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A576x2_O504">
	     <resources jobWallclock="01:00:00">
               <atm ranks="576" threads="2"   layout = "8,12"   io_layout = "1,4" />
	       <lnd                           layout = "8,12"   io_layout = "1,4" />
	       <ice                           layout = "18,32"  io_layout = "1,1" />
	       <ocn ranks="504"  threads="1"  layout = "24,21"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A576x2_O512">
	     <resources jobWallclock="01:00:00">
               <atm ranks="576" threads="2"   layout = "8,12"   io_layout = "1,4" />
	       <lnd                           layout = "8,12"   io_layout = "1,4" />
	       <ice                           layout = "18,32"  io_layout = "1,1" />
	       <ocn ranks="512"  threads="1"  layout = "16,32"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A576x2_O540">
	     <resources jobWallclock="01:00:00">
               <atm ranks="576" threads="2"   layout = "8,12"   io_layout = "1,4" />
	       <lnd                           layout = "8,12"   io_layout = "1,4" />
	       <ice                           layout = "18,32"  io_layout = "1,1" />
	       <ocn ranks="540"  threads="1"  layout = "15,36"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A576x2_O544">
	     <resources jobWallclock="01:00:00">
               <atm ranks="576" threads="2"   layout = "8,12"   io_layout = "1,4" />
	       <lnd                           layout = "8,12"   io_layout = "1,4" />
	       <ice                           layout = "18,32"  io_layout = "1,1" />
	       <ocn ranks="544"  threads="1"  layout = "17,32"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A576x2_O432">
	     <resources jobWallclock="01:00:00">
               <atm ranks="576" threads="2"   layout = "8,12"   io_layout = "1,4" />
	       <lnd                           layout = "8,12"   io_layout = "1,4" />
	       <ice                           layout = "18,32"  io_layout = "1,1" />
	       <ocn ranks="432"  threads="1"  layout = "24,18"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A576x3_O648">
	     <resources jobWallclock="01:00:00">
               <atm ranks="576" threads="3"   layout = "8,12"   io_layout = "1,4" />
	       <lnd                           layout = "8,12"   io_layout = "1,4" />
	       <ice                           layout = "18,32"  io_layout = "1,1" />
	       <ocn ranks="648"  threads="1"  layout = "18,36"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A576x4_O864">
	     <resources jobWallclock="01:00:00">
               <atm ranks="576" threads="4"   layout = "8,12"   io_layout = "1,4" />
	       <lnd                           layout = "8,12"   io_layout = "1,4" />
	       <ice                           layout = "18,32"  io_layout = "1,1" />
	       <ocn ranks="864"  threads="1"  layout = "24,36"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A864x2_O576">
	     <resources jobWallclock="01:00:00">
               <atm ranks="864" threads="2"   layout = "12,12"   io_layout = "1,4" />
	       <lnd                           layout = "12,12"   io_layout = "1,4" />
	       <ice                           layout = "24,36" io_layout = "1,1" />
	       <ocn ranks="576"  threads="1"  layout = "36,16"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A864x2_O720">
	     <resources jobWallclock="01:00:00">
               <atm ranks="864" threads="2"   layout = "12,12"   io_layout = "1,4" />
	       <lnd                           layout = "12,12"   io_layout = "1,4" />
	       <ice                           layout = "72,12" io_layout = "1,1" />
	       <ocn ranks="720"  threads="1"  layout = "36,20"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>
   <freInclude name="resourceparams_O720">
	     <resources jobWallclock="00:30:00">
	       <ice                           layout = "36,20" io_layout = "1,1" />
	       <ocn ranks="720"  threads="1"  layout = "36,20"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>
 
  <freInclude name="resourceparams_O72">
	     <resources jobWallclock="00:30:00">
	       <ice                           layout = "12,6" io_layout = "1,1" />
	       <ocn ranks="72"  threads="1"  layout = "12,6"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>
 
   <freInclude name="resourceparams_O32">
	     <resources jobWallclock="01:00:00">
	       <ice                           layout = "8,4" io_layout = "1,1" />
	       <ocn ranks="32"  threads="1"  layout = "8,4"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_O24">
             <resources jobWallclock="00:30:00">
               <ice                           layout = "6,4" io_layout = "1,1" />
               <ocn ranks="24"  threads="1"  layout = "6,4"  io_layout = "1,1" mask_table="MOM_mask_table" />
             </resources>
   </freInclude>

   <freInclude name="resourceparams_O720_production">
   	     <resources jobWallclock="15:00:00"
                   segRuntime="01:30:00" >
	       <ice                           layout = "36,20" io_layout = "1,1" />
	       <ocn ranks="720"  threads="1"  layout = "36,20"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>
   <freInclude name="resourceparams_O72_production">
   	     <resources jobWallclock="12:00:00"
                   segRuntime="6:00:00" >
	       <ice                           layout = "12,6" io_layout = "1,1" />
	       <ocn ranks="72"  threads="1"  layout = "12,6"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>


   <freInclude name="resourceparams_O144_production">
   	     <resources jobWallclock="16:00:00"
                   segRuntime="4:00:00" >
	       <ice                           layout = "12,12" io_layout = "1,1" />
	       <ocn ranks="144"  threads="1"  layout = "12,12"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A864x2_O756">
	     <resources jobWallclock="01:00:00">
               <atm ranks="864" threads="2"   layout = "12,12"   io_layout = "1,4" />
	       <lnd                           layout = "12,12"   io_layout = "1,4" />
	       <ice                           layout = "144,6" io_layout = "1,1" />
	       <ocn ranks="756"  threads="1"  layout = "36,21"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A864x2_O864">
	     <resources jobWallclock="01:00:00">
               <atm ranks="864" threads="2"   layout = "12,12"   io_layout = "1,4" />
	       <lnd                           layout = "12,12"   io_layout = "1,4" />
	       <ice                           layout = "12,72" io_layout = "1,1" />
	       <ocn ranks="864"  threads="1"   layout = "18,48"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A864x3_O864">
	     <resources jobWallclock="01:00:00">
               <atm ranks="864" threads="3"   layout = "12,12"   io_layout = "1,4" />
	       <lnd                           layout = "12,12"   io_layout = "1,4" />
	       <ice                           layout = "24,36" io_layout = "1,1" />
	       <ocn ranks="864"  threads="1"  layout = "36,24"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A864x4_O1152">
	     <resources jobWallclock="01:00:00">
               <atm ranks="864" threads="4"   layout = "12,12"   io_layout = "1,4" />
	       <lnd                           layout = "12,12"   io_layout = "1,4" />
	       <ice                           layout = "24,36"  io_layout = "1,1" />
	       <ocn ranks="1152"  threads="1" layout = "36,32"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A864x1_O64">
   <!-- Intended for initialization of topo_drag so don't need too many ocean cores. --> 
 	     <resources jobWallclock="01:00:00">
               <atm ranks="864" threads="1"   layout = "12,12" io_layout = "1,1" />
	       <lnd                           layout = "12,12" io_layout = "1,1" />
	       <ice                           layout = "144,6" io_layout = "1,1" />
	       <ocn ranks="64" threads="1"    layout = "8,8"   io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A864x2_O64">
   <!-- Intended for initialization of topo_drag so don't need too many ocean cores. --> 
 	     <resources jobWallclock="01:00:00">
               <atm ranks="864" threads="2"   layout = "12,12" io_layout = "1,1" />
	       <lnd                           layout = "12,12" io_layout = "1,1" />
	       <ice                           layout = "144,6" io_layout = "1,1" />
	       <ocn ranks="64" threads="1"    layout = "8,8"   io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="AMIP_A48x2">
	     <resources jobWallclock="02:30:00">
               <atm ranks="48" threads="2"    layout = "1,8"   io_layout = "1,4" />
	       <lnd                           layout = "1,8"   io_layout = "1,4" />
	       <ice                           layout = "24,2"  io_layout = "1,1" />
	       <ocn ranks="0" threads="1"     layout = "24,2"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="AMIP_A60x2">
	     <resources jobWallclock="02:00:00">
               <atm ranks="60" threads="2"    layout = "2,5"   io_layout = "1,1" />
	       <lnd                           layout = "2,5"   io_layout = "1,1" />
	       <ice                           layout = "30,2"  io_layout = "1,1" />
	       <ocn ranks="0"  threads="1"    layout = "3,20"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="AMIP_A96x2">
	     <resources jobWallclock="01:30:00">
               <atm ranks="96" threads="2"    layout = "4,4"   io_layout = "1,4" />
	       <lnd                           layout = "4,4"   io_layout = "1,4" />
	       <ice                           layout = "24,4"  io_layout = "1,1" />
	       <ocn ranks="0"  threads="1"    layout = "8,12"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="AMIP_A108x2">
	     <resources jobWallclock="01:40:00">
               <atm ranks="108" threads="2"   layout = "3,6"  io_layout = "1,1" />
	       <lnd                           layout = "3,6"  io_layout = "1,1" />
	       <ice                           layout = "27,4" io_layout = "1,1" />
	       <ocn ranks="0"   threads="1"   layout = "9,12" io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="AMIP_A144x2">
	     <resources jobWallclock="01:00:00">
               <atm ranks="144" threads="2"   layout = "4,6"   io_layout = "1,1" />
	       <lnd                           layout = "4,6"   io_layout = "1,1" />
	       <ice                           layout = "36,4" io_layout = "1,1" />
	       <ocn ranks="0"  threads="1"    layout = "12,12" io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="AMIP_A216x2">
	     <resources jobWallclock="01:00:00">
               <atm ranks="216" threads="2"   layout = "6,6"   io_layout = "1,1" />
	       <lnd                           layout = "6,6"   io_layout = "1,1" />
	       <ice                           layout = "36,6" io_layout = "1,1" />
	       <ocn ranks="0"  threads="1"    layout = "12,18" io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="AMIP_A288x2">
	     <resources jobWallclock="01:00:00">
               <atm ranks="288" threads="2"   layout = "6,8"   io_layout = "1,1" />
	       <lnd                           layout = "6,8"   io_layout = "1,1" />
	       <ice                           layout = "72,4"  io_layout = "1,1" />
	       <ocn ranks="0"  threads="1"    layout = "12,24" io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="AMIP_A432x2">
	     <resources jobWallclock="01:00:00">
               <atm ranks="432" threads="2"   layout = "6,12"   io_layout = "1,1" />
	       <lnd                           layout = "6,12"   io_layout = "1,1" />
	       <ice                           layout = "72,6"   io_layout = "1,1" />
	       <ocn ranks="0"  threads="1"    layout = "18,24"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="AMIP_A576x2">
	     <resources jobWallclock="01:00:00">
               <atm ranks="576" threads="2"   layout = "6,16"   io_layout = "1,1" />
	       <lnd                           layout = "6,16"   io_layout = "1,1" />
	       <ice                           layout = "72,8"  io_layout = "1,1" />
	       <ocn ranks="0"  threads="1"    layout = "24,24" io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="AMIP_A576x2_production">
	     <resources jobWallclock="16:00:00"
                   segRuntime="4:00:00" >
               <atm ranks="576" threads="2"   layout = "6,16"  io_layout = "1,4" />
	       <lnd                           layout = "6,16"  io_layout = "1,4" />
	       <ice                           layout = "72,8"  io_layout = "1,1" />
	       <ocn ranks="0"   threads="1"   layout = "24,24"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="AMIP_A1152x2_production">
	     <resources jobWallclock="16:00:00"
                   segRuntime="8:00:00" >
               <atm ranks="1152" threads="2"   layout = "12,16"  io_layout = "1,4" />
	       <lnd                           layout = "12,16"  io_layout = "1,4" />
	       <ice                           layout = "72,16"  io_layout = "1,1" />
	       <ocn ranks="0"   threads="1"   layout = "24,48"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>


<!-- CM4 C192 layouts --> 
   <freInclude name="resourceparams_A432x2_O108">
	     <resources jobWallclock="03:00:00">
               <atm ranks="432" threads="3"   layout = "6,12"   io_layout = "1,4" />
	       <lnd                           layout = "6,12"   io_layout = "1,4" />
	       <ice                           layout = "72,6"  io_layout = "1,1" />
	       <ocn ranks="108"  threads="1"  layout = "9,12"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A576x3_O144">
	     <resources jobWallclock="03:00:00">
               <atm ranks="576" threads="3"   layout = "8,12"   io_layout = "1,4" />
	       <lnd                           layout = "8,12"   io_layout = "1,4" />
	       <ice                           layout = "72,8"  io_layout = "1,1" />
	       <ocn ranks="144"  threads="1"  layout = "12,12"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A576x4_O180">
	     <resources jobWallclock="03:00:00">
               <atm ranks="576" threads="4"   layout = "8,12"   io_layout = "1,4" />
	       <lnd                           layout = "8,12"   io_layout = "1,4" />
	       <ice                           layout = "72,8"  io_layout = "1,1" />
	       <ocn ranks="180"  threads="1"  layout = "9,20"   io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A864x2_O72">
	     <resources jobWallclock="02:00:00">
               <atm ranks="864" threads="2"   layout = "12,12"  io_layout = "1,4" />
	       <lnd                           layout = "12,12"  io_layout = "1,4" />
	       <ice                           layout = "72,12"  io_layout = "1,1" />
	       <ocn ranks="72"  threads="1"   layout = "9,8"    io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A864x2_O180">
	     <resources jobWallclock="02:00:00">
               <atm ranks="864" threads="2"   layout = "12,12"   io_layout = "1,4" />
	       <lnd                           layout = "12,12"   io_layout = "1,4" />
	       <ice                           layout = "72,12"  io_layout = "1,1" />
	       <ocn ranks="180"  threads="1"  layout = "9,20"   io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A864x3_O252">
	     <resources jobWallclock="02:00:00">
               <atm ranks="864" threads="3"   layout = "12,12"   io_layout = "1,4" />
	       <lnd                           layout = "12,12"   io_layout = "1,4" />
	       <ice                           layout = "72,12" io_layout = "1,1" />
	       <ocn ranks="252"  threads="1"  layout = "18,14"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>
   <freInclude name="resourceparams_A864x4_O252">
	     <resources jobWallclock="02:00:00">
               <atm ranks="864" threads="4"   layout = "12,12"   io_layout = "1,4" />
	       <lnd                           layout = "12,12"   io_layout = "1,4" />
	       <ice                           layout = "72,12"  io_layout = "1,1" />
	       <ocn ranks="252"  threads="1"  layout = "18,14"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A864x4_O288">
	     <resources jobWallclock="02:00:00">
               <atm ranks="864" threads="4"   layout = "12,12"   io_layout = "1,4" />
	       <lnd                           layout = "12,12"   io_layout = "1,4" />
	       <ice                           layout = "72,12"  io_layout = "1,1" />
	       <ocn ranks="288"  threads="1"  layout = "9,32"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A1152x2_O216">
	     <resources jobWallclock="03:00:00">
               <atm ranks="1152" threads="2"  layout = "8,24"   io_layout = "1,4" />
	       <lnd                           layout = "8,24"   io_layout = "1,4" />
	       <ice                           layout = "72,16"  io_layout = "1,1" />
	       <ocn ranks="216"  threads="1"  layout = "18,12"   io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A1536x3_O288">
	     <resources jobWallclock="02:00:00">
               <atm ranks="1536" threads="3"  layout = "8,32"  io_layout = "1,4" />
	       <lnd                           layout = "8,32"  io_layout = "1,4" />
	       <ice                           layout = "48,32" io_layout = "1,1" />
	       <ocn ranks="288"  threads="1"  layout = "9,32"  io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>


<!-- LAYOUTS FOR C384 -->

   <freInclude name="resourceparams_A864x2_O36_c384">
	     <resources jobWallclock="00:45:00">
               <atm ranks="864" threads="2"   layout = "12,12"   io_layout = "1,4" />
	       <lnd                           layout = "12,12"   io_layout = "1,4" />
	       <ice                           layout = "72,12"   io_layout = "1,1" />
	       <ocn ranks="36"  threads="1"   layout = "9,4"     io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A864x2_O72_c384">
	     <resources jobWallclock="01:00:00">
               <atm ranks="864" threads="2"   layout = "12,12"   io_layout = "1,4" />
	       <lnd                           layout = "12,12"   io_layout = "1,4" />
	       <ice                           layout = "72,12"   io_layout = "1,1" />
	       <ocn ranks="72"  threads="1"   layout = "9,8"     io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A864x3_O36_c384">
	     <resources jobWallclock="01:00:00">
               <atm ranks="864" threads="3"   layout = "12,12"   io_layout = "1,4" />
	       <lnd                           layout = "12,12"   io_layout = "1,4" />
	       <ice                           layout = "72,12"   io_layout = "1,1" />
	       <ocn ranks="36"  threads="1"   layout = "9,4"     io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A864x3_O72_c384">
	     <resources jobWallclock="01:00:00">
               <atm ranks="864" threads="3"   layout = "12,12"   io_layout = "1,4" />
	       <lnd                           layout = "12,12"   io_layout = "1,4" />
	       <ice                           layout = "72,12"   io_layout = "1,1" />
	       <ocn ranks="72"  threads="1"   layout = "9,8"     io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A864x4_O72_c384">
	     <resources jobWallclock="00:45:00">
               <atm ranks="864" threads="4"   layout = "12,12"   io_layout = "1,4" />
	       <lnd                           layout = "12,12"   io_layout = "1,4" />
	       <ice                           layout = "72,12"   io_layout = "1,1" />
	       <ocn ranks="72"  threads="1"   layout = "9,8"     io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>
   <freInclude name="resourceparams_A1152x3_O72_c384">
	     <resources jobWallclock="00:45:00">
               <atm ranks="1152" threads="3"  layout = "12,16"   io_layout = "1,4" />
	       <lnd                           layout = "12,16"   io_layout = "1,4" />
	       <ice                           layout = "72,16"   io_layout = "1,1" />
	       <ocn ranks="72"  threads="1"   layout = "9,8"     io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A1152x4_O72_c384">
	     <resources jobWallclock="00:45:00">
               <atm ranks="1152" threads="4"  layout = "12,16"   io_layout = "1,4" />
	       <lnd                           layout = "12,16"   io_layout = "1,4" />
	       <ice                           layout = "72,16"   io_layout = "1,1" />
	       <ocn ranks="72"  threads="1"   layout = "9,8"     io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>
   <freInclude name="resourceparams_A1296x4_O72_c384">
	     <resources jobWallclock="00:45:00">
               <atm ranks="1296" threads="4"  layout = "12,18"   io_layout = "1,1" />
	       <lnd                           layout = "12,18"   io_layout = "1,1" />
	       <ice                           layout = "72,18"   io_layout = "1,1" />
	       <ocn ranks="72"  threads="1"   layout = "9,8"     io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A1536x4_O72_c384">
	     <resources jobWallclock="00:45:00">
               <atm ranks="1536" threads="4"  layout = "16,16"   io_layout = "1,4" />
	       <lnd                           layout = "16,16"   io_layout = "1,4" />
	       <ice                           layout = "48,32"   io_layout = "1,1" />
	       <ocn ranks="72"  threads="1"   layout = "9,8"     io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A1536x3_O72_c384">
	     <resources jobWallclock="00:45:00">
               <atm ranks="1536" threads="3"  layout = "16,16"   io_layout = "1,4" />
	       <lnd                           layout = "16,16"   io_layout = "1,4" />
	       <ice                           layout = "48,32"   io_layout = "1,1" />
	       <ocn ranks="72"  threads="1"   layout = "9,8"     io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>
   <freInclude name="resourceparams_A1728x3_O108_c384">
	     <resources jobWallclock="01:00:00">
               <atm ranks="1728" threads="3"  layout = "16,18"   io_layout = "1,1" />
	       <lnd                           layout = "16,18"   io_layout = "1,1" />
	       <ice                           layout = "72,24"   io_layout = "1,1" />
	       <ocn ranks="108"  threads="1"  layout = "12,9"     io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A1728x4_O108_c384">
	     <resources jobWallclock="00:45:00">
               <atm ranks="1728" threads="4"  layout = "12,24"   io_layout = "1,4" />
	       <lnd                           layout = "12,24"   io_layout = "1,4" />
	       <ice                           layout = "72,24"   io_layout = "1,1" />
	       <ocn ranks="108"  threads="1"  layout = "12,9"     io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>

   <freInclude name="resourceparams_A1152x4_O72_production_c384">
	     <resources jobWallclock="16:00:00"
                   segRuntime="8:00:00" >
               <atm ranks="1152" threads="4"  layout = "12,16"   io_layout = "1,4" />
	       <lnd                           layout = "12,16"   io_layout = "1,4" />
	       <ice                           layout = "72,16"   io_layout = "1,1" />
	       <ocn ranks="72"  threads="1"   layout = "9,8"     io_layout = "1,1" mask_table="MOM_mask_table" />
	     </resources>
   </freInclude>
   <freInclude name="OM4_common">
     <input>
     <csh type="always">
        <![CDATA[
     #######IAF cycle mechanism
echo "Model year = $fyear"
#Current JRA dataset starts at 1958 and ends at 2018
#These numbers should be adjusted when the datasets start or length changes.
set JRA_START_YEAR = 1958
set JRA_LEN = 60
@ modulyr = ( $fyear - $JRA_START_YEAR ) % $JRA_LEN
@ forceyr = $JRA_START_YEAR + $modulyr
if ( $modulyr < 0 ) then
   @ forceyr = $forceyr + $JRA_LEN
endif
echo "Forcings file year = $forceyr"
@ forceyrp1 = $forceyr + 1

cd $work/INPUT/
ln -sf $(JRA_dataset)/huss_input4MIPs_atmosphericState_OMIP_MRI-JRA55-do-1-5-0_gr_${forceyr}01010000-${forceyr}12312230.padded.nc JRA_huss.nc 
ln -sf $(JRA_dataset)/prra_input4MIPs_atmosphericState_OMIP_MRI-JRA55-do-1-5_0_gr_${forceyr}01010130-${forceyrp1}01010000.padded.nc JRA_prra.nc
ln -sf $(JRA_dataset)/prsn_input4MIPs_atmosphericState_OMIP_MRI-JRA55-do-1-5_0_gr_${forceyr}01010130-${forceyrp1}01010000.padded.nc JRA_prsn.nc
ln -sf $(JRA_dataset)/psl_input4MIPs_atmosphericState_OMIP_MRI-JRA55-do-1-5_0_gr_${forceyr}01010000-${forceyr}12312230.padded.nc JRA_psl.nc
ln -sf $(JRA_dataset)/rlds_input4MIPs_atmosphericState_OMIP_MRI-JRA55-do-1-5_0_gr_${forceyr}01010130-${forceyrp1}01010000.padded.nc JRA_rlds.nc
ln -sf $(JRA_dataset)/rsds_input4MIPs_atmosphericState_OMIP_MRI-JRA55-do-1-5_0_gr_${forceyr}01010130-${forceyrp1}01010000.padded.nc JRA_rsds.nc
ln -sf $(JRA_dataset)/tas_input4MIPs_atmosphericState_OMIP_MRI-JRA55-do-1-5_0_gr_${forceyr}01010000-${forceyr}12312230.padded.nc JRA_tas.nc
ln -sf $(JRA_dataset)/uas_input4MIPs_atmosphericState_OMIP_MRI-JRA55-do-1-5_0_gr_${forceyr}01010000-${forceyr}12312230.padded.nc JRA_uas.nc
ln -sf $(JRA_dataset)/vas_input4MIPs_atmosphericState_OMIP_MRI-JRA55-do-1-5_0_gr_${forceyr}01010000-${forceyr}12312230.padded.nc JRA_vas.nc

cd $work

      ]]></csh>
    </input>
   </freInclude>

   <freInclude name="SPEAR_domain_decomp">
    <input>
      <csh><![CDATA[
#set ocn_mask_table = "MOM_mask_table"

cat > $work/INPUT/MOM_layout << LAYOUT_EOF
#override LAYOUT = $ocn_layout
#override IO_LAYOUT = $ocn_io_layout
MASKTABLE = $ocn_mask_table
LAYOUT_EOF

cat > $work/INPUT/SIS_layout << LAYOUT_EOF
#override LAYOUT = $ice_layout
#override IO_LAYOUT = $ice_io_layout
MASKTABLE = $ocn_mask_table
LAYOUT_EOF

# runCommand:
#if ( "$atmos_nthreads" == "1" )then
#  alias runCommand "aprun -n $npes -d 1 ./$executable:t"
#endif

# Copy MOM6 input files needed for postprocessing  to GFDL (waiting for FRE to do this for us)
if ( $?flagOutputXferOn && $?flagOutputPostProcessOn ) then
  #trick to copy MOM6 directory but avoid traversing the .datasets links
  tar cvf mom6.tar --exclude='.datasets' -C $(MOM6_EXAMPLES) . > /dev/null
  #tar cvf mom6.tar  --exclude='.datasets' --exclude='src' --exclude='INPUT'  -C $(MOM6_EXAMPLES) . > /dev/null
  mkdir mom6
  tar xvf mom6.tar -C ./mom6 > /dev/null
  module switch gcp/2.2 gcp/2.3
  gcp --batch -cd -r --sync mom6 gfdl:$(NB_ROOT)/
endif


      ]]></csh>
    </input>
  </freInclude>

<!--================================-->
<!--= TEMPLATES FOR POSTPROCESSING =-->
<!--================================-->

  <!-- OCEAN  and ICE post-processing-->

  <freInclude name="regression_OMP_c96">
    <runtime>
      <regression label="basic">
        <run days="8" months="0"
             overrideParams="atmos_model_nml:nxblocks=2;
                             atmos_model_nml:nyblocks=2;
                             fms_nml:clock_grain='ROUTINE';
                             random_number_streams_nml:force_use_of_temp_for_seed=.TRUE.;
                             icebergs_nml:make_calving_reproduce=.TRUE.;
                             xgrid_nml:make_exchange_reproduce=.TRUE.;">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A48x2_O32']/node())"/>
        </run>
      </regression>
      <regression label="restarts">
        <run days="4 4" months="0 0"
             overrideParams="atmos_model_nml:nxblocks=2;
                             atmos_model_nml:nyblocks=2;
                             fms_nml:clock_grain='ROUTINE';
                             random_number_streams_nml:force_use_of_temp_for_seed=.TRUE.;
                             icebergs_nml:make_calving_reproduce=.TRUE.;
                             xgrid_nml:make_exchange_reproduce=.TRUE.;">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A48x2_O32']/node())"/>
        </run>
      </regression>
      <regression label="scaling">
      <!--
        <run days="8" months="0"
             overrideParams="atmos_model_nml:nxblocks=2;
                             atmos_model_nml:nyblocks=2;
                             fms_nml:clock_grain='ROUTINE';
                             random_number_streams_nml:force_use_of_temp_for_seed=.TRUE.;
                             icebergs_nml:make_calving_reproduce=.TRUE.;
                             xgrid_nml:make_exchange_reproduce=.TRUE.;">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A48x2_O64']/node())"/>
        </run>
        <run days="8" months="0"
             overrideParams="fms_nml:clock_grain='ROUTINE';
                             random_number_streams_nml:force_use_of_temp_for_seed=.TRUE.;
                             icebergs_nml:make_calving_reproduce=.TRUE.;
                             xgrid_nml:make_exchange_reproduce=.TRUE.;">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A60x2_O36']/node())"/>
        </run> 
        <run days="8" months="0"
             overrideParams="fms_nml:clock_grain='ROUTINE';
                             random_number_streams_nml:force_use_of_temp_for_seed=.TRUE.;
                             icebergs_nml:make_calving_reproduce=.TRUE.;
                             xgrid_nml:make_exchange_reproduce=.TRUE.;">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A108x2_O72']/node())"/>
        </run>
        <run days="8" months="0"
             overrideParams="fms_nml:clock_grain='ROUTINE';
                             random_number_streams_nml:force_use_of_temp_for_seed=.TRUE.;
                             icebergs_nml:make_calving_reproduce=.TRUE.;
                             xgrid_nml:make_exchange_reproduce=.TRUE.;">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A144x2_O96']/node())"/>
        </run>
        -->
        <run days="8" months="0"
             overrideParams="fms_nml:clock_grain='ROUTINE';
                             random_number_streams_nml:force_use_of_temp_for_seed=.TRUE.;
                             icebergs_nml:make_calving_reproduce=.TRUE.;
                             xgrid_nml:make_exchange_reproduce=.TRUE.;">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A864x2_O864']/node())"/>
        </run>
      </regression>
      <regression label="onedaychksum">
        <run days="1" months="0"
             overrideParams="coupler_nml:do_debug=.true.;
                             fms_nml:print_memory_usage=.true.;
                             fms_nml:clock_grain='ROUTINE';
                             random_number_streams_nml:force_use_of_temp_for_seed=.TRUE.;
                             icebergs_nml:make_calving_reproduce=.TRUE.;
                             xgrid_nml:make_exchange_reproduce=.TRUE.;">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A288x2_O180']/node())"/>
        </run>
      </regression>
      <regression label="ice_model_layout">
        <run days="4 4" months="0"
             overrideParams="fms_nml:clock_grain='ROUTINE';
                             random_number_streams_nml:force_use_of_temp_for_seed=.TRUE.;
                             icebergs_nml:make_calving_reproduce=.TRUE.;
                             icebergs_nml: Runge_not_Verlet = .TRUE.;
                             xgrid_nml:make_exchange_reproduce=.TRUE.;">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A144x2_O96']/node())"/>
        </run>
        <run days="4 4" months="0"
             overrideParams="fms_nml:clock_grain='ROUTINE';
                             random_number_streams_nml:force_use_of_temp_for_seed=.TRUE.;
                             icebergs_nml:make_calving_reproduce=.TRUE.;
                             icebergs_nml: Runge_not_Verlet = .TRUE.;
                             xgrid_nml:make_exchange_reproduce=.TRUE.;">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A144x2_ice144_1']/node())"/>
        </run>
        <run days="4 4" months="0"
             overrideParams="fms_nml:clock_grain='ROUTINE';
                             random_number_streams_nml:force_use_of_temp_for_seed=.TRUE.;
                             icebergs_nml:make_calving_reproduce=.TRUE.;
                             icebergs_nml: Runge_not_Verlet = .TRUE.;
                             xgrid_nml:make_exchange_reproduce=.TRUE.;">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A144x2_ice72_2']/node())"/>
        </run>
        <run days="4 4" months="0"
             overrideParams="fms_nml:clock_grain='ROUTINE';
                             random_number_streams_nml:force_use_of_temp_for_seed=.TRUE.;
                             icebergs_nml:make_calving_reproduce=.TRUE.;
                             icebergs_nml: Runge_not_Verlet = .TRUE.;
                             xgrid_nml:make_exchange_reproduce=.TRUE.;">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A144x2_ice48_3']/node())"/>
        </run>
        <run days="4 4" months="0"
             overrideParams="fms_nml:clock_grain='ROUTINE';
                             random_number_streams_nml:force_use_of_temp_for_seed=.TRUE.;
                             icebergs_nml:make_calving_reproduce=.TRUE.;
                             icebergs_nml: Runge_not_Verlet = .TRUE.;
                             xgrid_nml:make_exchange_reproduce=.TRUE.;">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A144x2_ice36_4']/node())"/>
        </run>
        <run days="4 4" months="0"
             overrideParams="fms_nml:clock_grain='ROUTINE';
                             random_number_streams_nml:force_use_of_temp_for_seed=.TRUE.;
                             icebergs_nml:make_calving_reproduce=.TRUE.;
                             icebergs_nml: Runge_not_Verlet = .TRUE.;
                             xgrid_nml:make_exchange_reproduce=.TRUE.;">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A144x2_ice24_6']/node())"/>
        </run>
        <run days="4 4" months="0"
             overrideParams="fms_nml:clock_grain='ROUTINE';
                             random_number_streams_nml:force_use_of_temp_for_seed=.TRUE.;
                             icebergs_nml:make_calving_reproduce=.TRUE.;
                             icebergs_nml: Runge_not_Verlet = .TRUE.;
                             xgrid_nml:make_exchange_reproduce=.TRUE.;">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A144x2_ice18_8']/node())"/>
        </run>
        <run days="4 4" months="0"
             overrideParams="fms_nml:clock_grain='ROUTINE';
                             random_number_streams_nml:force_use_of_temp_for_seed=.TRUE.;
                             icebergs_nml:make_calving_reproduce=.TRUE.;
                             icebergs_nml: Runge_not_Verlet = .TRUE.;
                             xgrid_nml:make_exchange_reproduce=.TRUE.;">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A144x2_ice16_9']/node())"/>
        </run>
      </regression>
      <regression label="timing_omp_c3">
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A96x1_O128']/node())"/>
        </run>
        <!--
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A60x1_O64']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A60x1_O32']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A48x2_O64']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A60x2_O96']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A96x2_O96']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A120x2_O128']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A144x2_O128']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A288x2_O252']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A432x2_O448']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A432x2_O480']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A576x2_O512']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A576x2_O544']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A864x2_O756']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A864x2_O864']/node())"/>
        </run>
        -->
      </regression>
      <regression label="timing_omp">
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A54x2_O72']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A108x2_O108']/node())"/>
        </run>
        <!--
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A36x2_O72']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A36x2_O36']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A54x2_O36']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="atmos_model_nml:nxblocks=2; 
                                                 atmos_model_nml:nyblocks=3;
                                                 fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A48x2_O32']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="atmos_model_nml:nxblocks=3; 
                                                 atmos_model_nml:nyblocks=2;
                                                 fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A60x2_O36']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A72x2_O72']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A72x2_O108']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A144x2_O144']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A108x2_O72']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A108x2_O108']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A144x2_O144']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A192x2_O96']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A192x3_O180']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A216x2_O108']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A288x2_O144']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A288x2_O180']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A192x2_O180']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A216x2_O180']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A288x2_O252']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A288x2_O288']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A432x2_O432']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A576x2_O504']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A576x2_O540']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A864x2_O864']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A864x2_O756']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A864x2_O720']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A576x4_O864']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A576x4_O960']/node())"/>
        </run>
        -->
      </regression>

      <regression label="sixmonth">
        <run days="0" months="6" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A576x2_O432']/node())"/>
        </run>
        <run days="0" months="6" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A576x3_O648']/node())"/>
        </run>
        <run days="0" months="6" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A576x4_O864']/node())"/>
        </run>
        <run days="0" months="6" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A864x2_O576']/node())"/>
        </run>
        <run days="0" months="6" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A864x3_O864']/node())"/>
        </run>
        <run days="0" months="6" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A864x4_O1152']/node())"/>
        </run>
      </regression>
    </runtime>
  </freInclude>

  <freInclude name="regression_AMIP_OMP_c96">
    <runtime>
      <regression label="basic">
        <run days="8" months="0"
             overrideParams="atmos_model_nml:nxblocks=2;
                             atmos_model_nml:nyblocks=2;
                             fms_nml:clock_grain='ROUTINE';
                             random_number_streams_nml:force_use_of_temp_for_seed=.TRUE.;
                             icebergs_nml:make_calving_reproduce=.TRUE.;
                             xgrid_nml:make_exchange_reproduce=.TRUE.;">
            <xi:include xpointer="xpointer(//freInclude[@name='AMIP_A48x2']/node())"/>
        </run>
      </regression>
      <regression label="restarts">
        <run days="4 4" months="0 0"
             overrideParams="atmos_model_nml:nxblocks=2;
                             atmos_model_nml:nyblocks=2;
                             fms_nml:clock_grain='ROUTINE';
                             random_number_streams_nml:force_use_of_temp_for_seed=.TRUE.;
                             icebergs_nml:make_calving_reproduce=.TRUE.;
                             xgrid_nml:make_exchange_reproduce=.TRUE.;">
            <xi:include xpointer="xpointer(//freInclude[@name='AMIP_A48x2']/node())"/>
        </run>
      </regression>
      <regression label="scaling">
        <run days="8" months="0"
             overrideParams="fms_nml:clock_grain='ROUTINE';
                             random_number_streams_nml:force_use_of_temp_for_seed=.TRUE.;
                             icebergs_nml:make_calving_reproduce=.TRUE.;
                             xgrid_nml:make_exchange_reproduce=.TRUE.;">
            <xi:include xpointer="xpointer(//freInclude[@name='AMIP_A60x2']/node())"/>
        </run>
        <run days="8" months="0"
             overrideParams="fms_nml:clock_grain='ROUTINE';
                             random_number_streams_nml:force_use_of_temp_for_seed=.TRUE.;
                             icebergs_nml:make_calving_reproduce=.TRUE.;
                             xgrid_nml:make_exchange_reproduce=.TRUE.;">
            <xi:include xpointer="xpointer(//freInclude[@name='AMIP_A96x2']/node())"/>
        </run> 
        <run days="8" months="0"
             overrideParams="fms_nml:clock_grain='ROUTINE';
                             random_number_streams_nml:force_use_of_temp_for_seed=.TRUE.;
                             icebergs_nml:make_calving_reproduce=.TRUE.;
                             xgrid_nml:make_exchange_reproduce=.TRUE.;">
            <xi:include xpointer="xpointer(//freInclude[@name='AMIP_A108x2']/node())"/>
        </run>
        <run days="8" months="0"
             overrideParams="fms_nml:clock_grain='ROUTINE';
                             random_number_streams_nml:force_use_of_temp_for_seed=.TRUE.;
                             icebergs_nml:make_calving_reproduce=.TRUE.;
                             xgrid_nml:make_exchange_reproduce=.TRUE.;">
            <xi:include xpointer="xpointer(//freInclude[@name='AMIP_A144x2']/node())"/>
        </run>
        <run days="8" months="0"
             overrideParams="fms_nml:clock_grain='ROUTINE';
                             random_number_streams_nml:force_use_of_temp_for_seed=.TRUE.;
                             icebergs_nml:make_calving_reproduce=.TRUE.;
                             xgrid_nml:make_exchange_reproduce=.TRUE.;">
            <xi:include xpointer="xpointer(//freInclude[@name='AMIP_A288x2']/node())"/>
        </run>
        <run days="8" months="0"
             overrideParams="fms_nml:clock_grain='ROUTINE';
                             random_number_streams_nml:force_use_of_temp_for_seed=.TRUE.;
                             icebergs_nml:make_calving_reproduce=.TRUE.;
                             xgrid_nml:make_exchange_reproduce=.TRUE.;">
            <xi:include xpointer="xpointer(//freInclude[@name='AMIP_A432x2']/node())"/>
        </run>
      </regression>
      <regression label="timing_omp">
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='AMIP_A48x2']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='AMIP_A60x2']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='AMIP_A96x2']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='AMIP_A108x2']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='AMIP_A144x2']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='AMIP_A216x2']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='AMIP_A288x2']/node())"/>
        </run>
        <run days="0 0 0" months="1 1 1" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='AMIP_A288x2']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='AMIP_A432x2']/node())"/>
        </run>
      </regression>
    </runtime>
  </freInclude>

  <freInclude name="regression_OMP_c192">
    <runtime>
      <regression label="basic">
        <run days="8" months="0"
             overrideParams="atmos_model_nml:nxblocks=2;
                             atmos_model_nml:nyblocks=2;
                             fms_nml:clock_grain='ROUTINE';
                             random_number_streams_nml:force_use_of_temp_for_seed=.TRUE.;
                             icebergs_nml:make_calving_reproduce=.TRUE.;
                             xgrid_nml:make_exchange_reproduce=.TRUE.;">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A432x2_O72']/node())"/>
        </run>
      </regression>
      <regression label="restarts">
        <run days="4 4" months="0 0"
             overrideParams="atmos_model_nml:nxblocks=2;
                             atmos_model_nml:nyblocks=2;
                             fms_nml:clock_grain='ROUTINE';
                             random_number_streams_nml:force_use_of_temp_for_seed=.TRUE.;
                             icebergs_nml:make_calving_reproduce=.TRUE.;
                             xgrid_nml:make_exchange_reproduce=.TRUE.;">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A432x2_O72']/node())"/>
        </run>
      </regression>
      <regression label="scaling">
        <run days="8" months="0"
             overrideParams="fms_nml:clock_grain='ROUTINE';
                             random_number_streams_nml:force_use_of_temp_for_seed=.TRUE.;
                             icebergs_nml:make_calving_reproduce=.TRUE.;
                             xgrid_nml:make_exchange_reproduce=.TRUE.;">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A864x2_O864']/node())"/>
        </run>
      </regression>
      <regression label="timing_small_c192_c3">
        <run days="0" months="6" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A288x1_O64_c192']/node())"/>
        </run>
        <run days="0" months="6" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A432x1_O64_c192']/node())"/>
        </run>
        <run days="0" months="6" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A576x1_O64_c192']/node())"/>
        </run>
        <run days="0" months="6" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A384x2_O64_c192']/node())"/>
        </run>
        <run days="0" months="6" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A432x2_O64_c192']/node())"/>
        </run>
      </regression>
      <regression label="timing_small_c192_c4">
        <run days="0" months="6" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A288x1_O72_c192']/node())"/>
        </run>
        <run days="0" months="6" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A432x1_O72_c192']/node())"/>
        </run>
        <run days="0" months="6" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A576x1_O72_c192']/node())"/>
        </run>
        <run days="0" months="6" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A384x2_O72_c192']/node())"/>
        </run>
        <run days="0" months="6" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A432x2_O72_c192']/node())"/>
        </run>
      </regression>
      <regression label="timing_omp">
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A576x2_O108']/node())"/>
        </run>
        <!--
        <run days="0" months="6" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A576x3_O144']/node())"/>
        </run>
        <run days="0" months="6" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A576x4_O180']/node())"/>
        </run>
        <run days="0" months="6" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A864x3_O252']/node())"/>
        </run>
        <run days="0" months="3" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A864x4_O252']/node())"/>
        </run>
        <run days="0" months="6" overrideParams="fms_nml:clock_grain='ROUTINE';">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A1536x3_O288']/node())"/>
        </run>
        -->
      </regression>
    </runtime>
  </freInclude>


  <freInclude name="regression_OMP_c384">
    <runtime>
      <regression label="basic">
        <run days="8" months="0"
             overrideParams="atmos_model_nml:nxblocks=2;
                             atmos_model_nml:nyblocks=2;
                             fms_nml:clock_grain='ROUTINE';
                             random_number_streams_nml:force_use_of_temp_for_seed=.TRUE.;
                             icebergs_nml:make_calving_reproduce=.TRUE.;
                             xgrid_nml:make_exchange_reproduce=.TRUE.;">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A864x2_O72_c384']/node())"/>
        </run>
      </regression>
      <regression label="restarts">
        <run days="4 4" months="0 0"
             overrideParams="atmos_model_nml:nxblocks=2;
                             atmos_model_nml:nyblocks=2;
                             fms_nml:clock_grain='ROUTINE';
                             random_number_streams_nml:force_use_of_temp_for_seed=.TRUE.;
                             icebergs_nml:make_calving_reproduce=.TRUE.;
                             xgrid_nml:make_exchange_reproduce=.TRUE.;">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A864x2_O72_c384']/node())"/>
        </run>
      </regression>
      <regression label="scaling">
        <!--
        <run days="8" months="0"
             overrideParams="fms_nml:clock_grain='ROUTINE';
                             random_number_streams_nml:force_use_of_temp_for_seed=.TRUE.;
                             icebergs_nml:make_calving_reproduce=.TRUE.;
                             xgrid_nml:make_exchange_reproduce=.TRUE.;">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A864x2_O36_c384']/node())"/>
        </run>
        <run days="8" months="0"
             overrideParams="fms_nml:clock_grain='ROUTINE';
                             random_number_streams_nml:force_use_of_temp_for_seed=.TRUE.;
                             icebergs_nml:make_calving_reproduce=.TRUE.;
                             xgrid_nml:make_exchange_reproduce=.TRUE.;">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A864x3_O72_c384']/node())"/>
        </run>
        <run days="8" months="0"
             overrideParams="fms_nml:clock_grain='ROUTINE';
                             random_number_streams_nml:force_use_of_temp_for_seed=.TRUE.;
                             icebergs_nml:make_calving_reproduce=.TRUE.;
                             xgrid_nml:make_exchange_reproduce=.TRUE.;">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A864x4_O72_c384']/node())"/>
        </run>
        -->
        <run days="8" months="0"
             overrideParams="fms_nml:clock_grain='ROUTINE';
                             random_number_streams_nml:force_use_of_temp_for_seed=.TRUE.;
                             icebergs_nml:make_calving_reproduce=.TRUE.;
                             xgrid_nml:make_exchange_reproduce=.TRUE.;">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A1152x3_O72_c384']/node())"/>
        </run>
        <run days="8" months="0"
             overrideParams="fms_nml:clock_grain='ROUTINE';
                             random_number_streams_nml:force_use_of_temp_for_seed=.TRUE.;
                             icebergs_nml:make_calving_reproduce=.TRUE.;
                             xgrid_nml:make_exchange_reproduce=.TRUE.;">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A1152x4_O72_c384']/node())"/>
        </run>
      </regression>
      <regression label="timing">
        <!--
        <run days="0" months="1">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A864x3_O36_c384']/node())"/>
        </run>
        <run days="0" months="1">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A864x4_O72_c384']/node())"/>
        </run>
        <run days="0" months="1">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A1152x3_O72_c384']/node())"/>
        </run>
        -->
        <run days="0" months="1">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A1152x4_O72_c384']/node())"/>
        </run>
        <!--
        <run days="0" months="1">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A1296x4_O72_c384']/node())"/>
        </run>
        <run days="0" months="1">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A1536x3_O72_c384']/node())"/>
        </run>
        <run days="0" months="1">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A1536x4_O72_c384']/node())"/>
        </run>
        <run days="0" months="1">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A1728x3_O108_c384']/node())"/>
        </run>
        <run days="0" months="1">
            <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A1728x4_O108_c384']/node())"/>
        </run>
        -->
      </regression>
    </runtime>
  </freInclude>

  <freInclude name="FLOR2_MOM6_data">
    <input>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(includeDir)/land_ice_ocean_LM3_SIS2/OM_360x320_C180/INPUT/layer_coord.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(includeDir)/land_ice_ocean_LM3_SIS2/OM_360x320_C180/INPUT/seawifs_1998-2006_smoothed_2X.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(includeDir)/land_ice_ocean_LM3_SIS2/OM_360x320_C180/INPUT/tidal_amplitude.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(includeDir)/land_ice_ocean_LM3_SIS2/OM_360x320_C180/INPUT/MOM_channels_FLOR</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(includeDir)/ice_ocean_SIS2/OM4_025/INPUT/vgrid_75_2m.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
          <dataSource site="ncrc">/lustre/f2/dev/gfdl/William.Cooke/pdata/gfdl_SD/MOM6_datasets/FLOR2/diag_vgrid.nc</dataSource>
          <dataSource site="gfdl">/archive/William.Cooke/gold/datasets/FLOR2/diag_vgrid.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(includeDir)/ice_ocean_SIS2/OM4_025/INPUT/WOA05_pottemp_salt.nc </dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource site="ncrc">/lustre/f2/dev/gfdl/William.Cooke/pdata/gfdl_SD/MOM6_datasets/FLOR2/edits_012016.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource site="ncrc">/lustre/f2/dev/gfdl/William.Cooke/pdata/gfdl_SD/MOM6_datasets/FLOR2/edits_013016a.nc</dataSource>
      </dataFile>
     <dataFile label="diagTable" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource site="ncrc">/lustre/f2/dev/gfdl/Yongfei.Zhang/input/diag_table.daily</dataSource>
        <dataSource site="theia">/lustre/f2/dev/gfdl/Yongfei.Zhang/input/diag_table.daily</dataSource>
        <dataSource site="gfdl">$(NB_ROOT)/mom6/ice_ocean_SIS2/OM4_025/diag_table.MOM6</dataSource>
      </dataFile>
    </input>
  </freInclude>

  <freInclude name="SIS2_data">
    <input>
     <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
         <dataSource platform="$(platform)">$(includeDir)/land_ice_ocean_LM3_SIS2/OM_360x320_C180/SIS_input</dataSource>
     </dataFile>
     <namelist name="SIS_input_nml" >
         output_directory = './',
         input_filename = '$sis_restart_flag'
         restart_input_dir = 'INPUT/',
         restart_output_dir = 'RESTART/',
         parameter_filename = 'INPUT/SIS_input','INPUT/SIS_layout','INPUT/SIS_override'
     </namelist>

     </input>
  </freInclude>

  <freInclude name="MOM6_data">
    <input>

     <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
         <dataSource platform="$(platform)">$(includeDir)/land_ice_ocean_LM3_SIS2/OM_360x320_C180/MOM_input</dataSource>
     </dataFile>
     <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
         <dataSource platform="$(platform)">/lustre/f2/dev/Yongfei.Zhang/input/salt_restore_PHC2.1degOM4.v20180716.nc</dataSource>
     </dataFile>
        <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
         <dataSource platform="$(platform)">/lustre/f2/dev/gfdl/Yongfei.Zhang/input/MOM_saltrestore</dataSource>
     </dataFile>
     <namelist name="MOM_input_nml" >
         output_directory = './',
         input_filename = '$restart_flag'
         restart_input_dir = 'INPUT/',
         restart_output_dir = 'RESTART/',
         parameter_filename = 'INPUT/MOM_input','INPUT/MOM_layout',INPUT/MOM_saltrestore',INPUT/MOM_override'
     </namelist>

     </input>
  </freInclude>

   <!--AMIP configurations-->

 <freInclude name="common_AM4_v20170208">
    <input>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$PDATA/gfdl/cmip6/datasets/CM4/common/common_AM4/sea_esf_CM4_V6_AUG2015.cpio</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$PDATA/gfdl/cmip6/datasets/CM4/common/common_AM4/aerosol_inputs_newdroplet2_v20170208.tar</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$PDATA/gfdl/cmip6/datasets/CM4/common/common_AM4/tropchem_dec2015.cpio</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$PDATA/gfdl/cmip6/datasets/CM4/common/common_AM4/depvel_gc_am3_tran.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$PDATA/gfdl/cmip6/datasets/CM4/common/common_AM4/so2_0.25_volcanoes.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/AM4_201510" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$PDATA/gfdl/cmip6/datasets/CM4/common/common_AM4/am4_optical_table_20151029.dat</dataSource>
      </dataFile>
    </input>
  </freInclude>

<!--==========================-->
<!--= AMIP-CLIMO EXPERIMENTS =-->
<!--==========================-->

  <freInclude name="csh_adjust_dry_mass">
    <input>
      <csh type="always"><![CDATA[
cd INPUT

# adjustment of dry mass first time only
#set adjust_dry_mass = `$(includeDir)/adjust_dry_mass.csh`

# create dummy MOM6 parameter file
touch MOM_input
cd ..
      ]]>
      </csh>
    </input>
  </freInclude>

  <freInclude name="SPEAR_c96_PostP_Control">
      <postProcess> 
         <csh><![CDATA[
         cd $work/RESTART
         ncrcat icebergs.res.nc.* icebergs.res.nc
         if(-e icebergs.res.nc) rm -f icebergs.res.nc.*
         cd $work
         ncrcat iceberg_trajectories.nc.* iceberg_trajectories.nc
         rm -f iceberg_trajectories.nc.* 
         #Save the last line of timestats without the first (step number) column as a signature of MOM6 answers
         tail -1 timestats | cut -c8- > RESTART/$enddate.timestats.res
         #Save the whole timestats under ascii/
         mv timestats $enddate.timestats
         mv timestats.nc $enddate.timestats.nc

         #Make a directory to trick FRE to pick up and archive in ascii
         mkdir extra.results

         mv *velocity_truncations CPU_stats SIS_parameter_doc* MOM_parameter_doc* seaice.stats timestats ocean.stats *.ocean.stats* extra.results/
         ]]>
         </csh>

      <!--REFINE DIAG SCRIPT -->
      <!--By default a refineDiag script causes the annual data to be unpacked and saved in /ptmp/$USER-->
      <refineDiag script="$(includeDir)/refineDiag/dummy_refineDiag.csh,$(includeDir)/refineDiag/refineDiag_data_stager_globalAve.csh"/>
      <!--MOM6_refineDiag.csh is currently empty and is here only to cause the unpack annual history files in /ptmp-->
      <!--
      <refineDiag script="$(NB_ROOT)/mom6/tools/analysis/MOM6_refineDiag.csh,$(includeDir)/refineDiag/refineDiag_data_stager_globalAve.csh"/>
      -->
<!-- Tony said to comment this out for now. -->
      <!--PostProcessing component models-->
      <component type="atmos_daily" zInterp="ncep"  start="$(PP_START_YEAR)"  source="atmos_daily" sourceGrid="atmos-cubedsphere" xyInterp="180,288" >
	<timeSeries freq="daily" source="atmos_daily" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="daily" source="atmos_daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="atmos_4xdaily" zInterp="ncep"   start="$(PP_START_YEAR)" source="atmos_4xdaily" sourceGrid="atmos-cubedsphere" xyInterp="180,288" >
        <timeSeries freq="6hr" source="atmos_4xdaily" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="6hr" source="atmos_4xdaily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="atmos_4xdaily_avg" zInterp="ncep"   start="$(PP_START_YEAR)" source="atmos_4xdaily_avg" sourceGrid="atmos-cubedsphere" xyInterp="180,288" >
        <timeSeries freq="6hr" source="atmos_4xdaily_avg" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="6hr" source="atmos_4xdaily_avg" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="atmos" zInterp="ncep" start="$(PP_START_YEAR)"  source="atmos_month" sourceGrid="atmos-cubedsphere" xyInterp="180,288" >
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)">
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="$FRE_ANALYSIS_HOME/cjg/stub/cjg_atmos_ts_mon.csh"/>
          <!-- Analysis scripts from Andrew Wittenberg
          annual and seasonal climatology -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja -v tau_x,tau_y,tau_curl,wind_div,ps,t_surf,t_diff,rh_ref,olr,tot_cld,hi_cld,mid_cld,lo_cld,wvp,cwp,u_ref,v_ref,tau_div vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_oaflux"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_cmap_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_gpcp_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_qscat"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_ersst_v3"/>
          <!-- clim and anomaly stddevs, regressions -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3 -t all -v tau_x,tau_y,tau_curl,wind_div,ps,t_surf,t_diff,rh_ref,olr,tot_cld,hi_cld,mid_cld,lo_cld,wvp,cwp,u_ref,v_ref,tau_div vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3,std -C clim -t all vs_oaflux"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3,std,anom_std -C clim -t all vs_cmap_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3,std,anom_std -C clim -t all vs_gpcp_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a std,anom_std -C clim -t all -v tau_x,tau_y,t_surf vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a std,anom_std -C clim -t all -v tau_x,tau_y,wind vs_qscat"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3,std,anom_std -C clim -t all vs_ersst_v3"/>
          <!-- total correlations with local SST -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all -v tau_x,tau_y,tau_curl,wind_div,ps,t_diff,rh_ref,olr,tot_cld,hi_cld,mid_cld,lo_cld,wvp,cwp,u_ref,v_ref,tau_div vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all vs_oaflux"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all vs_cmap_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all vs_gpcp_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all -v tau_x,tau_y,wind vs_qscat"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all vs_ersst_v3"/>
          <!-- anomaly correlations with local SST -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all -v tau_x,tau_y,tau_curl,wind_div,ps,t_diff,rh_ref,olr,tot_cld,hi_cld,mid_cld,lo_cld,wvp,cwp,u_ref,v_ref,tau_div vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all vs_oaflux"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all vs_cmap_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all vs_gpcp_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all -v tau_x,tau_y,wind vs_qscat"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all vs_ersst_v3"/>
          <!-- wavelet plots of climate indices -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/index/frepp.atw_atmos_ts_monthly_index.csh -n -s -a tave_spectrum vs_obs"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/index/frepp.atw_atmos_ts_monthly_index.csh -n -s -a wavelet_density solo"/>
          <!-- global analysis -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -a clim -t all -v t_surf -y -90,90,20,1 -N globe -p globe vs_era40"/>
          <!-- Koppen climate types -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/koppen/frepp.atw_atmos_ts_monthly_koppen.csh -n -s vs_uea"/>
        </timeSeries>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_C)">
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/bw_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/bw_cru_precip.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/bw_atmos_tauu_atl_pac.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/pjk_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/tk_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/lwh_atmos_av_mon.csh"/> 
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjg/stub/cjg_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/radiation_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/sak_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/sak_lwp_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/sak_precip_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/yim_aer_cld.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/precip_water_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/liquid_cloud_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/ice_cloud_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/surface_atmos_av_mon.csh"/>
          <!--
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="/home/fms/local/opt/fre-analysis/test/eem/code/pcmdi_metrics/frepp.pcmdi_metrics.atmos.csh -c amip"/> 
          -->
      <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$FRE_ANALYSIS_HOME/eem/code/pcmdi_metrics/frepp.pcmdi_metrics_v1p1p1.atmos.csh -c amip"/>
        </timeAverage>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)">
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_av_annual/column/frepp.atw_atmos_av_annual_column.csh -s solo"/>
        </timeAverage>
      </component>
      <component type="atmos_month_aer"  start="$(PP_START_YEAR)" source="atmos_month_aer" sourceGrid="atmos-cubedsphere" xyInterp="180,288">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="atmos_scalar" start="$(PP_START_YEAR)"  source="atmos_scalar">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"  source="atmos_scalar"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" source="atmos_scalar"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"  source="atmos_scalar"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" source="atmos_scalar"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ice_daily" start="$(PP_START_YEAR)"   source="ice_daily">
	<timeSeries freq="daily" source="ice_daily" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="daily" source="ice_daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ice"  start="$(PP_START_YEAR)" sourceGrid="ocean-tripolar">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"  source="ice_month"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"  source="ice_month"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)"  source="ice_month"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"  source="ice_month"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"  source="ice_month"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)"  source="ice_month"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="iceberg"  start="$(PP_START_YEAR)" sourceGrid="ocean-tripolar">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"  source="iceberg_month">
	</timeSeries>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"  source="iceberg_month">
	</timeSeries>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)"  source="iceberg_month">
	</timeSeries>
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_C)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" > 
	</timeSeries>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" > 
	</timeSeries>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" > 
	</timeSeries>
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_C)"/>
      </component>
      <component type="land"  start="$(PP_START_YEAR)"  source="land_month" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="192,384">
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="land_inst_month"   start="$(PP_START_YEAR)" source="land_month_inst" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="192,384">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="river"  start="$(PP_START_YEAR)"  source="river_month" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="192,384">
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="river_inst_month"   start="$(PP_START_YEAR)" source="river_month_inst" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="192,384">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_scalar" start="$(PP_START_YEAR)"  source="ocean_scalar_month"  sourceGrid="ocean-tripolar">  
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" />
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_C)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component> 
      <component type="ocean" start="$(PP_START_YEAR)"   sourceGrid="ocean-tripolar">  
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_month"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_month"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" source="ocean_month"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_C)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component> 
      <component type="ocean_z"   start="$(PP_START_YEAR)" sourceGrid="ocean-tripolar">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_z_month"> </timeSeries>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_z_month"> </timeSeries>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" source="ocean_z_month">
        <!--
        <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/ice_ocean_SIS/OM4_025/ocn_monthly.frepp"/>
        -->
        </timeSeries>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_C)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_z_month"> </timeSeries>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_z_month"> </timeSeries>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" source="ocean_z_month">
        <!--
        <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/ice_ocean_SIS/OM4_025/ocn_monthly.frepp"/>
        -->
        </timeSeries>  
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="ocean_z_ann"   start="$(PP_START_YEAR)" source="ocean_z_annual" sourceGrid="ocean-tripolar">
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_z_annual" ></timeSeries> 
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_z_annual" ></timeSeries> 
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" source="ocean_z_annual" ></timeSeries> 
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" >
        <!--
        <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/ice_ocean_SIS/OM4_025/ocn_annual.frepp"/>
        -->
        </timeAverage>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="ocean_rho2" start="$(PP_START_YEAR)" source="ocean_annual_rho2" sourceGrid="ocean-tripolar">  
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_annual_rho2"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_annual_rho2"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" source="ocean_annual_rho2"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component> 
     </postProcess>
   </freInclude>

   <freInclude name="SPEAR_c96_PostP_Control_20171220">
      <!-- Adds river_daily and land_daily postprocessing -->
      <postProcess> 
         <csh><![CDATA[
         cd $work/RESTART
         ncrcat icebergs.res.nc.* icebergs.res.nc
         if(-e icebergs.res.nc) rm -f icebergs.res.nc.*
         cd $work
         ncrcat iceberg_trajectories.nc.* iceberg_trajectories.nc
         rm -f iceberg_trajectories.nc.* 
         #Save the last line of timestats without the first (step number) column as a signature of MOM6 answers
         tail -1 timestats | cut -c8- > RESTART/$enddate.timestats.res
         #Save the whole timestats under ascii/
         mv timestats $enddate.timestats
         mv timestats.nc $enddate.timestats.nc

         #Make a directory to trick FRE to pick up and archive in ascii
         mkdir extra.results

         mv *velocity_truncations CPU_stats SIS_parameter_doc* MOM_parameter_doc* seaice.stats timestats ocean.stats *.ocean.stats* extra.results/

         ]]>
         </csh>
      <!--REFINE DIAG SCRIPT -->
      <!--By default a refineDiag script causes the annual data to be unpacked and saved in /ptmp/$USER-->
      <refineDiag script="$(includeDir)/refineDiag/dummy_refineDiag.csh,$(includeDir)/refineDiag/refineDiag_data_stager_globalAve.csh"/>
      <!--MOM6_refineDiag.csh is currently empty and is here only to cause the unpack annual history files in /ptmp-->
      <!--
      <refineDiag script="$(NB_ROOT)/mom6/tools/analysis/MOM6_refineDiag.csh,$(includeDir)/refineDiag/refineDiag_data_stager_globalAve.csh"/>
      -->
<!-- Tony said to comment this out for now. -->
      <!--PostProcessing component models-->
      <component type="atmos_daily" zInterp="ncep"  start="$(PP_START_YEAR)"  source="atmos_daily" sourceGrid="atmos-cubedsphere" xyInterp="180,288" >
	<timeSeries freq="daily" source="atmos_daily" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="daily" source="atmos_daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="atmos_4xdaily" zInterp="ncep"   start="$(PP_START_YEAR)" source="atmos_4xdaily" sourceGrid="atmos-cubedsphere" xyInterp="180,288" >
        <timeSeries freq="6hr" source="atmos_4xdaily" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="6hr" source="atmos_4xdaily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="atmos_4xdaily_avg" zInterp="ncep"   start="$(PP_START_YEAR)" source="atmos_4xdaily_avg" sourceGrid="atmos-cubedsphere" xyInterp="180,288" >
        <timeSeries freq="6hr" source="atmos_4xdaily_avg" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="6hr" source="atmos_4xdaily_avg" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="atmos" zInterp="ncep" start="$(PP_START_YEAR)"  source="atmos_month" sourceGrid="atmos-cubedsphere" xyInterp="180,288" >
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)">
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="$FRE_ANALYSIS_HOME/cjg/stub/cjg_atmos_ts_mon.csh"/>
          <!-- Analysis scripts from Andrew Wittenberg
          annual and seasonal climatology -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja -v tau_x,tau_y,tau_curl,wind_div,ps,t_surf,t_diff,rh_ref,olr,tot_cld,hi_cld,mid_cld,lo_cld,wvp,cwp,u_ref,v_ref,tau_div vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_oaflux"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_cmap_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_gpcp_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_qscat"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_ersst_v3"/>
          <!-- clim and anomaly stddevs, regressions -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3 -t all -v tau_x,tau_y,tau_curl,wind_div,ps,t_surf,t_diff,rh_ref,olr,tot_cld,hi_cld,mid_cld,lo_cld,wvp,cwp,u_ref,v_ref,tau_div vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3,std -C clim -t all vs_oaflux"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3,std,anom_std -C clim -t all vs_cmap_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3,std,anom_std -C clim -t all vs_gpcp_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a std,anom_std -C clim -t all -v tau_x,tau_y,t_surf vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a std,anom_std -C clim -t all -v tau_x,tau_y,wind vs_qscat"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3,std,anom_std -C clim -t all vs_ersst_v3"/>
          <!-- total correlations with local SST -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all -v tau_x,tau_y,tau_curl,wind_div,ps,t_diff,rh_ref,olr,tot_cld,hi_cld,mid_cld,lo_cld,wvp,cwp,u_ref,v_ref,tau_div vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all vs_oaflux"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all vs_cmap_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all vs_gpcp_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all -v tau_x,tau_y,wind vs_qscat"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all vs_ersst_v3"/>
          <!-- anomaly correlations with local SST -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all -v tau_x,tau_y,tau_curl,wind_div,ps,t_diff,rh_ref,olr,tot_cld,hi_cld,mid_cld,lo_cld,wvp,cwp,u_ref,v_ref,tau_div vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all vs_oaflux"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all vs_cmap_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all vs_gpcp_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all -v tau_x,tau_y,wind vs_qscat"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all vs_ersst_v3"/>
          <!-- wavelet plots of climate indices -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/index/frepp.atw_atmos_ts_monthly_index.csh -n -s -a tave_spectrum vs_obs"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/index/frepp.atw_atmos_ts_monthly_index.csh -n -s -a wavelet_density solo"/>
          <!-- global analysis -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -a clim -t all -v t_surf -y -90,90,20,1 -N globe -p globe vs_era40"/>
          <!-- Koppen climate types -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/koppen/frepp.atw_atmos_ts_monthly_koppen.csh -n -s vs_uea"/>
        </timeSeries>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_C)">
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/bw_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/bw_cru_precip.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/bw_atmos_tauu_atl_pac.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/pjk_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/tk_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/lwh_atmos_av_mon.csh"/> 
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjg/stub/cjg_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/radiation_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/sak_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/sak_lwp_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/sak_precip_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/yim_aer_cld.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/precip_water_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/liquid_cloud_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/ice_cloud_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/surface_atmos_av_mon.csh"/>
          <!--
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="/home/fms/local/opt/fre-analysis/test/eem/code/pcmdi_metrics/frepp.pcmdi_metrics.atmos.csh -c amip"/> 
          -->
      <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$FRE_ANALYSIS_HOME/eem/code/pcmdi_metrics/frepp.pcmdi_metrics_v1p1p1.atmos.csh -c amip"/>
        </timeAverage>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)">
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_av_annual/column/frepp.atw_atmos_av_annual_column.csh -s solo"/>
        </timeAverage>
      </component>
      <component type="atmos_month_aer"  start="$(PP_START_YEAR)" source="atmos_month_aer" sourceGrid="atmos-cubedsphere" xyInterp="180,288">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="atmos_scalar" start="$(PP_START_YEAR)"  source="atmos_scalar">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"  source="atmos_scalar"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" source="atmos_scalar"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"  source="atmos_scalar"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" source="atmos_scalar"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ice_daily" start="$(PP_START_YEAR)"   source="ice_daily">
	<timeSeries freq="daily" source="ice_daily" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="daily" source="ice_daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ice"  start="$(PP_START_YEAR)" sourceGrid="ocean-tripolar">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"  source="ice_month"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"  source="ice_month"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)"  source="ice_month"/>
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_C)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"  source="ice_month"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"  source="ice_month"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)"  source="ice_month"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="iceberg"  start="$(PP_START_YEAR)" sourceGrid="ocean-tripolar">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"  source="iceberg_month">
	</timeSeries>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"  source="iceberg_month">
	</timeSeries>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)"  source="iceberg_month">
	</timeSeries>
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_C)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" > 
	</timeSeries>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" > 
	</timeSeries>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" > 
	</timeSeries>
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_C)"/>
      </component>
      <component type="land_daily"  start="$(PP_START_YEAR)"  source="land_daily" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="192,384">
	<timeSeries freq="daily" source="land_daily" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="daily" source="land_daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="land"  start="$(PP_START_YEAR)"  source="land_month" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="192,384">
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)">
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="yes" script="$FRE_ANALYSIS_HOME/kap/stub/kap_land_ts_reg_rad.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="yes" script="$FRE_ANALYSIS_HOME/kap/stub/kap_land_ts_reg_web.csh"/>
        </timeSeries>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)" >
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/kap/stub/kap_land_av.csh"/>
        </timeAverage>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="land_inst_month"   start="$(PP_START_YEAR)" source="land_month_inst" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="192,384">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="river_daily"  start="$(PP_START_YEAR)"  source="river_daily" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="192,384">
	<timeSeries freq="daily" source="river_daily" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="daily" source="river_daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="river"  start="$(PP_START_YEAR)"  source="river_month" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="192,384">
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="river_inst_month"   start="$(PP_START_YEAR)" source="river_month_inst" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="192,384">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="river_cubic" start="$(PP_START_YEAR)" source="river_month" sourceGrid="land-cubedsphere" cmip="off">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" >
          <analysis switch="on" cumulative="yes" script="$FRE_ANALYSIS_HOME/kap/stub/kap_land_basin_map.csh"/>
        </timeSeries>
        <timeSeries freq="daily" source="river_daily" chunkLength="$(CHUNK_LENGTH_A)">
          <analysis switch="on" cumulative="yes" script="$FRE_ANALYSIS_HOME/kap/stub/kap_land_ts_bas_dly.csh"/>
        </timeSeries>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)" />
      </component>
      <component type="ocean_scalar" start="$(PP_START_YEAR)"  source="ocean_scalar_month"  sourceGrid="ocean-tripolar">  
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" />
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_C)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component> 
      <component type="ocean" start="$(PP_START_YEAR)"   sourceGrid="ocean-tripolar">  
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_month"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_month"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" source="ocean_month"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_C)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component> 
      <component type="ocean_z"   start="$(PP_START_YEAR)" sourceGrid="ocean-tripolar">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_z_month"> </timeSeries>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_z_month"> </timeSeries>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" source="ocean_z_month">
        <!--
        <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/ice_ocean_SIS/OM4_025/ocn_monthly.frepp"/>
        -->
        </timeSeries>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_C)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_z_month"> </timeSeries>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_z_month"> </timeSeries>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" source="ocean_z_month">
        <!--
        <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/ice_ocean_SIS/OM4_025/ocn_monthly.frepp"/>
        -->
        </timeSeries>  
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="ocean_z_ann"   start="$(PP_START_YEAR)" source="ocean_z_annual" sourceGrid="ocean-tripolar">
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_z_annual" ></timeSeries> 
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_z_annual" ></timeSeries> 
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" source="ocean_z_annual" ></timeSeries> 
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" >
        <!--
        <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/ice_ocean_SIS/OM4_025/ocn_annual.frepp"/>
        -->
        </timeAverage>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="ocean_rho2" start="$(PP_START_YEAR)" source="ocean_month_rho2" sourceGrid="ocean-tripolar">  
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_month_rho2"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_month_rho2"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" source="ocean_month_rho2"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_C)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component> 
     </postProcess>
  </freInclude>


  <freInclude name="SPEAR_c192_PostP_Control_withdaily">
      <postProcess> 
         <csh><![CDATA[
         cd $work/RESTART
         ncrcat icebergs.res.nc.* icebergs.res.nc
         if(-e icebergs.res.nc) rm -f icebergs.res.nc.*
         cd $work
         ncrcat iceberg_trajectories.nc.* iceberg_trajectories.nc
         rm -f iceberg_trajectories.nc.* 
         #Save the last line of timestats without the first (step number) column as a signature of MOM6 answers
         tail -1 timestats | cut -c8- > RESTART/$enddate.timestats.res
         #Save the whole timestats under ascii/
         mv timestats $enddate.timestats
         mv timestats.nc $enddate.timestats.nc

         #Make a directory to trick FRE to pick up and archive in ascii
         mkdir extra.results

         mv *velocity_truncations CPU_stats SIS_parameter_doc* MOM_parameter_doc* seaice.stats timestats ocean.stats *.ocean.stats* extra.results/
         ]]>
         </csh>
      <!--REFINE DIAG SCRIPT -->
      <!--By default a refineDiag script causes the annual data to be unpacked and saved in /ptmp/$USER-->
      <!--MOM6_refineDiag.csh is currently empty and is here only to cause the unpack annual history files in /ptmp-->
      <!--
      <refineDiag script="$(includeDir)/refineDiag/dummy_refineDiag.csh"/>
      -->
      <refineDiag script="$(includeDir)/refineDiag/refineDiag_data_stager_globalAve.csh"/>
      <!--
      <refineDiag script="$(NB_ROOT)/mom6/tools/analysis/MOM6_refineDiag.csh,$(includeDir)/refineDiag/refineDiag_data_stager_globalAve.csh"/>
      -->
      <!-- Tony said to comment this out for now. -->
      <!--PostProcessing component models-->
      <component type="atmos_daily" zInterp="ncep"  start="$(PP_START_YEAR)"  source="atmos_daily" sourceGrid="atmos-cubedsphere" xyInterp="360,576" >
	<timeSeries freq="daily" source="atmos_daily" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="daily" source="atmos_daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="atmos_4xdaily" zInterp="ncep"   start="$(PP_START_YEAR)" source="atmos_4xdaily" sourceGrid="atmos-cubedsphere" xyInterp="360,576" >
        <timeSeries freq="6hr" source="atmos_4xdaily" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="6hr" source="atmos_4xdaily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="atmos_4xdaily_avg" zInterp="ncep"   start="$(PP_START_YEAR)" source="atmos_4xdaily_avg" sourceGrid="atmos-cubedsphere" xyInterp="360,576" >
        <timeSeries freq="6hr" source="atmos_4xdaily_avg" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="6hr" source="atmos_4xdaily_avg" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="atmos" zInterp="ncep" start="$(PP_START_YEAR)"  source="atmos_month" sourceGrid="atmos-cubedsphere" xyInterp="360,576" >
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)">
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="$FRE_ANALYSIS_HOME/cjg/stub/cjg_atmos_ts_mon.csh"/>
          <!-- Analysis scripts from Andrew Wittenberg
          annual and seasonal climatology -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja -v tau_x,tau_y,tau_curl,wind_div,ps,t_surf,t_diff,rh_ref,olr,tot_cld,hi_cld,mid_cld,lo_cld,wvp,cwp,u_ref,v_ref,tau_div vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_oaflux"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_cmap_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_gpcp_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_qscat"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_ersst_v3"/>
          <!-- clim and anomaly stddevs, regressions -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3 -t all -v tau_x,tau_y,tau_curl,wind_div,ps,t_surf,t_diff,rh_ref,olr,tot_cld,hi_cld,mid_cld,lo_cld,wvp,cwp,u_ref,v_ref,tau_div vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3,std -C clim -t all vs_oaflux"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3,std,anom_std -C clim -t all vs_cmap_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3,std,anom_std -C clim -t all vs_gpcp_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a std,anom_std -C clim -t all -v tau_x,tau_y,t_surf vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a std,anom_std -C clim -t all -v tau_x,tau_y,wind vs_qscat"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3,std,anom_std -C clim -t all vs_ersst_v3"/>
          <!-- total correlations with local SST -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all -v tau_x,tau_y,tau_curl,wind_div,ps,t_diff,rh_ref,olr,tot_cld,hi_cld,mid_cld,lo_cld,wvp,cwp,u_ref,v_ref,tau_div vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all vs_oaflux"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all vs_cmap_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all vs_gpcp_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all -v tau_x,tau_y,wind vs_qscat"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all vs_ersst_v3"/>
          <!-- anomaly correlations with local SST -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all -v tau_x,tau_y,tau_curl,wind_div,ps,t_diff,rh_ref,olr,tot_cld,hi_cld,mid_cld,lo_cld,wvp,cwp,u_ref,v_ref,tau_div vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all vs_oaflux"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all vs_cmap_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all vs_gpcp_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all -v tau_x,tau_y,wind vs_qscat"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all vs_ersst_v3"/>
          <!-- wavelet plots of climate indices -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/index/frepp.atw_atmos_ts_monthly_index.csh -n -s -a tave_spectrum vs_obs"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/index/frepp.atw_atmos_ts_monthly_index.csh -n -s -a wavelet_density solo"/>
          <!-- global analysis -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -a clim -t all -v t_surf -y -90,90,20,1 -N globe -p globe vs_era40"/>
          <!-- Koppen climate types -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/koppen/frepp.atw_atmos_ts_monthly_koppen.csh -n -s vs_uea"/>
        </timeSeries>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_C)">
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/bw_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/bw_cru_precip.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/bw_atmos_tauu_atl_pac.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/pjk_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/tk_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/lwh_atmos_av_mon.csh"/> 
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjg/stub/cjg_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/radiation_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/sak_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/sak_lwp_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/sak_precip_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/yim_aer_cld.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/precip_water_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/liquid_cloud_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/ice_cloud_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/surface_atmos_av_mon.csh"/>
          <!--
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="/home/fms/local/opt/fre-analysis/test/eem/code/pcmdi_metrics/frepp.pcmdi_metrics.atmos.csh -c amip"/>
          -->
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$FRE_ANALYSIS_HOME/eem/code/pcmdi_metrics/frepp.pcmdi_metrics_v1p1p1.atmos.csh -c amip"/>
        </timeAverage>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)">
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_av_annual/column/frepp.atw_atmos_av_annual_column.csh -s solo"/>
        </timeAverage>
      </component>
      <component type="atmos_month_aer"  start="$(PP_START_YEAR)" source="atmos_month_aer" sourceGrid="atmos-cubedsphere" xyInterp="360,576">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="atmos_scalar" start="$(PP_START_YEAR)"  source="atmos_scalar">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"  source="atmos_scalar"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" source="atmos_scalar"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"  source="atmos_scalar"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" source="atmos_scalar"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ice_daily" start="$(PP_START_YEAR)"   source="ice_daily">
	<timeSeries freq="daily" source="ice_daily" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="daily" source="ice_daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ice"  start="$(PP_START_YEAR)" sourceGrid="ocean-tripolar">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"  source="ice_month"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"  source="ice_month"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)"  source="ice_month"/>
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_C)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"  source="ice_month"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"  source="ice_month"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)"  source="ice_month"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="iceberg"  start="$(PP_START_YEAR)" sourceGrid="ocean-tripolar">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"  source="iceberg_month">
	</timeSeries>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"  source="iceberg_month">
	</timeSeries>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)"  source="iceberg_month">
	</timeSeries>
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_C)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" > 
	</timeSeries>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" > 
	</timeSeries>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" > 
	</timeSeries>
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_C)"/>
      </component>
      <component type="land_daily"  start="$(PP_START_YEAR)"  source="land_daily" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="384,768">
	<timeSeries freq="daily" source="land_daily" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="daily" source="land_daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="land"  start="$(PP_START_YEAR)"  source="land_month" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="384,768">
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="land_inst_month"   start="$(PP_START_YEAR)" source="land_month_inst" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="384,768">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="river_daily"  start="$(PP_START_YEAR)"  source="river_daily" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="384,768">
	<timeSeries freq="daily" source="river_daily" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="daily" source="river_daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="river"  start="$(PP_START_YEAR)"  source="river_month" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="384,768">
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="river_inst_month"   start="$(PP_START_YEAR)" source="river_month_inst" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="384,768">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_scalar" start="$(PP_START_YEAR)"  source="ocean_scalar_month"  sourceGrid="ocean-tripolar">  
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" />
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_C)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component> 
      <component type="ocean" start="$(PP_START_YEAR)"   sourceGrid="ocean-tripolar">  
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_month"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_month"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" source="ocean_month"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_C)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component> 
      <component type="ocean_z"   start="$(PP_START_YEAR)" sourceGrid="ocean-tripolar">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_z_month"> </timeSeries>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_z_month"> </timeSeries>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" source="ocean_z_month">
        <!--
        <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/ice_ocean_SIS/OM4_025/ocn_monthly.frepp"/>
        -->
        </timeSeries>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_C)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_z_month"> </timeSeries>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_z_month"> </timeSeries>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" source="ocean_z_month">
        <!--
        <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/ice_ocean_SIS/OM4_025/ocn_monthly.frepp"/>
        -->
        </timeSeries>  
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="ocean_z_ann"   start="$(PP_START_YEAR)" source="ocean_z_annual" sourceGrid="ocean-tripolar">
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_z_annual" ></timeSeries> 
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_z_annual" ></timeSeries> 
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" source="ocean_z_annual" ></timeSeries> 
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" >  
        <!--
        <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/ice_ocean_SIS/OM4_025/ocn_annual.frepp"/>
        -->
        </timeAverage>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="ocean_rho2" start="$(PP_START_YEAR)" source="ocean_month_rho2" sourceGrid="ocean-tripolar">  
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_month_rho2"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_month_rho2"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" source="ocean_month_rho2"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_C)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component> 
     </postProcess>
  </freInclude>

  <freInclude name="SPEAR_c384_PostP_Control_withdaily">
      <postProcess> 
         <csh><![CDATA[
         cd $work/RESTART
         ncrcat icebergs.res.nc.* icebergs.res.nc
         if(-e icebergs.res.nc) rm -f icebergs.res.nc.*
         cd $work
         ncrcat iceberg_trajectories.nc.* iceberg_trajectories.nc
         rm -f iceberg_trajectories.nc.* 
         #Save the last line of timestats without the first (step number) column as a signature of MOM6 answers
         tail -1 timestats | cut -c8- > RESTART/$enddate.timestats.res
         #Save the whole timestats under ascii/
         mv timestats $enddate.timestats
         mv timestats.nc $enddate.timestats.nc

         #Make a directory to trick FRE to pick up and archive in ascii
         mkdir extra.results

         mv *velocity_truncations CPU_stats SIS_parameter_doc* MOM_parameter_doc* seaice.stats timestats ocean.stats *.ocean.stats* extra.results/
         ]]>
         </csh>
      <!--REFINE DIAG SCRIPT -->
      <!--By default a refineDiag script causes the annual data to be unpacked and saved in /ptmp/$USER-->
      <!--MOM6_refineDiag.csh is currently empty and is here only to cause the unpack annual history files in /ptmp-->
      <!--
      <refineDiag script="$(includeDir)/refineDiag/dummy_refineDiag.csh"/>
      -->
      <refineDiag script="$(includeDir)/refineDiag/refineDiag_data_stager_globalAve.csh,$(includeDir)/refineDiag/VertVelocity.csh"/>
      <!--
      <refineDiag script="$(NB_ROOT)/mom6/tools/analysis/MOM6_refineDiag.csh,$(includeDir)/refineDiag/refineDiag_data_stager_globalAve.csh"/>
      -->
      <!-- Tony said to comment this out for now. -->
      <!--PostProcessing component models-->
      <component type="atmos_daily" zInterp="ncep"  start="$(PP_START_YEAR)"  source="atmos_daily" sourceGrid="atmos-cubedsphere" xyInterp="720,1152" >
	<timeSeries freq="daily" source="atmos_daily" chunkLength="$(CHUNK_LENGTH_A_c384)"/>
	<timeSeries freq="daily" source="atmos_daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="atmos_4xdaily" zInterp="ncep"   start="$(PP_START_YEAR)" source="atmos_4xdaily" sourceGrid="atmos-cubedsphere" xyInterp="720,1152" >
        <timeSeries freq="6hr" source="atmos_4xdaily" chunkLength="$(CHUNK_LENGTH_A_c384)"/>
        <timeSeries freq="6hr" source="atmos_4xdaily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="atmos_4xdaily_avg" zInterp="ncep"   start="$(PP_START_YEAR)" source="atmos_4xdaily_avg" sourceGrid="atmos-cubedsphere" xyInterp="720,1152" >
        <timeSeries freq="6hr" source="atmos_4xdaily_avg" chunkLength="$(CHUNK_LENGTH_A_c384)"/>
        <timeSeries freq="6hr" source="atmos_4xdaily_avg" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="atmos" zInterp="ncep" start="$(PP_START_YEAR)"  source="atmos_month" sourceGrid="atmos-cubedsphere" xyInterp="720,1152" >
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A_c384)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A_c384)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)">
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="$FRE_ANALYSIS_HOME/cjg/stub/cjg_atmos_ts_mon.csh"/>
          <!-- Analysis scripts from Andrew Wittenberg
          annual and seasonal climatology -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja -v tau_x,tau_y,tau_curl,wind_div,ps,t_surf,t_diff,rh_ref,olr,tot_cld,hi_cld,mid_cld,lo_cld,wvp,cwp,u_ref,v_ref,tau_div vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_oaflux"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_cmap_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_gpcp_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_qscat"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_ersst_v3"/>
          <!-- clim and anomaly stddevs, regressions -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3 -t all -v tau_x,tau_y,tau_curl,wind_div,ps,t_surf,t_diff,rh_ref,olr,tot_cld,hi_cld,mid_cld,lo_cld,wvp,cwp,u_ref,v_ref,tau_div vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3,std -C clim -t all vs_oaflux"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3,std,anom_std -C clim -t all vs_cmap_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3,std,anom_std -C clim -t all vs_gpcp_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a std,anom_std -C clim -t all -v tau_x,tau_y,t_surf vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a std,anom_std -C clim -t all -v tau_x,tau_y,wind vs_qscat"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3,std,anom_std -C clim -t all vs_ersst_v3"/>
          <!-- total correlations with local SST -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all -v tau_x,tau_y,tau_curl,wind_div,ps,t_diff,rh_ref,olr,tot_cld,hi_cld,mid_cld,lo_cld,wvp,cwp,u_ref,v_ref,tau_div vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all vs_oaflux"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all vs_cmap_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all vs_gpcp_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all -v tau_x,tau_y,wind vs_qscat"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all vs_ersst_v3"/>
          <!-- anomaly correlations with local SST -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all -v tau_x,tau_y,tau_curl,wind_div,ps,t_diff,rh_ref,olr,tot_cld,hi_cld,mid_cld,lo_cld,wvp,cwp,u_ref,v_ref,tau_div vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all vs_oaflux"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all vs_cmap_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all vs_gpcp_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all -v tau_x,tau_y,wind vs_qscat"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all vs_ersst_v3"/>
          <!-- wavelet plots of climate indices -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/index/frepp.atw_atmos_ts_monthly_index.csh -n -s -a tave_spectrum vs_obs"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/index/frepp.atw_atmos_ts_monthly_index.csh -n -s -a wavelet_density solo"/>
          <!-- global analysis -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -a clim -t all -v t_surf -y -90,90,20,1 -N globe -p globe vs_era40"/>
          <!-- Koppen climate types -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/koppen/frepp.atw_atmos_ts_monthly_koppen.csh -n -s vs_uea"/>
        </timeSeries>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_C)">
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/bw_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/bw_cru_precip.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/bw_atmos_tauu_atl_pac.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/pjk_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/tk_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/lwh_atmos_av_mon.csh"/> 
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjg/stub/cjg_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/radiation_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/sak_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/sak_lwp_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/sak_precip_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/yim_aer_cld.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/precip_water_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/liquid_cloud_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/ice_cloud_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/surface_atmos_av_mon.csh"/>
          <!--
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="/home/fms/local/opt/fre-analysis/test/eem/code/pcmdi_metrics/frepp.pcmdi_metrics.atmos.csh -c amip"/>
          -->
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$FRE_ANALYSIS_HOME/eem/code/pcmdi_metrics/frepp.pcmdi_metrics_v1p1p1.atmos.csh -c amip"/>
        </timeAverage>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A_c384)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)">
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_av_annual/column/frepp.atw_atmos_av_annual_column.csh -s solo"/>
        </timeAverage>
      </component>
      <component type="atmos_month_aer"  start="$(PP_START_YEAR)" source="atmos_month_aer" sourceGrid="atmos-cubedsphere" xyInterp="720,1152">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A_c384)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A_c384)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="atmos_scalar" start="$(PP_START_YEAR)"  source="atmos_scalar">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A_c384)"  source="atmos_scalar"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" source="atmos_scalar"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A_c384)"  source="atmos_scalar"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" source="atmos_scalar"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ice_daily" start="$(PP_START_YEAR)"   source="ice_daily">
	<timeSeries freq="daily" source="ice_daily" chunkLength="$(CHUNK_LENGTH_A_c384)"/>
	<timeSeries freq="daily" source="ice_daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ice"  start="$(PP_START_YEAR)" sourceGrid="ocean-tripolar">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A_c384)"  source="ice_month"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"  source="ice_month"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)"  source="ice_month"/>
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_A_c384)"/>
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_C)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A_c384)"  source="ice_month"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"  source="ice_month"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)"  source="ice_month"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A_c384)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="iceberg"  start="$(PP_START_YEAR)" sourceGrid="ocean-tripolar">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A_c384)"  source="iceberg_month">
	</timeSeries>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"  source="iceberg_month">
	</timeSeries>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)"  source="iceberg_month">
	</timeSeries>
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_A_c384)"/>
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_C)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A_c384)" > 
	</timeSeries>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" > 
	</timeSeries>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" > 
	</timeSeries>
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_A_c384)"/>
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_C)"/>
      </component>
      <component type="land_daily"  start="$(PP_START_YEAR)"  source="land_daily" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="768,1536">
	<timeSeries freq="daily" source="land_daily" chunkLength="$(CHUNK_LENGTH_A_c384)"/>
	<timeSeries freq="daily" source="land_daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="land"  start="$(PP_START_YEAR)"  source="land_month" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="768,1536">
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A_c384)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A_c384)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A_c384)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="land_inst_month"   start="$(PP_START_YEAR)" source="land_month_inst" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="768,1536">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A_c384)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="river_daily"  start="$(PP_START_YEAR)"  source="river_daily" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="768,1536">
	<timeSeries freq="daily" source="river_daily" chunkLength="$(CHUNK_LENGTH_A_c384)"/>
	<timeSeries freq="daily" source="river_daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="river"  start="$(PP_START_YEAR)"  source="river_month" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="768,1536">
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A_c384)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A_c384)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A_c384)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="river_inst_month"   start="$(PP_START_YEAR)" source="river_month_inst" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="768,1536">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A_c384)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_scalar" start="$(PP_START_YEAR)"  source="ocean_scalar_month"  sourceGrid="ocean-tripolar">  
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A_c384)" />
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A_c384)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_C)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A_c384)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A_c384)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component> 
      <component type="ocean" start="$(PP_START_YEAR)"   sourceGrid="ocean-tripolar">  
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A_c384)" source="ocean_month"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_month"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" source="ocean_month"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A_c384)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_C)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A_c384)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A_c384)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component> 
      <component type="ocean_z"   start="$(PP_START_YEAR)" sourceGrid="ocean-tripolar">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A_c384)" source="ocean_z_month"> </timeSeries>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_z_month"> </timeSeries>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" source="ocean_z_month">
        <!--
        <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/ice_ocean_SIS/OM4_025/ocn_monthly.frepp"/>
        -->
        </timeSeries>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A_c384)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_C)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A_c384)" source="ocean_z_month"> </timeSeries>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_z_month"> </timeSeries>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" source="ocean_z_month">
        <!--
        <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/ice_ocean_SIS/OM4_025/ocn_monthly.frepp"/>
        -->
        </timeSeries>  
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A_c384)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="ocean_z_ann"   start="$(PP_START_YEAR)" source="ocean_z_annual" sourceGrid="ocean-tripolar">
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A_c384)" source="ocean_z_annual" ></timeSeries> 
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_z_annual" ></timeSeries> 
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" source="ocean_z_annual" ></timeSeries> 
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A_c384)" >  
        <!--
        <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/ice_ocean_SIS/OM4_025/ocn_annual.frepp"/>
        -->
        </timeAverage>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="ocean_rho2" start="$(PP_START_YEAR)" source="ocean_month_rho2" sourceGrid="ocean-tripolar">  
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A_c384)" source="ocean_month_rho2"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_month_rho2"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" source="ocean_month_rho2"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A_c384)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_C)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A_c384)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A_c384)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component> 
     </postProcess>
  </freInclude>

  <freInclude name="SPEAR_c192_PostP_Control_ensemble">
      <postProcess> 
         <csh><![CDATA[
         cd $work/RESTART
         ncrcat icebergs.res.nc.* icebergs.res.nc
         if(-e icebergs.res.nc) rm -f icebergs.res.nc.*
         cd $work
         ncrcat iceberg_trajectories.nc.* iceberg_trajectories.nc
         rm -f iceberg_trajectories.nc.* 
         #Save the last line of timestats without the first (step number) column as a signature of MOM6 answers
         tail -1 timestats | cut -c8- > RESTART/$enddate.timestats.res
         #Save the whole timestats under ascii/
         mv timestats $enddate.timestats
         mv timestats.nc $enddate.timestats.nc

         #Make a directory to trick FRE to pick up and archive in ascii
         mkdir extra.results

         mv *velocity_truncations CPU_stats SIS_parameter_doc* MOM_parameter_doc* seaice.stats timestats ocean.stats *.ocean.stats* extra.results/
         ]]>
         </csh>
      <!--REFINE DIAG SCRIPT -->
      <!--By default a refineDiag script causes the annual data to be unpacked and saved in /ptmp/$USER-->
      <!--MOM6_refineDiag.csh is currently empty and is here only to cause the unpack annual history files in /ptmp-->
      <!--
      <refineDiag script="$(includeDir)/refineDiag/dummy_refineDiag.csh"/>
      -->
      <refineDiag script="$(includeDir)/refineDiag/dummy_refineDiag.csh,$(includeDir)/refineDiag/SPEAR_refineDiag.csh,"/>
      <!--
      <refineDiag script="$(includeDir)/refineDiag/refineDiag_data_stager_globalAve.csh"/>
      -->
      <!--
      <refineDiag script="$(NB_ROOT)/mom6/tools/analysis/MOM6_refineDiag.csh,$(includeDir)/refineDiag/refineDiag_data_stager_globalAve.csh"/>
      -->
      <!-- Tony said to comment this out for now. -->
      <!--PostProcessing component models-->
      <component type="atmos_daily" zInterp="ncep"  start="$(PP_START_YEAR)"  source="atmos_daily" sourceGrid="atmos-cubedsphere" xyInterp="360,576" >
	<timeSeries freq="daily" source="atmos_daily" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="daily" source="atmos_daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="atmos_4xdaily" zInterp="ncep"   start="$(PP_START_YEAR)" source="atmos_4xdaily" sourceGrid="atmos-cubedsphere" xyInterp="360,576" >
        <timeSeries freq="6hr" source="atmos_4xdaily" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="6hr" source="atmos_4xdaily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="atmos_4xdaily_avg" zInterp="ncep"   start="$(PP_START_YEAR)" source="atmos_4xdaily_avg" sourceGrid="atmos-cubedsphere" xyInterp="360,576" >
        <timeSeries freq="6hr" source="atmos_4xdaily_avg" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="6hr" source="atmos_4xdaily_avg" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="atmos" zInterp="ncep" start="$(PP_START_YEAR)"  source="atmos_month" sourceGrid="atmos-cubedsphere" xyInterp="360,576" >
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)">
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="$FRE_ANALYSIS_HOME/cjg/stub/cjg_atmos_ts_mon.csh"/>
          <!-- Analysis scripts from Andrew Wittenberg
          annual and seasonal climatology -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja -v tau_x,tau_y,tau_curl,wind_div,ps,t_surf,t_diff,rh_ref,olr,tot_cld,hi_cld,mid_cld,lo_cld,wvp,cwp,u_ref,v_ref,tau_div vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_oaflux"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_cmap_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_gpcp_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_qscat"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_ersst_v3"/>
          <!-- clim and anomaly stddevs, regressions -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3 -t all -v tau_x,tau_y,tau_curl,wind_div,ps,t_surf,t_diff,rh_ref,olr,tot_cld,hi_cld,mid_cld,lo_cld,wvp,cwp,u_ref,v_ref,tau_div vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3,std -C clim -t all vs_oaflux"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3,std,anom_std -C clim -t all vs_cmap_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3,std,anom_std -C clim -t all vs_gpcp_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a std,anom_std -C clim -t all -v tau_x,tau_y,t_surf vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a std,anom_std -C clim -t all -v tau_x,tau_y,wind vs_qscat"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3,std,anom_std -C clim -t all vs_ersst_v3"/>
          <!-- total correlations with local SST -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all -v tau_x,tau_y,tau_curl,wind_div,ps,t_diff,rh_ref,olr,tot_cld,hi_cld,mid_cld,lo_cld,wvp,cwp,u_ref,v_ref,tau_div vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all vs_oaflux"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all vs_cmap_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all vs_gpcp_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all -v tau_x,tau_y,wind vs_qscat"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all vs_ersst_v3"/>
          <!-- anomaly correlations with local SST -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all -v tau_x,tau_y,tau_curl,wind_div,ps,t_diff,rh_ref,olr,tot_cld,hi_cld,mid_cld,lo_cld,wvp,cwp,u_ref,v_ref,tau_div vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all vs_oaflux"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all vs_cmap_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all vs_gpcp_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all -v tau_x,tau_y,wind vs_qscat"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all vs_ersst_v3"/>
          <!-- wavelet plots of climate indices -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/index/frepp.atw_atmos_ts_monthly_index.csh -n -s -a tave_spectrum vs_obs"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/index/frepp.atw_atmos_ts_monthly_index.csh -n -s -a wavelet_density solo"/>
          <!-- global analysis -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -a clim -t all -v t_surf -y -90,90,20,1 -N globe -p globe vs_era40"/>
          <!-- Koppen climate types -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/koppen/frepp.atw_atmos_ts_monthly_koppen.csh -n -s vs_uea"/>
        </timeSeries>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_C)">
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/bw_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/bw_cru_precip.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/bw_atmos_tauu_atl_pac.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/pjk_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/tk_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/lwh_atmos_av_mon.csh"/> 
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjg/stub/cjg_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/radiation_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/sak_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/sak_lwp_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/sak_precip_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/yim_aer_cld.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/precip_water_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/liquid_cloud_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/ice_cloud_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/surface_atmos_av_mon.csh"/>
          <!--
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="/home/fms/local/opt/fre-analysis/test/eem/code/pcmdi_metrics/frepp.pcmdi_metrics.atmos.csh -c amip"/>
          -->
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$FRE_ANALYSIS_HOME/eem/code/pcmdi_metrics/frepp.pcmdi_metrics_v1p1p1.atmos.csh -c amip"/>
        </timeAverage>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)">
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_av_annual/column/frepp.atw_atmos_av_annual_column.csh -s solo"/>
        </timeAverage>
      </component>
      <component type="atmos_month_aer"  start="$(PP_START_YEAR)" source="atmos_month_aer" sourceGrid="atmos-cubedsphere" xyInterp="360,576">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="atmos_scalar" start="$(PP_START_YEAR)"  source="atmos_scalar">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"  source="atmos_scalar"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" source="atmos_scalar"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"  source="atmos_scalar"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" source="atmos_scalar"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ice_daily" start="$(PP_START_YEAR)"   source="ice_daily">
	<timeSeries freq="daily" source="ice_daily" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="daily" source="ice_daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ice"  start="$(PP_START_YEAR)" sourceGrid="ocean-tripolar">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"  source="ice_month"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"  source="ice_month"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)"  source="ice_month"/>
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_C)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"  source="ice_month"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"  source="ice_month"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)"  source="ice_month"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="iceberg"  start="$(PP_START_YEAR)" sourceGrid="ocean-tripolar">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"  source="iceberg_month">
	</timeSeries>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"  source="iceberg_month">
	</timeSeries>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)"  source="iceberg_month">
	</timeSeries>
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_C)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" > 
	</timeSeries>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" > 
	</timeSeries>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" > 
	</timeSeries>
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_C)"/>
      </component>
      <component type="land_daily"  start="$(PP_START_YEAR)"  source="land_daily" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="384,768">
	<timeSeries freq="daily" source="land_daily" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="daily" source="land_daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="land"  start="$(PP_START_YEAR)"  source="land_month" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="384,768">
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="land_inst_month"   start="$(PP_START_YEAR)" source="land_month_inst" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="384,768">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="river_daily"  start="$(PP_START_YEAR)"  source="river_daily" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="384,768">
	<timeSeries freq="daily" source="river_daily" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="daily" source="river_daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="river"  start="$(PP_START_YEAR)"  source="river_month" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="384,768">
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="river_inst_month"   start="$(PP_START_YEAR)" source="river_month_inst" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="384,768">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_scalar" start="$(PP_START_YEAR)"  source="ocean_scalar_month"  sourceGrid="ocean-tripolar">  
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" />
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_C)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component> 
      <component type="ocean" start="$(PP_START_YEAR)"   sourceGrid="ocean-tripolar">  
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_month"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_month"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" source="ocean_month"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_C)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component> 
      <component type="ocean_z"   start="$(PP_START_YEAR)" sourceGrid="ocean-tripolar">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_z_month"> </timeSeries>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_z_month"> </timeSeries>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" source="ocean_z_month">
        <!--
        <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/ice_ocean_SIS/OM4_025/ocn_monthly.frepp"/>
        -->
        </timeSeries>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_C)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_z_month"> </timeSeries>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_z_month"> </timeSeries>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" source="ocean_z_month">
        <!--
        <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/ice_ocean_SIS/OM4_025/ocn_monthly.frepp"/>
        -->
        </timeSeries>  
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="ocean_z_ann"   start="$(PP_START_YEAR)" source="ocean_z_annual" sourceGrid="ocean-tripolar">
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_z_annual" ></timeSeries> 
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_z_annual" ></timeSeries> 
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" source="ocean_z_annual" ></timeSeries> 
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" >  
        <!--
        <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/ice_ocean_SIS/OM4_025/ocn_annual.frepp"/>
        -->
        </timeAverage>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="ocean_rho2" start="$(PP_START_YEAR)" source="ocean_month_rho2" sourceGrid="ocean-tripolar">  
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_month_rho2"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_month_rho2"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" source="ocean_month_rho2"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_C)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component> 
     </postProcess>
  </freInclude>

  <freInclude name="SPEAR_c192_PostP_Historical_1851">
      <postProcess> 
         <csh><![CDATA[
         cd $work/RESTART
         ncrcat icebergs.res.nc.* icebergs.res.nc
         if(-e icebergs.res.nc) rm -f icebergs.res.nc.*
         cd $work
         ncrcat iceberg_trajectories.nc.* iceberg_trajectories.nc
         rm -f iceberg_trajectories.nc.* 
         #Save the last line of timestats without the first (step number) column as a signature of MOM6 answers
         tail -1 timestats | cut -c8- > RESTART/$enddate.timestats.res
         #Save the whole timestats under ascii/
         mv timestats $enddate.timestats
         mv timestats.nc $enddate.timestats.nc

         #Make a directory to trick FRE to pick up and archive in ascii
         mkdir extra.results

         mv *velocity_truncations CPU_stats SIS_parameter_doc* MOM_parameter_doc* seaice.stats timestats ocean.stats *.ocean.stats* extra.results/
         ]]>
         </csh>
      <!--REFINE DIAG SCRIPT -->
      <!--By default a refineDiag script causes the annual data to be unpacked and saved in /ptmp/$USER-->
      <!--MOM6_refineDiag.csh is currently empty and is here only to cause the unpack annual history files in /ptmp-->
      <!--
      <refineDiag script="$(includeDir)/refineDiag/dummy_refineDiag.csh"/>
      -->
      <refineDiag script="$(includeDir)/refineDiag/refineDiag_data_stager_globalAve.csh,$(includeDir)/refineDiag/VertVelocity.csh"/>
      <!--
      <refineDiag script="$(NB_ROOT)/mom6/tools/analysis/MOM6_refineDiag.csh,$(includeDir)/refineDiag/refineDiag_data_stager_globalAve.csh"/>
      -->
      <!-- Tony said to comment this out for now. -->
      <!--PostProcessing component models-->
      <component type="atmos_daily" zInterp="ncep"  start="1851"  source="atmos_daily" sourceGrid="atmos-cubedsphere" xyInterp="180,288" >
	<timeSeries freq="daily" source="atmos_daily" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="daily" source="atmos_daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="atmos_4xdaily" zInterp="ncep"   start="1851" source="atmos_4xdaily" sourceGrid="atmos-cubedsphere" xyInterp="180,288" >
        <timeSeries freq="6hr" source="atmos_4xdaily" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="6hr" source="atmos_4xdaily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="atmos_4xdaily_avg" zInterp="ncep"   start="1851" source="atmos_4xdaily_avg" sourceGrid="atmos-cubedsphere" xyInterp="180,288" >
        <timeSeries freq="6hr" source="atmos_4xdaily_avg" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="6hr" source="atmos_4xdaily_avg" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="atmos" zInterp="ncep" start="1851"  source="atmos_month" sourceGrid="atmos-cubedsphere" xyInterp="360,576" >
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)">
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="$FRE_ANALYSIS_HOME/cjg/stub/cjg_atmos_ts_mon.csh"/>
          <!-- Analysis scripts from Andrew Wittenberg
          annual and seasonal climatology -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja -v tau_x,tau_y,tau_curl,wind_div,ps,t_surf,t_diff,rh_ref,olr,tot_cld,hi_cld,mid_cld,lo_cld,wvp,cwp,u_ref,v_ref,tau_div vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_oaflux"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_cmap_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_gpcp_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_qscat"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_ersst_v3"/>
          <!-- clim and anomaly stddevs, regressions -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3 -t all -v tau_x,tau_y,tau_curl,wind_div,ps,t_surf,t_diff,rh_ref,olr,tot_cld,hi_cld,mid_cld,lo_cld,wvp,cwp,u_ref,v_ref,tau_div vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3,std -C clim -t all vs_oaflux"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3,std,anom_std -C clim -t all vs_cmap_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3,std,anom_std -C clim -t all vs_gpcp_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a std,anom_std -C clim -t all -v tau_x,tau_y,t_surf vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a std,anom_std -C clim -t all -v tau_x,tau_y,wind vs_qscat"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3,std,anom_std -C clim -t all vs_ersst_v3"/>
          <!-- total correlations with local SST -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all -v tau_x,tau_y,tau_curl,wind_div,ps,t_diff,rh_ref,olr,tot_cld,hi_cld,mid_cld,lo_cld,wvp,cwp,u_ref,v_ref,tau_div vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all vs_oaflux"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all vs_cmap_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all vs_gpcp_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all -v tau_x,tau_y,wind vs_qscat"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all vs_ersst_v3"/>
          <!-- anomaly correlations with local SST -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all -v tau_x,tau_y,tau_curl,wind_div,ps,t_diff,rh_ref,olr,tot_cld,hi_cld,mid_cld,lo_cld,wvp,cwp,u_ref,v_ref,tau_div vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all vs_oaflux"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all vs_cmap_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all vs_gpcp_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all -v tau_x,tau_y,wind vs_qscat"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all vs_ersst_v3"/>
          <!-- wavelet plots of climate indices -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/index/frepp.atw_atmos_ts_monthly_index.csh -n -s -a tave_spectrum vs_obs"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/index/frepp.atw_atmos_ts_monthly_index.csh -n -s -a wavelet_density solo"/>
          <!-- global analysis -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -a clim -t all -v t_surf -y -90,90,20,1 -N globe -p globe vs_era40"/>
          <!-- Koppen climate types -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/koppen/frepp.atw_atmos_ts_monthly_koppen.csh -n -s vs_uea"/>
        </timeSeries>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_C)">
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/bw_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/bw_cru_precip.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/bw_atmos_tauu_atl_pac.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/pjk_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/tk_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/lwh_atmos_av_mon.csh"/> 
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjg/stub/cjg_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/radiation_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/sak_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/sak_lwp_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/sak_precip_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/yim_aer_cld.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/precip_water_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/liquid_cloud_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/ice_cloud_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/surface_atmos_av_mon.csh"/>
          <!--
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="/home/fms/local/opt/fre-analysis/test/eem/code/pcmdi_metrics/frepp.pcmdi_metrics.atmos.csh -c amip"/>
          -->
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$FRE_ANALYSIS_HOME/eem/code/pcmdi_metrics/frepp.pcmdi_metrics_v1p1p1.atmos.csh -c amip"/>
        </timeAverage>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)">
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_av_annual/column/frepp.atw_atmos_av_annual_column.csh -s solo"/>
        </timeAverage>
      </component>
      <component type="atmos_month_aer"  start="1851" source="atmos_month_aer" sourceGrid="atmos-cubedsphere" xyInterp="360,576">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="atmos_scalar" start="1851"  source="atmos_scalar">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"  source="atmos_scalar"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" source="atmos_scalar"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"  source="atmos_scalar"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" source="atmos_scalar"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ice_daily" start="1851"   source="ice_daily">
	<timeSeries freq="daily" source="ice_daily" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="daily" source="ice_daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ice"  start="1851" sourceGrid="ocean-tripolar">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"  source="ice_month"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"  source="ice_month"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)"  source="ice_month"/>
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_C)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"  source="ice_month"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"  source="ice_month"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)"  source="ice_month"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="iceberg"  start="1851" sourceGrid="ocean-tripolar">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"  source="iceberg_month">
	</timeSeries>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"  source="iceberg_month">
	</timeSeries>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)"  source="iceberg_month">
	</timeSeries>
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_C)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" > 
	</timeSeries>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" > 
	</timeSeries>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" > 
	</timeSeries>
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_C)"/>
      </component>
      <component type="land_daily"  start="1851"  source="land_daily" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="384,768">
	<timeSeries freq="daily" source="land_daily" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="daily" source="land_daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="land"  start="1851"  source="land_month" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="384,768">
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="land_inst_month"   start="1851" source="land_month_inst" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="384,768">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="river_daily"  start="1851"  source="river_daily" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="384,768">
	<timeSeries freq="daily" source="river_daily" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="daily" source="river_daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="river"  start="1851"  source="river_month" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="384,768">
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="river_inst_month"   start="1851" source="river_month_inst" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="384,768">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="river_cubic" start="1851" source="river_month" sourceGrid="land-cubedsphere" cmip="off">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" >
          <analysis switch="on" cumulative="yes" script="$FRE_ANALYSIS_HOME/kap/stub/kap_land_basin_map.csh"/>
        </timeSeries>
        <timeSeries freq="daily" source="river_daily" chunkLength="$(CHUNK_LENGTH_A)">
          <analysis switch="on" cumulative="yes" script="$FRE_ANALYSIS_HOME/kap/stub/kap_land_ts_bas_dly.csh"/>
        </timeSeries>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)" />
      </component>
      <component type="ocean_scalar" start="1851"  source="ocean_scalar_month"  sourceGrid="ocean-tripolar">  
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" />
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_C)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component> 
      <component type="ocean" start="1851"   sourceGrid="ocean-tripolar">  
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_month"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_month"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" source="ocean_month"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_C)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="ocean_z_month_refined" start="1851" source="ocean_z_month_refined" sourceGrid="ocean-tripolar" cmip="on">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_z_month_refined"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_z_month_refined"/>
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_A)"/>
      </component>
      <component type="ocean_z"   start="1851" sourceGrid="ocean-tripolar">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_z_month"> </timeSeries>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_z_month"> </timeSeries>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" source="ocean_z_month">
        <!--
        <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/ice_ocean_SIS/OM4_025/ocn_monthly.frepp"/>
        -->
        </timeSeries>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_C)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_z_month"> </timeSeries>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_z_month"> </timeSeries>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" source="ocean_z_month">
        <!--
        <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/ice_ocean_SIS/OM4_025/ocn_monthly.frepp"/>
        -->
        </timeSeries>  
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="ocean_z_ann"   start="1851" source="ocean_z_annual" sourceGrid="ocean-tripolar">
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_z_annual" ></timeSeries> 
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_z_annual" ></timeSeries> 
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" source="ocean_z_annual" ></timeSeries> 
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" >  
        <!--
        <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/ice_ocean_SIS/OM4_025/ocn_annual.frepp"/>
        -->
        </timeAverage>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="ocean_rho2" start="1851" source="ocean_month_rho2" sourceGrid="ocean-tripolar">  
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_month_rho2"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_month_rho2"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" source="ocean_month_rho2"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_C)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component> 
     </postProcess>
  </freInclude>

  <freInclude name="SPEAR_c192_PostP_Historical_ensemble">
      <postProcess> 
         <csh><![CDATA[
         cd $work/RESTART
         ncrcat icebergs.res.nc.* icebergs.res.nc
         if(-e icebergs.res.nc) rm -f icebergs.res.nc.*
         cd $work
         ncrcat iceberg_trajectories.nc.* iceberg_trajectories.nc
         rm -f iceberg_trajectories.nc.* 
         #Save the last line of timestats without the first (step number) column as a signature of MOM6 answers
         tail -1 timestats | cut -c8- > RESTART/$enddate.timestats.res
         #Save the whole timestats under ascii/
         mv timestats $enddate.timestats
         mv timestats.nc $enddate.timestats.nc

         #Make a directory to trick FRE to pick up and archive in ascii
         mkdir extra.results

         mv *velocity_truncations CPU_stats SIS_parameter_doc* MOM_parameter_doc* seaice.stats timestats ocean.stats *.ocean.stats* extra.results/
         ]]>
         </csh>
      <!--REFINE DIAG SCRIPT -->
      <!--By default a refineDiag script causes the annual data to be unpacked and saved in /ptmp/$USER-->
      <!--MOM6_refineDiag.csh is currently empty and is here only to cause the unpack annual history files in /ptmp-->
      <!--
      <refineDiag script="$(includeDir)/refineDiag/dummy_refineDiag.csh"/>
      -->
      <!--
      <refineDiag script="$(includeDir)/refineDiag/refineDiag_data_stager_globalAve.csh,$(includeDir)/refineDiag/VertVelocity.csh,$(includeDir)/refineDiag/SPEAR_refineDiag.csh"/>
      -->
      <refineDiag script="$(includeDir)/refineDiag/SPEAR_refineDiag.csh"/>
      <!--
      <refineDiag script="$(NB_ROOT)/mom6/tools/analysis/MOM6_refineDiag.csh,$(includeDir)/refineDiag/refineDiag_data_stager_globalAve.csh"/>
      -->
      <!-- Tony said to comment this out for now. -->
      <!--PostProcessing component models-->
      <component type="atmos_daily" zInterp="ncep"  start="1921"  source="atmos_daily" sourceGrid="atmos-cubedsphere" xyInterp="360,576" >
	<timeSeries freq="daily" source="atmos_daily" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="daily" source="atmos_daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="atmos_4xdaily" zInterp="ncep"   start="1921" source="atmos_4xdaily" sourceGrid="atmos-cubedsphere" xyInterp="360,576" >
        <timeSeries freq="6hr" source="atmos_4xdaily" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="6hr" source="atmos_4xdaily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="atmos_4xdaily_avg" zInterp="ncep"   start="1921" source="atmos_4xdaily_avg" sourceGrid="atmos-cubedsphere" xyInterp="360,576" >
        <timeSeries freq="6hr" source="atmos_4xdaily_avg" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="6hr" source="atmos_4xdaily_avg" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="atmos" zInterp="ncep" start="1921"  source="atmos_month" sourceGrid="atmos-cubedsphere" xyInterp="360,576" >
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)">
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="$FRE_ANALYSIS_HOME/cjg/stub/cjg_atmos_ts_mon.csh"/>
          <!-- Analysis scripts from Andrew Wittenberg
          annual and seasonal climatology -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja -v tau_x,tau_y,tau_curl,wind_div,ps,t_surf,t_diff,rh_ref,olr,tot_cld,hi_cld,mid_cld,lo_cld,wvp,cwp,u_ref,v_ref,tau_div vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_oaflux"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_cmap_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_gpcp_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_qscat"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_ersst_v3"/>
          <!-- clim and anomaly stddevs, regressions -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3 -t all -v tau_x,tau_y,tau_curl,wind_div,ps,t_surf,t_diff,rh_ref,olr,tot_cld,hi_cld,mid_cld,lo_cld,wvp,cwp,u_ref,v_ref,tau_div vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3,std -C clim -t all vs_oaflux"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3,std,anom_std -C clim -t all vs_cmap_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3,std,anom_std -C clim -t all vs_gpcp_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a std,anom_std -C clim -t all -v tau_x,tau_y,t_surf vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a std,anom_std -C clim -t all -v tau_x,tau_y,wind vs_qscat"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3,std,anom_std -C clim -t all vs_ersst_v3"/>
          <!-- total correlations with local SST -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all -v tau_x,tau_y,tau_curl,wind_div,ps,t_diff,rh_ref,olr,tot_cld,hi_cld,mid_cld,lo_cld,wvp,cwp,u_ref,v_ref,tau_div vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all vs_oaflux"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all vs_cmap_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all vs_gpcp_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all -v tau_x,tau_y,wind vs_qscat"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all vs_ersst_v3"/>
          <!-- anomaly correlations with local SST -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all -v tau_x,tau_y,tau_curl,wind_div,ps,t_diff,rh_ref,olr,tot_cld,hi_cld,mid_cld,lo_cld,wvp,cwp,u_ref,v_ref,tau_div vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all vs_oaflux"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all vs_cmap_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all vs_gpcp_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all -v tau_x,tau_y,wind vs_qscat"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all vs_ersst_v3"/>
          <!-- wavelet plots of climate indices -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/index/frepp.atw_atmos_ts_monthly_index.csh -n -s -a tave_spectrum vs_obs"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/index/frepp.atw_atmos_ts_monthly_index.csh -n -s -a wavelet_density solo"/>
          <!-- global analysis -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -a clim -t all -v t_surf -y -90,90,20,1 -N globe -p globe vs_era40"/>
          <!-- Koppen climate types -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/koppen/frepp.atw_atmos_ts_monthly_koppen.csh -n -s vs_uea"/>
        </timeSeries>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_C)">
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/bw_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/bw_cru_precip.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/bw_atmos_tauu_atl_pac.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/pjk_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/tk_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/lwh_atmos_av_mon.csh"/> 
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjg/stub/cjg_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/radiation_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/sak_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/sak_lwp_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/sak_precip_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/yim_aer_cld.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/precip_water_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/liquid_cloud_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/ice_cloud_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/surface_atmos_av_mon.csh"/>
          <!--
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="/home/fms/local/opt/fre-analysis/test/eem/code/pcmdi_metrics/frepp.pcmdi_metrics.atmos.csh -c amip"/>
          -->
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$FRE_ANALYSIS_HOME/eem/code/pcmdi_metrics/frepp.pcmdi_metrics_v1p1p1.atmos.csh -c amip"/>
        </timeAverage>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)">
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_av_annual/column/frepp.atw_atmos_av_annual_column.csh -s solo"/>
        </timeAverage>
      </component>
      <component type="atmos_month_aer"  start="1921" source="atmos_month_aer" sourceGrid="atmos-cubedsphere" xyInterp="360,576">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="atmos_scalar" start="1921"  source="atmos_scalar">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"  source="atmos_scalar"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" source="atmos_scalar"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"  source="atmos_scalar"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" source="atmos_scalar"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ice_daily" start="1921"   source="ice_daily">
	<timeSeries freq="daily" source="ice_daily" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="daily" source="ice_daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ice"  start="1921" sourceGrid="ocean-tripolar">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"  source="ice_month"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"  source="ice_month"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)"  source="ice_month"/>
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_C)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"  source="ice_month"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"  source="ice_month"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)"  source="ice_month"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="iceberg"  start="1921" sourceGrid="ocean-tripolar">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"  source="iceberg_month">
	</timeSeries>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"  source="iceberg_month">
	</timeSeries>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)"  source="iceberg_month">
	</timeSeries>
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_C)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" > 
	</timeSeries>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" > 
	</timeSeries>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" > 
	</timeSeries>
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_C)"/>
      </component>
      <component type="land_daily"  start="1921"  source="land_daily" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="384,768">
	<timeSeries freq="daily" source="land_daily" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="daily" source="land_daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="land"  start="1921"  source="land_month" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="384,768">
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="land_inst_month"   start="1921" source="land_month_inst" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="384,768">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="river_daily"  start="1921"  source="river_daily" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="384,768">
	<timeSeries freq="daily" source="river_daily" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="daily" source="river_daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="river"  start="1921"  source="river_month" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="384,768">
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="river_inst_month"   start="1921" source="river_month_inst" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="384,768">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="river_cubic" start="1921" source="river_month" sourceGrid="land-cubedsphere" cmip="off">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" >
          <analysis switch="on" cumulative="yes" script="$FRE_ANALYSIS_HOME/kap/stub/kap_land_basin_map.csh"/>
        </timeSeries>
        <timeSeries freq="daily" source="river_daily" chunkLength="$(CHUNK_LENGTH_A)">
          <analysis switch="on" cumulative="yes" script="$FRE_ANALYSIS_HOME/kap/stub/kap_land_ts_bas_dly.csh"/>
        </timeSeries>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)" />
      </component>
      <component type="ocean_scalar" start="1921"  source="ocean_scalar_month"  sourceGrid="ocean-tripolar">  
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" />
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_C)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component> 
      <component type="ocean" start="1921"   sourceGrid="ocean-tripolar">  
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_month"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_month"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" source="ocean_month"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_C)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="ocean_annual" start="1921"  source="ocean_annual" sourceGrid="ocean-tripolar">
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_annual"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_annual"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" source="ocean_annual"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="ocean_z_month_refined" start="1921" source="ocean_z_month_refined" sourceGrid="ocean-tripolar" cmip="on">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_z_month_refined"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_z_month_refined"/>
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_A)"/>
      </component>
      <component type="ocean_z"   start="1921" sourceGrid="ocean-tripolar">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_z_month"> </timeSeries>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_z_month"> </timeSeries>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" source="ocean_z_month">
        <!--
        <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/ice_ocean_SIS/OM4_025/ocn_monthly.frepp"/>
        -->
        </timeSeries>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_C)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_z_month"> </timeSeries>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_z_month"> </timeSeries>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" source="ocean_z_month">
        <!--
        <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/ice_ocean_SIS/OM4_025/ocn_monthly.frepp"/>
        -->
        </timeSeries>  
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="ocean_z_ann"   start="1921" source="ocean_z_annual" sourceGrid="ocean-tripolar">
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_z_annual" ></timeSeries> 
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_z_annual" ></timeSeries> 
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" source="ocean_z_annual" ></timeSeries> 
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" >  
        <!--
        <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/ice_ocean_SIS/OM4_025/ocn_annual.frepp"/>
        -->
        </timeAverage>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="ocean_rho2" start="1921" source="ocean_month_rho2" sourceGrid="ocean-tripolar">  
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_month_rho2"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_month_rho2"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" source="ocean_month_rho2"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_C)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component> 
     </postProcess>
  </freInclude>

  <freInclude name="SPEAR_c96_PostP_Historical_ensemble">
      <postProcess> 
         <csh><![CDATA[
         cd $work/RESTART
         ncrcat icebergs.res.nc.* icebergs.res.nc
         if(-e icebergs.res.nc) rm -f icebergs.res.nc.*
         cd $work
         ncrcat iceberg_trajectories.nc.* iceberg_trajectories.nc
         rm -f iceberg_trajectories.nc.* 
         #Save the last line of timestats without the first (step number) column as a signature of MOM6 answers
         tail -1 timestats | cut -c8- > RESTART/$enddate.timestats.res
         #Save the whole timestats under ascii/
         mv timestats $enddate.timestats
         mv timestats.nc $enddate.timestats.nc

         #Make a directory to trick FRE to pick up and archive in ascii
         mkdir extra.results

         mv *velocity_truncations CPU_stats SIS_parameter_doc* MOM_parameter_doc* seaice.stats timestats ocean.stats *.ocean.stats* extra.results/
         ]]>
         </csh>
      <!--REFINE DIAG SCRIPT -->
      <!--By default a refineDiag script causes the annual data to be unpacked and saved in /ptmp/$USER-->
      <refineDiag script="$(includeDir)/refineDiag/dummy_refineDiag.csh,$(includeDir)/refineDiag/SPEAR_refineDiag.csh"/>
      <!--PostProcessing component models-->
      <component type="atmos_daily" zInterp="ncep"  start="$(PP_START_YEAR_HIST)"  source="atmos_daily" sourceGrid="atmos-cubedsphere" xyInterp="180,288" >
	<timeSeries freq="daily" source="atmos_daily" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="daily" source="atmos_daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="atmos_4xdaily" zInterp="ncep"   start="$(PP_START_YEAR_HIST)" source="atmos_4xdaily" sourceGrid="atmos-cubedsphere" xyInterp="180,288" >
        <timeSeries freq="6hr" source="atmos_4xdaily" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="6hr" source="atmos_4xdaily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="atmos_4xdaily_avg" zInterp="ncep"   start="$(PP_START_YEAR_HIST)" source="atmos_4xdaily_avg" sourceGrid="atmos-cubedsphere" xyInterp="180,288" >
        <timeSeries freq="6hr" source="atmos_4xdaily_avg" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="6hr" source="atmos_4xdaily_avg" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="atmos" zInterp="ncep" start="$(PP_START_YEAR_HIST)"  source="atmos_month" sourceGrid="atmos-cubedsphere" xyInterp="180,288" >
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)">
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="$FRE_ANALYSIS_HOME/cjg/stub/cjg_atmos_ts_mon.csh"/>
          <!-- Analysis scripts from Andrew Wittenberg
          annual and seasonal climatology -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja -v tau_x,tau_y,tau_curl,wind_div,ps,t_surf,t_diff,rh_ref,olr,tot_cld,hi_cld,mid_cld,lo_cld,wvp,cwp,u_ref,v_ref,tau_div vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_oaflux"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_cmap_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_gpcp_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_qscat"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_ersst_v3"/>
          <!-- clim and anomaly stddevs, regressions -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3 -t all -v tau_x,tau_y,tau_curl,wind_div,ps,t_surf,t_diff,rh_ref,olr,tot_cld,hi_cld,mid_cld,lo_cld,wvp,cwp,u_ref,v_ref,tau_div vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3,std -C clim -t all vs_oaflux"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3,std,anom_std -C clim -t all vs_cmap_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3,std,anom_std -C clim -t all vs_gpcp_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a std,anom_std -C clim -t all -v tau_x,tau_y,t_surf vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a std,anom_std -C clim -t all -v tau_x,tau_y,wind vs_qscat"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3,std,anom_std -C clim -t all vs_ersst_v3"/>
          <!-- total correlations with local SST -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all -v tau_x,tau_y,tau_curl,wind_div,ps,t_diff,rh_ref,olr,tot_cld,hi_cld,mid_cld,lo_cld,wvp,cwp,u_ref,v_ref,tau_div vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all vs_oaflux"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all vs_cmap_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all vs_gpcp_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all -v tau_x,tau_y,wind vs_qscat"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all vs_ersst_v3"/>
          <!-- anomaly correlations with local SST -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all -v tau_x,tau_y,tau_curl,wind_div,ps,t_diff,rh_ref,olr,tot_cld,hi_cld,mid_cld,lo_cld,wvp,cwp,u_ref,v_ref,tau_div vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all vs_oaflux"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all vs_cmap_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all vs_gpcp_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all -v tau_x,tau_y,wind vs_qscat"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all vs_ersst_v3"/>
          <!-- wavelet plots of climate indices -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/index/frepp.atw_atmos_ts_monthly_index.csh -n -s -a tave_spectrum vs_obs"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/index/frepp.atw_atmos_ts_monthly_index.csh -n -s -a wavelet_density solo"/>
          <!-- global analysis -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -a clim -t all -v t_surf -y -90,90,20,1 -N globe -p globe vs_era40"/>
          <!-- Koppen climate types -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/koppen/frepp.atw_atmos_ts_monthly_koppen.csh -n -s vs_uea"/>
        </timeSeries>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_C)">
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/bw_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/bw_cru_precip.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/bw_atmos_tauu_atl_pac.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/pjk_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/tk_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/lwh_atmos_av_mon.csh"/> 
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjg/stub/cjg_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/radiation_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/sak_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/sak_lwp_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/sak_precip_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/yim_aer_cld.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/precip_water_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/liquid_cloud_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/ice_cloud_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/surface_atmos_av_mon.csh"/>
          <!--
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="/home/fms/local/opt/fre-analysis/test/eem/code/pcmdi_metrics/frepp.pcmdi_metrics.atmos.csh -c amip"/>
          -->
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$FRE_ANALYSIS_HOME/eem/code/pcmdi_metrics/frepp.pcmdi_metrics_v1p1p1.atmos.csh -c amip"/>
        </timeAverage>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)">
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_av_annual/column/frepp.atw_atmos_av_annual_column.csh -s solo"/>
        </timeAverage>
      </component>
      <component type="atmos_month_aer"  start="$(PP_START_YEAR_HIST)" source="atmos_month_aer" sourceGrid="atmos-cubedsphere" xyInterp="180,288">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)">
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/pag/stub/aerosol_monthly.csh"/>
        </timeAverage>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="atmos_scalar" start="$(PP_START_YEAR_HIST)"  source="atmos_scalar">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"  source="atmos_scalar"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" source="atmos_scalar"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"  source="atmos_scalar"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" source="atmos_scalar"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ice_daily" start="$(PP_START_YEAR_HIST)"   source="ice_daily">
	<timeSeries freq="daily" source="ice_daily" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="daily" source="ice_daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ice"  start="$(PP_START_YEAR_HIST)" sourceGrid="ocean-tripolar">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"  source="ice_month"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"  source="ice_month"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)"  source="ice_month"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_C)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"  source="ice_month"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"  source="ice_month"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)"  source="ice_month"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="iceberg"  start="$(PP_START_YEAR_HIST)" sourceGrid="ocean-tripolar">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"  source="iceberg_month">
	</timeSeries>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"  source="iceberg_month">
	</timeSeries>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)"  source="iceberg_month">
	</timeSeries>
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_C)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" > 
	</timeSeries>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" > 
	</timeSeries>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" > 
	</timeSeries>
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_C)"/>
      </component>
      <component type="land_daily"  start="$(PP_START_YEAR_HIST)"  source="land_daily" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="192,384">
	<timeSeries freq="daily" source="land_daily" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="daily" source="land_daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="land"  start="$(PP_START_YEAR_HIST)"  source="land_month" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="192,384">
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)">
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="yes" script="$FRE_ANALYSIS_HOME/kap/stub/kap_land_ts_reg_rad.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="yes" script="$FRE_ANALYSIS_HOME/kap/stub/kap_land_ts_reg_web.csh"/>
        </timeSeries>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)" >
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/kap/stub/kap_land_av.csh"/>
        </timeAverage>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="land_inst_month"   start="$(PP_START_YEAR_HIST)" source="land_month_inst" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="192,384">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="river_daily"  start="$(PP_START_YEAR_HIST)"  source="river_daily" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="192,384">
	<timeSeries freq="daily" source="river_daily" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="daily" source="river_daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="river"  start="$(PP_START_YEAR_HIST)"  source="river_month" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="192,384">
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="river_inst_month"   start="$(PP_START_YEAR_HIST)" source="river_month_inst" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="192,384">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="river_cubic" start="$(PP_START_YEAR)" source="river_month" sourceGrid="land-cubedsphere" cmip="off">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" >
          <analysis switch="on" cumulative="yes" script="$FRE_ANALYSIS_HOME/kap/stub/kap_land_basin_map.csh"/>
        </timeSeries>
        <timeSeries freq="daily" source="river_daily" chunkLength="$(CHUNK_LENGTH_A)">
          <analysis switch="on" cumulative="yes" script="$FRE_ANALYSIS_HOME/kap/stub/kap_land_ts_bas_dly.csh"/>
        </timeSeries>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)" />
      </component>
      <component type="ocean_scalar" start="$(PP_START_YEAR_HIST)"  source="ocean_scalar_month"  sourceGrid="ocean-tripolar">  
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" />
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_C)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component> 
      <component type="ocean" start="$(PP_START_YEAR_HIST)"   sourceGrid="ocean-tripolar">  
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_month"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_month"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" source="ocean_month"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_C)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component> 
      <component type="ocean_z"   start="$(PP_START_YEAR_HIST)" sourceGrid="ocean-tripolar">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_z_month"> </timeSeries>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_z_month"> </timeSeries>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" source="ocean_z_month">
        <!--
        <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/ice_ocean_SIS/OM4_025/ocn_monthly.frepp"/>
        -->
        </timeSeries>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_C)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_z_month"> </timeSeries>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_z_month"> </timeSeries>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" source="ocean_z_month">
        <!--
        <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/ice_ocean_SIS/OM4_025/ocn_monthly.frepp"/>
        -->
        </timeSeries>  
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="ocean_z_ann"   start="$(PP_START_YEAR_HIST)" source="ocean_z_annual" sourceGrid="ocean-tripolar">
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_z_annual" ></timeSeries> 
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_z_annual" ></timeSeries> 
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" source="ocean_z_annual" ></timeSeries> 
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" >  
        <!--
        <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/ice_ocean_SIS/OM4_025/ocn_annual.frepp"/>
        -->
        </timeAverage>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="ocean_rho2" start="$(PP_START_YEAR_HIST)" source="ocean_month_rho2" sourceGrid="ocean-tripolar">  
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_month_rho2"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_month_rho2"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" source="ocean_month_rho2"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_C)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component> 
     </postProcess>
  </freInclude>

  <freInclude name="SPEAR_c96_PostP_AMIP">
      <postProcess> 
         <csh><![CDATA[
         cd $work/RESTART
         ncrcat icebergs.res.nc.* icebergs.res.nc
         if(-e icebergs.res.nc) rm -f icebergs.res.nc.*
         cd $work
         ncrcat iceberg_trajectories.nc.* iceberg_trajectories.nc
         rm -f iceberg_trajectories.nc.* 
         #Save the last line of timestats without the first (step number) column as a signature of MOM6 answers
         tail -1 timestats | cut -c8- > RESTART/$enddate.timestats.res
         #Save the whole timestats under ascii/
         mv timestats $enddate.timestats
         mv timestats.nc $enddate.timestats.nc

         #Make a directory to trick FRE to pick up and archive in ascii
         mkdir extra.results

         mv *velocity_truncations CPU_stats SIS_parameter_doc* MOM_parameter_doc* seaice.stats timestats ocean.stats *.ocean.stats* extra.results/
         ]]>
         </csh>
      <!--REFINE DIAG SCRIPT -->
      <!--By default a refineDiag script causes the annual data to be unpacked and saved in /ptmp/$USER-->
      <!--MOM6_refineDiag.csh is currently empty and is here only to cause the unpack annual history files in /ptmp-->
      <!--
      <refineDiag script="$(NB_ROOT)/mom6/tools/analysis/MOM6_refineDiag.csh,$(includeDir)/refineDiag/refineDiag_data_stager_globalAve.csh"/>
      -->
      <!-- Tony said to comment this out for now. -->
      <!--PostProcessing component models-->
      <component type="atmos_daily" zInterp="ncep"  start="$(PP_AMIP_START_YEAR)"  source="atmos_daily" sourceGrid="atmos-cubedsphere" xyInterp="180,288" >
	<timeSeries freq="daily" source="atmos_daily" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="daily" source="atmos_daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="atmos_4xdaily" zInterp="ncep"   start="$(PP_AMIP_START_YEAR)" source="atmos_4xdaily" sourceGrid="atmos-cubedsphere" xyInterp="180,288" >
        <timeSeries freq="6hr" source="atmos_4xdaily" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="6hr" source="atmos_4xdaily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="atmos_4xdaily_avg" zInterp="ncep"   start="$(PP_AMIP_START_YEAR)" source="atmos_4xdaily_avg" sourceGrid="atmos-cubedsphere" xyInterp="180,288" >
        <timeSeries freq="6hr" source="atmos_4xdaily_avg" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="6hr" source="atmos_4xdaily_avg" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="atmos" zInterp="ncep" start="$(PP_AMIP_START_YEAR)"  source="atmos_month" sourceGrid="atmos-cubedsphere" xyInterp="180,288" >
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)">
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="$FRE_ANALYSIS_HOME/cjg/stub/cjg_atmos_ts_mon.csh"/>
          <!-- Analysis scripts from Andrew Wittenberg
          annual and seasonal climatology -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja -v tau_x,tau_y,tau_curl,wind_div,ps,t_surf,t_diff,rh_ref,olr,tot_cld,hi_cld,mid_cld,lo_cld,wvp,cwp,u_ref,v_ref,tau_div vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_oaflux"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_cmap_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_gpcp_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_qscat"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_ersst_v3"/>
          <!-- clim and anomaly stddevs, regressions -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3 -t all -v tau_x,tau_y,tau_curl,wind_div,ps,t_surf,t_diff,rh_ref,olr,tot_cld,hi_cld,mid_cld,lo_cld,wvp,cwp,u_ref,v_ref,tau_div vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3,std -C clim -t all vs_oaflux"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3,std,anom_std -C clim -t all vs_cmap_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3,std,anom_std -C clim -t all vs_gpcp_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a std,anom_std -C clim -t all -v tau_x,tau_y,t_surf vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a std,anom_std -C clim -t all -v tau_x,tau_y,wind vs_qscat"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3,std,anom_std -C clim -t all vs_ersst_v3"/>
          <!-- total correlations with local SST -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all -v tau_x,tau_y,tau_curl,wind_div,ps,t_diff,rh_ref,olr,tot_cld,hi_cld,mid_cld,lo_cld,wvp,cwp,u_ref,v_ref,tau_div vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all vs_oaflux"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all vs_cmap_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all vs_gpcp_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all -v tau_x,tau_y,wind vs_qscat"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all vs_ersst_v3"/>
          <!-- anomaly correlations with local SST -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all -v tau_x,tau_y,tau_curl,wind_div,ps,t_diff,rh_ref,olr,tot_cld,hi_cld,mid_cld,lo_cld,wvp,cwp,u_ref,v_ref,tau_div vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all vs_oaflux"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all vs_cmap_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all vs_gpcp_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all -v tau_x,tau_y,wind vs_qscat"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all vs_ersst_v3"/>
          <!-- wavelet plots of climate indices -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/index/frepp.atw_atmos_ts_monthly_index.csh -n -s -a tave_spectrum vs_obs"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/index/frepp.atw_atmos_ts_monthly_index.csh -n -s -a wavelet_density solo"/>
          <!-- global analysis -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -a clim -t all -v t_surf -y -90,90,20,1 -N globe -p globe vs_era40"/>
          <!-- Koppen climate types -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/koppen/frepp.atw_atmos_ts_monthly_koppen.csh -n -s vs_uea"/>
        </timeSeries>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_C)">
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/bw_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/bw_cru_precip.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/bw_atmos_tauu_atl_pac.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/pjk_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/tk_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/lwh_atmos_av_mon.csh"/> 
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjg/stub/cjg_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/radiation_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/sak_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/sak_lwp_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/sak_precip_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/yim_aer_cld.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/precip_water_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/liquid_cloud_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/ice_cloud_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/surface_atmos_av_mon.csh"/>
          <!--
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="/home/fms/local/opt/fre-analysis/test/eem/code/pcmdi_metrics/frepp.pcmdi_metrics.atmos.csh -c amip"/>
          -->
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$FRE_ANALYSIS_HOME/eem/code/pcmdi_metrics/frepp.pcmdi_metrics_v1p1p1.atmos.csh -c amip"/>
        </timeAverage>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)">
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_av_annual/column/frepp.atw_atmos_av_annual_column.csh -s solo"/>
        </timeAverage>
      </component>
      <component type="atmos_month_aer"  start="$(PP_AMIP_START_YEAR)" source="atmos_month_aer" sourceGrid="atmos-cubedsphere" xyInterp="180,288">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="atmos_scalar" start="$(PP_AMIP_START_YEAR)"  source="atmos_scalar">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"  source="atmos_scalar"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" source="atmos_scalar"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"  source="atmos_scalar"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" source="atmos_scalar"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ice"  start="$(PP_AMIP_START_YEAR)" sourceGrid="ocean-tripolar">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"  source="ice_month"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"  source="ice_month"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)"  source="ice_month"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"  source="ice_month"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"  source="ice_month"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)"  source="ice_month"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="land"  start="$(PP_AMIP_START_YEAR)"  source="land_month" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="192,384">
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="land_inst_month"   start="$(PP_AMIP_START_YEAR)" source="land_month_inst" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="192,384">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="river"  start="$(PP_AMIP_START_YEAR)"  source="river_month" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="192,384">
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="river_inst_month"   start="$(PP_AMIP_START_YEAR)" source="river_month_inst" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="192,384">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
      </component>
     </postProcess>
  </freInclude>

  <freInclude name="SPEAR_c96_PostP_AMIP_nodaily">

      <postProcess> 
         <csh><![CDATA[
         cd $work/RESTART
         ncrcat icebergs.res.nc.* icebergs.res.nc
         if(-e icebergs.res.nc) rm -f icebergs.res.nc.*
         cd $work
         ncrcat iceberg_trajectories.nc.* iceberg_trajectories.nc
         rm -f iceberg_trajectories.nc.* 
         #Save the last line of timestats without the first (step number) column as a signature of MOM6 answers
         tail -1 timestats | cut -c8- > RESTART/$enddate.timestats.res
         #Save the whole timestats under ascii/
         mv timestats $enddate.timestats
         mv timestats.nc $enddate.timestats.nc

         #Make a directory to trick FRE to pick up and archive in ascii
         mkdir extra.results

         mv *velocity_truncations CPU_stats SIS_parameter_doc* MOM_parameter_doc* seaice.stats timestats ocean.stats *.ocean.stats* extra.results/
         ]]>
         </csh>
      <!--REFINE DIAG SCRIPT -->
      <!--By default a refineDiag script causes the annual data to be unpacked and saved in /ptmp/$USER-->
      <refineDiag script="$(includeDir)/refineDiag/dummy_refineDiag.csh,$(includeDir)/refineDiag/refineDiag_data_stager_globalAve.csh"/>
      <!--MOM6_refineDiag.csh is currently empty and is here only to cause the unpack annual history files in /ptmp-->
      <!--
      <refineDiag script="$(NB_ROOT)/mom6/tools/analysis/MOM6_refineDiag.csh,$(includeDir)/refineDiag/refineDiag_data_stager_globalAve.csh"/>
      -->
      <!-- Tony said to comment this out for now. -->
      <!--PostProcessing component models-->
      <component type="atmos" zInterp="ncep" start="$(PP_AMIP_START_YEAR)"  source="atmos_month" sourceGrid="atmos-cubedsphere" xyInterp="180,288" >
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)">
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="$FRE_ANALYSIS_HOME/cjg/stub/cjg_atmos_ts_mon.csh"/>
          <!-- Analysis scripts from Andrew Wittenberg
          annual and seasonal climatology -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja -v tau_x,tau_y,tau_curl,wind_div,ps,t_surf,t_diff,rh_ref,olr,tot_cld,hi_cld,mid_cld,lo_cld,wvp,cwp,u_ref,v_ref,tau_div vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_oaflux"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_cmap_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_gpcp_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_qscat"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_ersst_v3"/>
          <!-- clim and anomaly stddevs, regressions -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3 -t all -v tau_x,tau_y,tau_curl,wind_div,ps,t_surf,t_diff,rh_ref,olr,tot_cld,hi_cld,mid_cld,lo_cld,wvp,cwp,u_ref,v_ref,tau_div vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3,std -C clim -t all vs_oaflux"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3,std,anom_std -C clim -t all vs_cmap_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3,std,anom_std -C clim -t all vs_gpcp_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a std,anom_std -C clim -t all -v tau_x,tau_y,t_surf vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a std,anom_std -C clim -t all -v tau_x,tau_y,wind vs_qscat"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3,std,anom_std -C clim -t all vs_ersst_v3"/>
          <!-- total correlations with local SST -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all -v tau_x,tau_y,tau_curl,wind_div,ps,t_diff,rh_ref,olr,tot_cld,hi_cld,mid_cld,lo_cld,wvp,cwp,u_ref,v_ref,tau_div vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all vs_oaflux"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all vs_cmap_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all vs_gpcp_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all -v tau_x,tau_y,wind vs_qscat"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all vs_ersst_v3"/>
          <!-- anomaly correlations with local SST -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all -v tau_x,tau_y,tau_curl,wind_div,ps,t_diff,rh_ref,olr,tot_cld,hi_cld,mid_cld,lo_cld,wvp,cwp,u_ref,v_ref,tau_div vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all vs_oaflux"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all vs_cmap_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all vs_gpcp_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all -v tau_x,tau_y,wind vs_qscat"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all vs_ersst_v3"/>
          <!-- wavelet plots of climate indices -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/index/frepp.atw_atmos_ts_monthly_index.csh -n -s -a tave_spectrum vs_obs"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/index/frepp.atw_atmos_ts_monthly_index.csh -n -s -a wavelet_density solo"/>
          <!-- global analysis -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -a clim -t all -v t_surf -y -90,90,20,1 -N globe -p globe vs_era40"/>
          <!-- Koppen climate types -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/koppen/frepp.atw_atmos_ts_monthly_koppen.csh -n -s vs_uea"/>
        </timeSeries>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_C)">
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/bw_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/bw_cru_precip.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/bw_atmos_tauu_atl_pac.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/pjk_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/tk_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/lwh_atmos_av_mon.csh"/> 
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjg/stub/cjg_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/radiation_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/sak_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/sak_lwp_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/sak_precip_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/yim_aer_cld.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/precip_water_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/liquid_cloud_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/ice_cloud_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/surface_atmos_av_mon.csh"/>
          <!--
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="/home/fms/local/opt/fre-analysis/test/eem/code/pcmdi_metrics/frepp.pcmdi_metrics.atmos.csh -c amip"/>
          -->
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$FRE_ANALYSIS_HOME/eem/code/pcmdi_metrics/frepp.pcmdi_metrics_v1p1p1.atmos.csh -c amip"/>
        </timeAverage>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)">
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_av_annual/column/frepp.atw_atmos_av_annual_column.csh -s solo"/>
        </timeAverage>
      </component>
      <component type="atmos_month_aer"  start="$(PP_AMIP_START_YEAR)" source="atmos_month_aer" sourceGrid="atmos-cubedsphere" xyInterp="180,288">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="atmos_scalar" start="$(PP_AMIP_START_YEAR)"  source="atmos_scalar">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"  source="atmos_scalar"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" source="atmos_scalar"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"  source="atmos_scalar"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" source="atmos_scalar"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ice"  start="$(PP_AMIP_START_YEAR)" sourceGrid="ocean-tripolar">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"  source="ice_month"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"  source="ice_month"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)"  source="ice_month"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"  source="ice_month"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"  source="ice_month"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)"  source="ice_month"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="land"  start="$(PP_AMIP_START_YEAR)"  source="land_month" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="192,384">
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="land_inst_month"   start="$(PP_AMIP_START_YEAR)" source="land_month_inst" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="192,384">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="river"  start="$(PP_AMIP_START_YEAR)"  source="river_month" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="192,384">
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="river_inst_month"   start="$(PP_AMIP_START_YEAR)" source="river_month_inst" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="192,384">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="river_cubic" start="$(PP_AMIP_START_YEAR)" source="river_month" sourceGrid="land-cubedsphere" cmip="off">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" >
          <analysis switch="on" cumulative="yes" script="$FRE_ANALYSIS_HOME/kap/stub/kap_land_basin_map.csh"/>
        </timeSeries>
        <timeSeries freq="daily" source="river_daily" chunkLength="$(CHUNK_LENGTH_A)">
          <analysis switch="on" cumulative="yes" script="$FRE_ANALYSIS_HOME/kap/stub/kap_land_ts_bas_dly.csh"/>
        </timeSeries>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)" />
      </component>
     </postProcess>
  </freInclude>

  <freInclude name="SPEAR_c96_PostP_seasonal">
<!-- Postprocessing setup for seasonal prediction so set for 1 year increments.
     I have left 5 and 10 year processing here to allow for expansion. -->
      <postProcess> 
         <csh><![CDATA[
         cd $work/RESTART
         ncrcat icebergs.res.nc.* icebergs.res.nc
         if(-e icebergs.res.nc) rm -f icebergs.res.nc.*
         cd $work
         ncrcat iceberg_trajectories.nc.* iceberg_trajectories.nc
         rm -f iceberg_trajectories.nc.* 
         #Save the last line of timestats without the first (step number) column as a signature of MOM6 answers
         tail -1 timestats | cut -c8- > RESTART/$enddate.timestats.res
         #Save the whole timestats under ascii/
         mv timestats $enddate.timestats
         mv timestats.nc $enddate.timestats.nc

         #Make a directory to trick FRE to pick up and archive in ascii
         mkdir extra.results

         mv *velocity_truncations CPU_stats SIS_parameter_doc* MOM_parameter_doc* extra.results/
         ]]>
         </csh>
      <!--REFINE DIAG SCRIPT -->
      <!--By default a refineDiag script causes the annual data to be unpacked and saved in /ptmp/$USER-->
      <!--MOM6_refineDiag.csh is currently empty and is here only to cause the unpack annual history files in /ptmp-->
      <!--
      <refineDiag script="$(NB_ROOT)/mom6/tools/analysis/MOM6_refineDiag.csh,$(SPEAR_INPUT_HOME_GFDL)/refineDiag/refineDiag_data_stager_globalAve.csh"/>
      -->
      <refineDiag script="$(includeDir)/refineDiag/SPEAR_refineDiag.csh"/>
      <!-- Tony said to comment this out for now. -->
      <!--PostProcessing component models-->
      <component type="atmos_scalar" start="$(PP_START_YEAR)"  source="atmos_scalar">
        <timeSeries freq="monthly" chunkLength="1yr" source="atmos_scalar"/>
      </component>
      <component type="atmos_month_aer"  start="$(PP_START_YEAR)" source="atmos_month_aer" sourceGrid="atmos-cubedsphere" xyInterp="180,288">
        <timeSeries freq="monthly" chunkLength="1yr"/>
      </component>
      <component type="atmos" zInterp="ncep" start="$(PP_START_YEAR)"  source="atmos_month" sourceGrid="atmos-cubedsphere" xyInterp="180,288" >
	<timeSeries freq="monthly" chunkLength="1yr"/>
      </component>
      <component type="ocean_scalar" start="$(PP_START_YEAR)"  source="ocean_scalar_month"  sourceGrid="ocean-tripolar">  
        <timeSeries freq="monthly" chunkLength="1yr" />
      </component> 
      <component type="ocean" start="$(PP_START_YEAR)" source="ocean_month"   sourceGrid="ocean-tripolar">  
        <timeSeries freq="monthly" chunkLength="1yr" />
      </component> 
      <component type="ocean_z"   start="$(PP_START_YEAR)" source="ocean_z_month" sourceGrid="ocean-tripolar">
        <timeSeries freq="monthly" chunkLength="1yr" source="ocean_z_month"> </timeSeries>
      </component>
      <component type="ocean_z_ann"   start="$(PP_START_YEAR)" source="ocean_z_annual" sourceGrid="ocean-tripolar">
        <timeSeries freq="annual" chunkLength="1yr" source="ocean_z_annual" ></timeSeries> 
      </component>
      <component type="land_inst_month"   start="$(PP_START_YEAR)" source="land_month_inst" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="192,384">
        <timeSeries freq="monthly" chunkLength="1yr"/>
      </component>
      <component type="land_static"   start="$(PP_START_YEAR)" source="land_static" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="192,384">
        <timeSeries freq="monthly" chunkLength="1yr"/>
      </component>
      <component type="land"  start="$(PP_START_YEAR)"  source="land_month" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="192,384">
	<timeSeries freq="monthly" chunkLength="1yr"/>
      </component>
      <component type="ice"  start="$(PP_START_YEAR)" source="ice_month" sourceGrid="ocean-tripolar">
        <timeSeries freq="monthly" chunkLength="1yr"/>
      </component>
      <component type="iceberg"  start="$(PP_START_YEAR)" source="iceberg_month" sourceGrid="ocean-tripolar">
        <timeSeries freq="monthly" chunkLength="1yr"  source="iceberg_month"/>
      </component>
      <component type="river_daily"   start="$(PP_START_YEAR)" source="river_daily" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="192,384">
        <timeSeries freq="daily" chunkLength="1yr"/>
      </component>
      <component type="river_inst_month"   start="$(PP_START_YEAR)" source="river_month_inst" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="192,384">
        <timeSeries freq="monthly" chunkLength="1yr"/>
      </component>
      <component type="river_static"   start="$(PP_START_YEAR)" source="river_static" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="192,384">
        <timeSeries freq="monthly" chunkLength="1yr"/>
      </component>  
      <component type="river"  start="$(PP_START_YEAR)"  source="river_month" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="192,384">
	<timeSeries freq="monthly" chunkLength="1yr"/>
      </component>
     </postProcess>
  </freInclude>

  <freInclude name="SPEAR_c96_PostP_seasonal_ensemble">
<!-- Postprocessing setup for seasonal prediction so set for 1 year increments.
     I have left 5 and 10 year processing here to allow for expansion. -->
      <postProcess> 
         <csh><![CDATA[
         cd $work/RESTART
         ncrcat icebergs.res.nc.* icebergs.res.nc
         if(-e icebergs.res.nc) rm -f icebergs.res.nc.*
         cd $work
         ncrcat iceberg_trajectories.nc.* iceberg_trajectories.nc
         rm -f iceberg_trajectories.nc.* 
         #Save the last line of timestats without the first (step number) column as a signature of MOM6 answers
         tail -1 timestats | cut -c8- > RESTART/$enddate.timestats.res
         #Save the whole timestats under ascii/
         mv timestats $enddate.timestats
         mv timestats.nc $enddate.timestats.nc

         #Make a directory to trick FRE to pick up and archive in ascii
         mkdir extra.results

         mv *velocity_truncations CPU_stats SIS_parameter_doc* MOM_parameter_doc* extra.results/
         ]]>
         </csh>

      <!--REFINE DIAG SCRIPT -->
      <!--By default a refineDiag script causes the annual data to be unpacked and saved in /ptmp/$USER-->
      <!--MOM6_refineDiag.csh is currently empty and is here only to cause the unpack annual history files in /ptmp-->
      <!--
      <refineDiag script="$(NB_ROOT)/mom6/tools/analysis/MOM6_refineDiag.csh,$(SPEAR_INPUT_HOME_GFDL)/refineDiag/refineDiag_data_stager_globalAve.csh"/>
      -->
      <refineDiag script="$(includeDir)/refineDiag/SPEAR_refineDiag.csh"/>
      <!-- Tony said to comment this out for now. -->
      <!--PostProcessing component models-->
      <component type="atmos_scalar" start="$(PP_START_YEAR)"  source="atmos_scalar">
        <timeSeries freq="monthly" chunkLength="1yr" source="atmos_scalar"/>
      </component>
      <component type="atmos_month_aer"  start="$(PP_START_YEAR)" source="atmos_month_aer" sourceGrid="atmos-cubedsphere" xyInterp="180,288">
        <timeSeries freq="monthly" chunkLength="1yr"/>
      </component>
      <component type="atmos" zInterp="ncep" start="$(PP_START_YEAR)"  source="atmos_month" sourceGrid="atmos-cubedsphere" xyInterp="180,288" >
	<timeSeries freq="monthly" chunkLength="1yr"/>
      </component>
      <component type="ocean_scalar" start="$(PP_START_YEAR)"  source="ocean_scalar_month"  sourceGrid="ocean-tripolar">  
        <timeSeries freq="monthly" chunkLength="1yr" />
      </component> 
      <component type="ocean" start="$(PP_START_YEAR)" source="ocean_month"   sourceGrid="ocean-tripolar">  
        <timeSeries freq="monthly" chunkLength="1yr" />
      </component> 
      <component type="ocean_z"   start="$(PP_START_YEAR)" source="ocean_z_month" sourceGrid="ocean-tripolar">
        <timeSeries freq="monthly" chunkLength="1yr" source="ocean_z_month"> </timeSeries>
      </component>
      <component type="ocean_z_ann"   start="$(PP_START_YEAR)" source="ocean_z_annual" sourceGrid="ocean-tripolar">
        <timeSeries freq="annual" chunkLength="1yr" source="ocean_z_annual" ></timeSeries> 
      </component>
      <component type="land_inst_month"   start="$(PP_START_YEAR)" source="land_month_inst" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="192,384">
        <timeSeries freq="monthly" chunkLength="1yr"/>
      </component>
      <component type="land_static"   start="$(PP_START_YEAR)" source="land_static" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="192,384">
        <timeSeries freq="monthly" chunkLength="1yr"/>
      </component>
      <component type="land"  start="$(PP_START_YEAR)"  source="land_month" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="192,384">
	<timeSeries freq="monthly" chunkLength="1yr"/>
      </component>
      <component type="ice"  start="$(PP_START_YEAR)" source="ice_month" sourceGrid="ocean-tripolar">
        <timeSeries freq="monthly" chunkLength="1yr"/>
      </component>
      <component type="iceberg"  start="$(PP_START_YEAR)" source="iceberg_month" sourceGrid="ocean-tripolar">
        <timeSeries freq="monthly" chunkLength="1yr"  source="iceberg_month"/>
      </component>
      <component type="river_daily"   start="$(PP_START_YEAR)" source="river_daily" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="192,384">
        <timeSeries freq="daily" chunkLength="1yr"/>
      </component>
      <component type="river_inst_month"   start="$(PP_START_YEAR)" source="river_month_inst" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="192,384">
        <timeSeries freq="monthly" chunkLength="1yr"/>
      </component>
      <component type="river_static"   start="$(PP_START_YEAR)" source="river_static" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="192,384">
        <timeSeries freq="monthly" chunkLength="1yr"/>
      </component>  
      <component type="river"  start="$(PP_START_YEAR)"  source="river_month" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="192,384">
	<timeSeries freq="monthly" chunkLength="1yr"/>
      </component>
     </postProcess>
  </freInclude>

  <freInclude name="SPEAR_c96_PostP_Historical">
      <postProcess> 
         <csh><![CDATA[
         cd $work/RESTART
         ncrcat icebergs.res.nc.* icebergs.res.nc
         if(-e icebergs.res.nc) rm -f icebergs.res.nc.*
         cd $work
         ncrcat iceberg_trajectories.nc.* iceberg_trajectories.nc
         rm -f iceberg_trajectories.nc.* 
         #Save the last line of timestats without the first (step number) column as a signature of MOM6 answers
         tail -1 timestats | cut -c8- > RESTART/$enddate.timestats.res
         #Save the whole timestats under ascii/
         mv timestats $enddate.timestats
         mv timestats.nc $enddate.timestats.nc

         #Make a directory to trick FRE to pick up and archive in ascii
         mkdir extra.results

         mv *velocity_truncations CPU_stats SIS_parameter_doc* MOM_parameter_doc* seaice.stats timestats ocean.stats *.ocean.stats* extra.results/
         ]]>
         </csh>
      <!--REFINE DIAG SCRIPT -->
      <!--By default a refineDiag script causes the annual data to be unpacked and saved in /ptmp/$USER-->
      <refineDiag script="$(includeDir)/refineDiag/dummy_refineDiag.csh"/>
      <!--MOM6_refineDiag.csh is currently empty and is here only to cause the unpack annual history files in /ptmp-->
      <!--
      <refineDiag script="$(NB_ROOT)/mom6/tools/analysis/MOM6_refineDiag.csh,$(includeDir)/refineDiag/refineDiag_data_stager_globalAve.csh"/>
      -->
      <!-- Tony said to comment this out for now. -->
      <!--PostProcessing component models-->
      <component type="atmos_daily" zInterp="ncep"  start="$(PP_START_YEAR_HIST)"  source="atmos_daily" sourceGrid="atmos-cubedsphere" xyInterp="180,288" >
	<timeSeries freq="daily" source="atmos_daily" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="daily" source="atmos_daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="atmos_4xdaily" zInterp="ncep"   start="$(PP_START_YEAR_HIST)" source="atmos_4xdaily" sourceGrid="atmos-cubedsphere" xyInterp="180,288" >
        <timeSeries freq="6hr" source="atmos_4xdaily" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="6hr" source="atmos_4xdaily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="atmos_4xdaily_avg" zInterp="ncep"   start="$(PP_START_YEAR_HIST)" source="atmos_4xdaily_avg" sourceGrid="atmos-cubedsphere" xyInterp="180,288" >
        <timeSeries freq="6hr" source="atmos_4xdaily_avg" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="6hr" source="atmos_4xdaily_avg" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="atmos" zInterp="ncep" start="$(PP_START_YEAR_HIST)"  source="atmos_month" sourceGrid="atmos-cubedsphere" xyInterp="180,288" >
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)">
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="$FRE_ANALYSIS_HOME/cjg/stub/cjg_atmos_ts_mon.csh"/>
          <!-- Analysis scripts from Andrew Wittenberg
          annual and seasonal climatology -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja -v tau_x,tau_y,tau_curl,wind_div,ps,t_surf,t_diff,rh_ref,olr,tot_cld,hi_cld,mid_cld,lo_cld,wvp,cwp,u_ref,v_ref,tau_div vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_oaflux"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_cmap_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_gpcp_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_qscat"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a clim -t all,mam,son,djf,jja vs_ersst_v3"/>
          <!-- clim and anomaly stddevs, regressions -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3 -t all -v tau_x,tau_y,tau_curl,wind_div,ps,t_surf,t_diff,rh_ref,olr,tot_cld,hi_cld,mid_cld,lo_cld,wvp,cwp,u_ref,v_ref,tau_div vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3,std -C clim -t all vs_oaflux"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3,std,anom_std -C clim -t all vs_cmap_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3,std,anom_std -C clim -t all vs_gpcp_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a std,anom_std -C clim -t all -v tau_x,tau_y,t_surf vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a std,anom_std -C clim -t all -v tau_x,tau_y,wind vs_qscat"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a anom_regr_nino3,std,anom_std -C clim -t all vs_ersst_v3"/>
          <!-- total correlations with local SST -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all -v tau_x,tau_y,tau_curl,wind_div,ps,t_diff,rh_ref,olr,tot_cld,hi_cld,mid_cld,lo_cld,wvp,cwp,u_ref,v_ref,tau_div vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all vs_oaflux"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all vs_cmap_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all vs_gpcp_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all -v tau_x,tau_y,wind vs_qscat"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -C tot -f 0 -F 0 -t all vs_ersst_v3"/>
          <!-- anomaly correlations with local SST -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all -v tau_x,tau_y,tau_curl,wind_div,ps,t_diff,rh_ref,olr,tot_cld,hi_cld,mid_cld,lo_cld,wvp,cwp,u_ref,v_ref,tau_div vs_era40"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all vs_oaflux"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all vs_cmap_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all vs_gpcp_v2"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all -v tau_x,tau_y,wind vs_qscat"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -n -s -a corr_local_sst -t all vs_ersst_v3"/>
          <!-- wavelet plots of climate indices -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/index/frepp.atw_atmos_ts_monthly_index.csh -n -s -a tave_spectrum vs_obs"/>
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/index/frepp.atw_atmos_ts_monthly_index.csh -n -s -a wavelet_density solo"/>
          <!-- global analysis -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/sfc_ocean/frepp.atw_atmos_ts_monthly_sfc_ocean.csh -a clim -t all -v t_surf -y -90,90,20,1 -N globe -p globe vs_era40"/>
          <!-- Koppen climate types -->
          <analysis switch="$(ANALYSIS_SWITCH)" startYear="$(ANA_START)" endYear="$(ANA_END)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_ts_monthly/koppen/frepp.atw_atmos_ts_monthly_koppen.csh -n -s vs_uea"/>
        </timeSeries>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_C)">
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/bw_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/bw_cru_precip.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/bw_atmos_tauu_atl_pac.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/pjk_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/tk_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/bw/stub/lwh_atmos_av_mon.csh"/> 
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjg/stub/cjg_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/radiation_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/sak_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/sak_lwp_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/sak_precip_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/yim_aer_cld.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/precip_water_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/liquid_cloud_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/ice_cloud_atmos_av_mon.csh"/>
          <analysis switch="$(ANALYSIS_SWITCH)" script="$FRE_ANALYSIS_HOME/cjs/stub/surface_atmos_av_mon.csh"/>
          <!--
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="/home/fms/local/opt/fre-analysis/test/eem/code/pcmdi_metrics/frepp.pcmdi_metrics.atmos.csh -c amip"/>
          -->
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$FRE_ANALYSIS_HOME/eem/code/pcmdi_metrics/frepp.pcmdi_metrics_v1p1p1.atmos.csh -c amip"/>
        </timeAverage>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)">
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="yes" script="/home/atw/fms/diags/atw_atmos_av_annual/column/frepp.atw_atmos_av_annual_column.csh -s solo"/>
        </timeAverage>
      </component>
      <component type="atmos_month_aer"  start="$(PP_START_YEAR_HIST)" source="atmos_month_aer" sourceGrid="atmos-cubedsphere" xyInterp="180,288">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="atmos_scalar" start="$(PP_START_YEAR_HIST)"  source="atmos_scalar">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"  source="atmos_scalar"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" source="atmos_scalar"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"  source="atmos_scalar"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" source="atmos_scalar"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ice_daily" start="$(PP_START_YEAR_HIST)"   source="ice_daily">
	<timeSeries freq="daily" source="ice_daily" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="daily" source="ice_daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ice"  start="$(PP_START_YEAR_HIST)" sourceGrid="ocean-tripolar">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"  source="ice_month"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"  source="ice_month"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)"  source="ice_month"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"  source="ice_month"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"  source="ice_month"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)"  source="ice_month"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="iceberg"  start="$(PP_START_YEAR_HIST)" sourceGrid="ocean-tripolar">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"  source="iceberg_month">
	</timeSeries>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"  source="iceberg_month">
	</timeSeries>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)"  source="iceberg_month">
	</timeSeries>
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_C)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" > 
	</timeSeries>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" > 
	</timeSeries>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" > 
	</timeSeries>
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_C)"/>
      </component>
      <component type="land"  start="$(PP_START_YEAR_HIST)"  source="land_month" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="192,384">
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="land_inst_month"   start="$(PP_START_YEAR_HIST)" source="land_month_inst" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="192,384">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="river"  start="$(PP_START_YEAR_HIST)"  source="river_month" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="192,384">
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="river_inst_month"   start="$(PP_START_YEAR_HIST)" source="river_month_inst" interpMethod="conserve_order1" sourceGrid="land-cubedsphere" xyInterp="192,384">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"/>
	<timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" from="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_scalar" start="$(PP_START_YEAR_HIST)"  source="ocean_scalar_month"  sourceGrid="ocean-tripolar">  
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" />
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_C)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component> 
      <component type="ocean" start="$(PP_START_YEAR_HIST)"   sourceGrid="ocean-tripolar">  
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_month"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_month"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" source="ocean_month"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_C)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component> 
      <component type="ocean_z"   start="$(PP_START_YEAR_HIST)" sourceGrid="ocean-tripolar">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_z_month"> </timeSeries>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_z_month"> </timeSeries>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" source="ocean_z_month">
        <!--
        <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/ice_ocean_SIS/OM4_025/ocn_monthly.frepp"/>
        -->
        </timeSeries>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_C)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_z_month"> </timeSeries>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_z_month"> </timeSeries>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" source="ocean_z_month">
        <!--
        <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/ice_ocean_SIS/OM4_025/ocn_monthly.frepp"/>
        -->
        </timeSeries>  
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="ocean_z_ann"   start="$(PP_START_YEAR_HIST)" source="ocean_z_annual" sourceGrid="ocean-tripolar">
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_z_annual" ></timeSeries> 
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_z_annual" ></timeSeries> 
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" source="ocean_z_annual" ></timeSeries> 
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" >  
        <!--
        <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/ice_ocean_SIS/OM4_025/ocn_annual.frepp"/>
        -->
        </timeAverage>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component>
      <component type="ocean_rho2" start="$(PP_START_YEAR_HIST)" source="ocean_annual_rho2" sourceGrid="ocean-tripolar">  
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_month_rho2"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_month_rho2"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_C)" source="ocean_month_rho2"/>
        <timeAverage source="month" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_C)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_annual_rho2"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_annual_rho2"/>
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_C)" source="ocean_annual_rho2"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)" />
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_C)" />
      </component> 
     </postProcess>
  </freInclude>
    <freInclude name="SIS2_DA">
      <postProcess> 
         <csh><![CDATA[
	 #Take care of iceberg restarts and trajectories
         cd $work/RESTART
      if ( ! -e coupler.res) then
            echo model run is not complete; exiting
            exit
         else
            echo now start data assimilation
         cp /ncrc/home1/Yongfei.Zhang/dart_manhattan/models/sis/shell_scripts/SITDA_H05/assimilate_sic.csh ./assimilate.csh
         csh assimilate.csh >&log.out || exit 12

         cp /ncrc/home1/Yongfei.Zhang/dart_manhattan/models/sis/shell_scripts/SITDA_H05/assimilate_sit.csh ./assimilate.csh
         csh assimilate.csh >&log.out || exit 12
         
         wait
         endif

        
         #Treat icebergs restarts and trajectories
         #Find non-empty iceberg restarts and combine them AND then remove uncombined restarts
         #This should be handled properly by FRE
         #ncrcat icebergs.res.nc.* icebergs.res.nc
      ls icebergs.res.nc.*
     if( ! $status ) then
         which ncdump
         if( $status ) then
           echo ncdump not available! We need to stop the run or the model restarts incorrectly!
           exit 1
         endif

         set non_empty_restarts = ""
         foreach file ( `ls icebergs.res.nc.????` )
            if ( `ncdump -h $file | grep UNLIMITED | awk '{gsub(/\(/," ");print $6}'` ) set non_empty_restarts = "$non_empty_restarts $file"
         end
         if( "$non_empty_restarts" != "" ) then
          ncrcat $non_empty_restarts icebergs.res.nc
          if( ! -e icebergs.res.nc ) then
            echo ERROR: ncrcat did not produce icebergs restart file! We need to stop the run or the model restarts incorrectly!
            exit 1
          endif
         endif

         mkdir hide_from_fre
         mv icebergs.res.nc.* hide_from_fre/
         cd $work
         mkdir hide_from_fre
         ncrcat iceberg_trajectories.nc.* iceberg_trajectories.nc
         mv iceberg_trajectories.nc.* hide_from_fre/
      endif

         cd $work
         #Make a directory to trick FRE to pick up and archive in ascii
         mkdir extra.results
         mv *velocity_truncations MOM_parameter_doc* SIS_parameter_doc* seaice.stats* ocean.stats* extra.results/

         #When the ocean uses a mask_table the ocean_static.nc file produced by the model run has holes in coordinates (geolon,geolat)
         #This causes problems for ferret and python tools for analysis.
         #Copy a non-masked version of ocean_static.nc to be saved as a history file to be used by the analysis scipts . 
         cp $work/INPUT/ocean_static_no_mask_table.nc $work/

         ]]></csh>

      <!--REFINE DIAG SCRIP -->
      <!--By default a refineDiag script causes the annual data to be unpacked and saved in /ptmp/$USER-->
      <refineDiag script="$(NB_ROOT)/mom6/tools/analysis/MOM6_refineDiag.csh  $(NB_ROOT)/mdt_xml/awg_include/refineDiag/refineDiag_data_stager_globalAve.csh"/>

      <!--PostProcessing component models-->
      <component type="ocean_daily"   start="$(PP_START_YEAR)" source="ocean_daily" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_daily"/>
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_daily"/>
      </component>
      <component type="ocean_monthly"   start="$(PP_START_YEAR)" source="ocean_month" sourceGrid="ocean-tripolar">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_month">
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/$(OM4_ANALYSIS)/ocn_monthly.frepp"/>
        </timeSeries>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_month">
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/$(OM4_ANALYSIS)/ocn_monthly.frepp"/>
        </timeSeries> 
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)"/>
      </component>
      <component type="ocean_monthly_z" start="$(PP_START_YEAR)"  source="ocean_month_z" sourceGrid="ocean-tripolar">
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)"/>
      </component>

      <component type="ocean_annual_z" start="$(PP_START_YEAR)" source="ocean_annual_z"  sourceGrid="ocean-tripolar">
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)">
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/$(OM4_ANALYSIS)/ocn_annual_z.frepp"/>
        </timeAverage>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)">
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/$(OM4_ANALYSIS)/ocn_annual_z.frepp"/>
        </timeAverage>
        <timeSeries freq="annual"  chunkLength="$(CHUNK_LENGTH_B)" source="ocean_annual_z"/>	
      </component>

      <component type="ocean_annual" start="$(PP_START_YEAR)"  source="ocean_annual"  sourceGrid="ocean-tripolar"> 
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)">
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/$(OM4_ANALYSIS)/ocn_annual.frepp"/>
        </timeAverage>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)">
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/$(OM4_ANALYSIS)/ocn_annual.frepp"/>
        </timeAverage>
      </component>

      <component type="ocean_annual_rho2"  start="$(PP_START_YEAR)" source="ocean_annual_rho2" sourceGrid="ocean-tripolar">
        <timeSeries freq="monthly"  chunkLength="$(CHUNK_LENGTH_B)" source="ocean_annual_rho2"/>
        <timeSeries freq="annual"   chunkLength="$(CHUNK_LENGTH_B)" source="ocean_annual_rho2"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)"/>
      </component>

      <!--Ocean scalars-->
      <component type="ocean_scalar_monthly" start="$(PP_START_YEAR)" source="ocean_scalar_month" sourceGrid="ocean-tripolar">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_scalar_month"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_B)"/>
      </component>
      
      <component type="ocean_scalar_annual"  start="$(PP_START_YEAR)" source="ocean_scalar_annual" sourceGrid="ocean-tripolar">
        <timeSeries freq="annual"   chunkLength="$(CHUNK_LENGTH_B)" source="ocean_scalar_annual"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)"/>
      </component>

      <!--Ocean regions-->
      <component type="ocean_Barents_opening" source="ocean_Barents_opening" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Bering_Strait" source="ocean_Bering_Strait" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Davis_Strait" source="ocean_Davis_Strait" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Windward_Passage" source="ocean_Windward_Passage" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Denmark_Strait" source="ocean_Denmark_Strait" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Drake_Passage" source="ocean_Drake_Passage" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_English_Channel" source="ocean_English_Channel" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Faroe_Scotland" source="ocean_Faroe_Scotland" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Florida_Bahamas" source="ocean_Florida_Bahamas" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Fram_Strait" source="ocean_Fram_Strait" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Iceland_Faroe_V" source="ocean_Iceland_Faroe_V" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Iceland_Faroe_U" source="ocean_Iceland_Faroe_U" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Indonesian_Throughflow" source="ocean_Indonesian_Throughflow" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Mozambique_Channel" source="ocean_Mozambique_Channel" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Pacific_undercurrent" source="ocean_Pacific_undercurrent" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Taiwan_Luzon" source="ocean_Taiwan_Luzon" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Agulhas_section" source="ocean_Agulhas_section" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Gibraltar_Strait" source="ocean_Gibraltar_Strait" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Iceland_Norway" source="ocean_Iceland_Norway" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>

      <!--ICE-->      
      <component type="ice"  start="$(PP_START_YEAR)"  source="ice_month"  sourceGrid="ocean-tripolar">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"  source="ice_month">
	   <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/tools/analysis/Krasting-SeaIce.csh"/>
	</timeSeries>   
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"  source="ice_month">
           <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/tools/analysis/Krasting-SeaIce.csh"/>
        </timeSeries>
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_A)"/>
	  
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_B)"/>
      </component>
     </postProcess>
   </freInclude>

  <!-- OCEAN  and ICE post-processing-->
   <freInclude name="OM4_postprocess">
      <postProcess> 
         <csh><![CDATA[
	 #Take care of iceberg restarts and trajectories
         cd $work/RESTART
	 if (! -e coupler.res) then
             echo model still running
         else
             cp /ncrc/home2/William.Gregory/DA-ML/DA-ML3.csh .
             csh DA-ML3.csh >&log_CNN.out
             rm log_CNN.out
             rm DA-ML3.csh
         endif

         #Treat icebergs restarts and trajectories
         #Find non-empty iceberg restarts and combine them AND then remove uncombined restarts
         #This should be handled properly by FRE
         #ncrcat icebergs.res.nc.* icebergs.res.nc
      ls icebergs.res.nc.*
      if( ! $status ) then
         which ncdump
         if( $status ) then
           echo ncdump not available! We need to stop the run or the model restarts incorrectly!
           exit 1
         endif

         set non_empty_restarts = ""
         foreach file ( `ls icebergs.res.nc.????` )
            if ( `ncdump -h $file | grep UNLIMITED | awk '{gsub(/\(/," ");print $6}'` ) set non_empty_restarts = "$non_empty_restarts $file"
         end
         if( "$non_empty_restarts" != "" ) then
          ncrcat $non_empty_restarts icebergs.res.nc
          if( ! -e icebergs.res.nc ) then
            echo ERROR: ncrcat did not produce icebergs restart file! We need to stop the run or the model restarts incorrectly!
            exit 1
          endif
         endif

         mkdir hide_from_fre
         mv icebergs.res.nc.* hide_from_fre/
         cd $work
         mkdir hide_from_fre
         ncrcat iceberg_trajectories.nc.* iceberg_trajectories.nc
         mv iceberg_trajectories.nc.* hide_from_fre/
      endif

         cd $work
         #Make a directory to trick FRE to pick up and archive in ascii
         mkdir extra.results
         mv *velocity_truncations MOM_parameter_doc* SIS_parameter_doc* seaice.stats* ocean.stats* extra.results/

         #When the ocean uses a mask_table the ocean_static.nc file produced by the model run has holes in coordinates (geolon,geolat)
         #This causes problems for ferret and python tools for analysis.
         #Copy a non-masked version of ocean_static.nc to be saved as a history file to be used by the analysis scipts . 
         cp $work/INPUT/ocean_static_no_mask_table.nc $work/

         ]]></csh>

      <!--REFINE DIAG SCRIP -->
      <!--By default a refineDiag script causes the annual data to be unpacked and saved in /ptmp/$USER-->
      <!--refineDiag script="$(NB_ROOT)/mom6/tools/analysis/MOM6_refineDiag.csh  $(NB_ROOT)/mdt_xml/awg_include/refineDiag/refineDiag_data_stager_globalAve.csh"/-->
      <refineDiag script="/home/l1j/bin/SPEAR/X1Y_refineDiag_segLength.csh"/>

      <!--PostProcessing component models-->
      <component type="ocean_daily"   start="$(PP_START_YEAR)" source="ocean_daily" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_daily"/>
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_daily"/>
      </component>
      <component type="ocean_monthly"   start="$(PP_START_YEAR)" source="ocean_month" sourceGrid="ocean-tripolar">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_month">
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/$(OM4_ANALYSIS)/ocn_monthly.frepp"/>
        </timeSeries>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_month">
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/$(OM4_ANALYSIS)/ocn_monthly.frepp"/>
        </timeSeries> 
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)"/>
      </component>
      <component type="ocean_monthly_z" start="$(PP_START_YEAR)"  source="ocean_month_z" sourceGrid="ocean-tripolar">
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)"/>
      </component>

      <component type="ocean_annual_z" start="$(PP_START_YEAR)" source="ocean_annual_z"  sourceGrid="ocean-tripolar">
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)">
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/$(OM4_ANALYSIS)/ocn_annual_z.frepp"/>
        </timeAverage>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)">
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/$(OM4_ANALYSIS)/ocn_annual_z.frepp"/>
        </timeAverage>
        <timeSeries freq="annual"  chunkLength="$(CHUNK_LENGTH_B)" source="ocean_annual_z"/>	
      </component>

      <component type="ocean_annual" start="$(PP_START_YEAR)"  source="ocean_annual"  sourceGrid="ocean-tripolar"> 
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)">
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/$(OM4_ANALYSIS)/ocn_annual.frepp"/>
        </timeAverage>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)">
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/$(OM4_ANALYSIS)/ocn_annual.frepp"/>
        </timeAverage>
      </component>

      <component type="ocean_annual_rho2"  start="$(PP_START_YEAR)" source="ocean_annual_rho2" sourceGrid="ocean-tripolar">
        <timeSeries freq="monthly"  chunkLength="$(CHUNK_LENGTH_B)" source="ocean_annual_rho2"/>
        <timeSeries freq="annual"   chunkLength="$(CHUNK_LENGTH_B)" source="ocean_annual_rho2"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)"/>
      </component>

      <!--Ocean scalars-->
      <component type="ocean_scalar_monthly" start="$(PP_START_YEAR)" source="ocean_scalar_month" sourceGrid="ocean-tripolar">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_scalar_month"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_B)"/>
      </component>
      
      <component type="ocean_scalar_annual"  start="$(PP_START_YEAR)" source="ocean_scalar_annual" sourceGrid="ocean-tripolar">
        <timeSeries freq="annual"   chunkLength="$(CHUNK_LENGTH_B)" source="ocean_scalar_annual"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)"/>
      </component>

      <!--Ocean regions-->
      <component type="ocean_Barents_opening" source="ocean_Barents_opening" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Bering_Strait" source="ocean_Bering_Strait" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Davis_Strait" source="ocean_Davis_Strait" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Windward_Passage" source="ocean_Windward_Passage" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Denmark_Strait" source="ocean_Denmark_Strait" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Drake_Passage" source="ocean_Drake_Passage" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_English_Channel" source="ocean_English_Channel" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Faroe_Scotland" source="ocean_Faroe_Scotland" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Florida_Bahamas" source="ocean_Florida_Bahamas" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Fram_Strait" source="ocean_Fram_Strait" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Iceland_Faroe_V" source="ocean_Iceland_Faroe_V" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Iceland_Faroe_U" source="ocean_Iceland_Faroe_U" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Indonesian_Throughflow" source="ocean_Indonesian_Throughflow" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Mozambique_Channel" source="ocean_Mozambique_Channel" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Pacific_undercurrent" source="ocean_Pacific_undercurrent" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Taiwan_Luzon" source="ocean_Taiwan_Luzon" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Agulhas_section" source="ocean_Agulhas_section" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Gibraltar_Strait" source="ocean_Gibraltar_Strait" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Iceland_Norway" source="ocean_Iceland_Norway" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>

      <!--ICE-->      
      <component type="ice"  start="$(PP_START_YEAR)"  source="ice_month"  sourceGrid="ocean-tripolar">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"  source="ice_month">
	   <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/tools/analysis/Krasting-SeaIce.csh"/>
	</timeSeries>   
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"  source="ice_month">
           <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/tools/analysis/Krasting-SeaIce.csh"/>
        </timeSeries>
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_A)"/>
	  
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_B)"/>
      </component>
     </postProcess>
   </freInclude>


<experiment name="OM4_1deg_JRA_SICDA-ML2_F02" inherit="OM4_1deg_K_nonsymMOM6_ens_exec_OM4_noleap_sstrest_Mar2022">
  <description>
    SIC DA with SST restoring; production run; the same setting as OM4_1deg_JRA_SICDA_F02 but with new ensemble and JRA forcing
  </description>

  <executable file="/lustre/f2/dev/gfdl/Yongfei.Zhang/SPEAR_experiments_K_xanadu/OM4_1deg_K_nonsymMOM6_ens_exec_OM4_noleap_sstrest_Mar2022/ncrc4.intel18-repro-openmp/exec/fms_OM4_1deg_K_nonsymMOM6_ens_exec_OM4_noleap_sstrest_Mar2022.x"/>

  <input>
      <namelist file="$(includeDir)/nml/MOM6_g12.nml"/>
<!--      <namelist file="$(includeDir)/nml/am4p0_common.nml"/> -->
      <namelist file="$(includeDir)/nml/am4p0_physics.nml"/>
<!--      <namelist file="$(includeDir)/nml/am4p0_c96L33.nml"/>
         <namelist file="$(includeDir)/nml/am4p0_1850climo.nml"/> -->
      <namelist name="xgrid_nml">
        make_exchange_reproduce = .true.
        interp_method = 'second_order'
      </namelist> 
      <namelist name="ensemble_nml">
        ensemble_size=30
      </namelist>
      <namelist name="icebergs_nml">
        make_calving_reproduce=.TRUE.
        really_debug=.FALSE.
        debug=.FALSE.
        verbose=.FALSE.
        verbose_hrs=7200
        use_operator_splitting=.TRUE.
        bergy_bit_erosion_fraction=0.0
        sicn_shift=0.1
        parallel_reprod=.TRUE.
        traj_sample_hrs=0
        add_weight_to_ocean=.false.
        tidal_drift = 0.005
        coastal_drift = 0.001
      </namelist>


      <namelist name="coupler_nml">
        do_chksum = .false.
        months = $months,
        days   = $days,
        current_date = 2018,1,1,0,0,0,
        calendar = 'noleap',
        dt_cpld = 1800,
        dt_atmos = 1800,
        do_atmos = .false.,
        do_land = .false.,
        do_ice = .true.,
        do_ocean = .true.,
        atmos_npes = 0
        atmos_nthreads = $atm_threads
        do_concurrent_radiation=.false.
        radiation_nthreads = 1
        ocean_npes = $ocn_ranks,
        concurrent = .false.
        use_lag_fluxes=.false.
        check_stocks=0
        ncores_per_node = $(NCORE_PER_NODE)
      </namelist>

      <namelist name="fms_io_nml">
        threading_read  = 'multi',
        max_files_r = 200,
        max_files_w = 200,
        checksum_required =.false.
     </namelist>
       <namelist name="diag_manager_nml">
        mix_snapshot_average_fields = .false.,
        max_input_fields = 1200,
        max_output_fields = 1800
        max_axes = 400
        max_num_axis_sets = 400
        max_files = 400
        issue_oor_warnings = .false.
        max_axis_attributes=4
</namelist>
     <namelist name="atmos_model_nml" >
       layout= 0, 0
     </namelist>
      <namelist name="fms_nml">
            clock_grain='ROUTINE'
            clock_flags='NONE'
            domains_stack_size = 8000000
            stack_size =0
      </namelist>
     <namelist name="sat_vapor_pres_nml">
      construct_table_wrt_liq = .true.,
      construct_table_wrt_liq_and_ice = .true.,
     </namelist>
     <namelist name="monin_obukhov_nml">
            neutral = .true.
     </namelist>
     <namelist name="ocean_rough_nml">
            rough_scheme = 'beljaars'
     </namelist>
     <namelist name="surface_flux_nml">
            ncar_ocean_flux = .true.
        raoult_sat_vap = .true.
     </namelist>
     <namelist name="ocean_albedo_nml">
         ocean_albedo_option = 2
     </namelist>
     <namelist name="MOM_input_nml">
         output_directory = './',
         input_filename = '$restart_flag'
         restart_input_dir = 'INPUT/',
         restart_output_dir = 'RESTART/',
         parameter_filename = 'INPUT/MOM_input','INPUT/MOM_layout','INPUT/MOM_saltrestore','INPUT/MOM_override'
     </namelist>

      <namelist name="SIS_input_nml">
         output_directory = './',
         input_filename = '$restart_flag'
         restart_input_dir = 'INPUT/',
         restart_output_dir = 'RESTART/',
         parameter_filename = 'INPUT/SIS_input','INPUT/SIS_layout','INPUT/SIS_override_%E'
	</namelist>
     <dataFile label="fieldTable" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$(includeDir)/field_table/field_table_am4p11</dataSource>
     </dataFile>
     <dataFile label="initCond" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource site="ncrc">/lustre/f2/dev/William.Gregory/initCond_SPEAR/REMAP/OM4_1deg_JRA_SICDA_F02/20180101.tar</dataSource> 
       <dataSource site="gfdl">/archive/William.Cooke/pdata/gfdl_G/SPEAR_c96/initCond/C96_LM3_OM4_01_CanadianArchipelago.remapped.v20171217.tar</dataSource>
     </dataFile> 
     <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">/lustre/f2/dev/William.Cooke/initCond_LOAR/LOAR4/TOPODRAG_SETUP/c96/topoC96_rough_land.tar</dataSource>
     </dataFile>
     <diagTable>
$name
$baseDate
      </diagTable>
<!--      <dataFile label="diagTable" target="INPUT/" chksum="" size="" timestamp="">
         <dataSource platform="$(platform)">$(includeDir)/diag_table/diag_table_SPEAR_Control_nodaily</dataSource>
      </dataFile>-->
           <!--data_tables and data files-->
     <!--JRA forcing-->
     <xi:include xpointer="xpointer(//freInclude[@name='JRA_data_table']/input/node())"/>
     <!--append the resolution dependent runoff override-->
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
         <!--<dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_05/INPUT/runoff.daitren.clim.v2011.02.10a.720x576.nc</dataSource> 
         <dataSource platform="$(platform)">/lustre/f2/dev/Amy.Langenhorst/CORE/IAF_v2.0/runoff.daitren.iaf.10FEB2011.nc</dataSource>-->
         <dataSource platform="$(platform)">/lustre/f2/dev/Yongfei.Zhang/CORE/IAF_v2.0/runoff.daitren.iaf.1948-2007.regridded.nc</dataSource>
         <dataSource platform="$(platform)">/lustre/f2/dev/Yongfei.Zhang/CORE/IAF_v2.0/runoff_2017_11_30_modbegin_1958.nc</dataSource>

      </dataFile>
      <dataFile label="gridSpec" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource site="ncrc">/lustre/f2/dev/William.Cooke/MOM6_datasets/C96.OM360x320.20171213/mosaic.tar</dataSource>
        <dataSource site="gfdl">/archive/William.Cooke/gold/datasets/SPEAR/C96.OM360x320.20171213/mosaic.tar</dataSource> 
      </dataFile>
      <dataFile label="input" target="INPUT/land_domain.nc" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">/lustre/f2/dev/William.Cooke/initCond_LOAR/LOAR4/c96_MOM61deg/LOAR4_C13_land_domain.nc</dataSource>
      </dataFile>
      <xi:include xpointer="xpointer(//freInclude[@name='common_LM4']/input/node())"/>
      <xi:include xpointer="xpointer(//freInclude[@name='c96_LM4_SPEAR']/input/node())"/>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource site="ncrc">/lustre/f2/dev/William.Cooke/MOM6_datasets/C96.OM360x320.20171213/SPEAR_c96_hydrography.tar</dataSource>
        <dataSource site="gfdl">/archive/William.Cooke/gold/datasets/LOAR4/C96.OM360x320.112816/SPEAR_c96_hydrography.tar</dataSource> 
      </dataFile>
      <xi:include xpointer="xpointer(//freInclude[@name='common_AM4_v20170208']/input/node())"/>
      <xi:include xpointer="xpointer(//freInclude[@name='common_cmip6']/input/node())"/>
      <xi:include xpointer="xpointer(//freInclude[@name='Volcano_Solar_1850_cmip6']/input/node())"/>
      <xi:include xpointer="xpointer(//freInclude[@name='emissions_cmip6_v20161213']/input/node())"/>
      <xi:include xpointer="xpointer(//freInclude[@name='c96_stack_size']/input/node())"/>
      <xi:include xpointer="xpointer(//freInclude[@name='csh_adjust_dry_mass']/input/node())"/>
      <xi:include xpointer="xpointer(//freInclude[@name='SPEAR_domain_decomp']/input/node())"/>
      <!--MOM6 Input datasets-->
      <xi:include xpointer="xpointer(//freInclude[@name='FLOR2_MOM6_data']/input/node())"/> 
           <diagTable>
"ocean_5daily",            5, "days",   1, "days", "time"
"ocean_model", "SSU",          "ssu",              "ocean_5daily", "all", "mean", "none",2
"ocean_model", "SSV",          "ssv",              "ocean_5daily", "all", "mean", "none",2
"ocean_model", "tos",          "tos",              "ocean_5daily", "all", "mean", "none",2
"ocean_model", "sos",          "sos",              "ocean_5daily", "all", "mean", "none",2

"ocean_daily",            1, "days", 1,"days","time"
"ocean_model", "heat_added",   "heat_added",        "ocean_daily",  "all", "mean", "none",2
"ocean_model", "zos",          "zos",              "ocean_5daily", "all", "mean", "none",2

#===============================================================================
# ICE DIAGNOSTICS:
#=============================================================================== 
"ice_daily",              1, "days", 1, "days", "time"
"ice_model", "siu",        "siu",          "ice_daily", "all", "mean", "none", 2
"ice_model", "siv",        "siv",          "ice_daily", "all", "mean", "none", 2
"ice_model", "siconc",     "siconc",       "ice_daily", "all", "mean", "none", 2
"ice_model", "sisnconc",   "sisnconc",     "ice_daily", "all", "mean", "none", 2
"ice_model", "simass",     "simass",       "ice_daily", "all", "mean", "none", 2
"ice_model", "simass_n",     "simass_n",       "ice_daily", "all", "mean", "none", 2
"ice_model", "sisnmass",   "sisnmass",     "ice_daily", "all", "mean", "none", 2
"ice_model", "sisnthick",  "sisnthick",    "ice_daily", "all", "mean", "none", 2
"ice_model", "sithick",    "sithick",      "ice_daily", "all", "mean", "none", 2
"ice_model", "sivol",      "sivol",        "ice_daily", "all", "mean", "none", 2
"ice_model", "sispeed",    "sispeed",      "ice_daily", "all", "mean", "none", 2
"ice_model", "STRENGTH_hf","STRENGTH_hf",  "ice_daily", "all", "mean", "none", 2
"ice_model", "sitimefrac", "sitimefrac",   "ice_daily", "all", "mean", "none", 2
"ice_model", "sitemptop",  "sitemptop",    "ice_daily", "all", "mean", "none", 2
"ice_model", "MIB",        "MIB",          "ice_daily", "all", "mean", "none", 2
"ice_model", "ALB",        "ALB",        "ice_daily", "all", .true., "none", 2
"ice_model", "BHEAT",      "BHEAT",      "ice_daily", "all", .true., "none", 2
"ice_model", "BMELT",      "BMELT",      "ice_daily", "all", .true., "none", 2
"ice_model", "BSNK",       "BSNK",       "ice_daily", "all", .true., "none", 2
"ice_model", "CALVING",    "CALVING",    "ice_daily", "all", .true., "none", 2
"ice_model", "CALVING_HFLX","CALVING_HFLX","ice_daily", "all", "mean", "none", 2
"ice_model", "CELL_AREA",  "CELL_AREA",  "ice_daily", "all", .false., "none", 2
"ice_model", "CN",         "CN",         "ice_daily", "all", .true., "none", 2
"ice_model", "COSROT",     "COSROT",     "ice_daily", "all", .false., "none", 2
"ice_model", "E2MELT",     "E2MELT",       "ice_daily", "all", "mean", "none", 2
"ice_model", "EVAP",       "EVAP",         "ice_daily", "all", "mean", "none", 2
"ice_model", "EXT",        "EXT",          "ice_daily", "all", "mean", "none", 2
"ice_model", "EXT",        "EXT_max",    "ice_daily", "all",  max,   "none", 2
"ice_model", "EXT",        "EXT_min",    "ice_daily", "all",  min,   "none", 2
"ice_model", "FA_X",       "FA_X",       "ice_daily", "all", .true., "none", 2
"ice_model", "FA_Y",       "FA_Y",       "ice_daily", "all", .true., "none", 2
"ice_model", "FI_X",       "FI_X",       "ice_daily", "all", .true., "none", 2
"ice_model", "FI_Y",       "FI_Y",       "ice_daily", "all", .true., "none", 2
"ice_model", "FRAZIL",     "FRAZIL",     "ice_daily", "all", .true., "none", 2
"ice_model", "GEOLAT",     "GEOLAT",     "ice_daily", "all", .false., "none", 2
"ice_model", "GEOLON",     "GEOLON",     "ice_daily", "all", .false., "none", 2
"ice_model", "HI",         "HI",         "ice_daily", "all", .true., "none", 2
"ice_model", "HS",         "HS",         "ice_daily", "all", .true., "none", 2
"ice_model", "IX_TRANS",   "IX_TRANS",   "ice_daily", "all", .true., "none", 2
"ice_model", "IY_TRANS",   "IY_TRANS",   "ice_daily", "all", .true., "none", 2
"ice_model", "LH",         "LH",         "ice_daily", "all", .true., "none", 2
"ice_model", "LSNK",       "LSNK",       "ice_daily", "all", .true., "none", 2
"ice_model", "LSRC",       "LSRC",       "ice_daily", "all", .true., "none", 2
"ice_model", "LW",         "LW",         "ice_daily", "all", .true., "none", 2
"ice_model", "MI",         "MI",         "ice_daily", "all", .true., "none", 2
"ice_model", "RAIN",       "RAIN",       "ice_daily", "all", .true., "none", 2
"ice_model", "RUNOFF",     "RUNOFF",     "ice_daily", "all", .true., "none", 2
"ice_model", "SALTF",      "SALTF",      "ice_daily", "all", .true., "none", 2
"ice_model", "SH",         "SH",         "ice_daily", "all", .true., "none", 2
"ice_model", "SINROT",     "SINROT",     "ice_daily", "all", .false., "none", 2
"ice_model", "SN2IC",      "SN2IC",      "ice_daily", "all", .true., "none", 2
"ice_model", "SNOWFL",     "SNOWFL",     "ice_daily", "all", .true., "none", 2
"ice_model", "SSH",        "SSH",        "ice_daily", "all", .true., "none", 2
"ice_model", "SSS",        "SSS",        "ice_daily", "all", .true., "none", 2
"ice_model", "SST",        "SST",        "ice_daily", "all", .true., "none", 2
"ice_model", "SW",         "SW",         "ice_daily", "all", .true., "none", 2
"ice_model", "T1",         "T1",         "ice_daily", "all", .true., "none", 2
"ice_model", "T2",         "T2",         "ice_daily", "all", .true., "none", 2
"ice_model", "T3",         "T3",         "ice_daily", "all", .true., "none", 2
"ice_model", "T4",         "T4",         "ice_daily", "all", .true., "none", 2
"ice_model", "TMELT",      "TMELT",      "ice_daily", "all", .true., "none", 2
"ice_model", "TS",         "TS",         "ice_daily", "all", .true., "none", 2
"ice_model", "UI",         "UI",         "ice_daily", "all", .true., "none", 2
"ice_model", "UO",         "UO",         "ice_daily", "all", .true., "none", 2
"ice_model", "VI",         "VI",         "ice_daily", "all", .true., "none", 2
"ice_model", "VO",         "VO",         "ice_daily", "all", .true., "none", 2
"ice_model", "XPRT",       "XPRT",       "ice_daily", "all", .true., "none", 2

 
     </diagTable>
      <!-- overwrite  Channels file -->
      <dataFile label="input" target="INPUT/MOM_channels_SPEAR" chksum="" size="" timestamp="">
        <dataSource site="ncrc">/ncrc/home2/William.Cooke/MOM_channels_SPEAR_20180119</dataSource>
        <dataSource site="gfdl">/archive/William.Cooke/pdata/gfdl_G/SPEAR_MOM6/datasets/MOM_channels_SPEAR_20180119</dataSource>
      </dataFile>
      <!--MOM6 Input datasets-->
      <xi:include xpointer="xpointer(//freInclude[@name='MOM6_data']/input/node())"/>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource site="ncrc">$(includeDir)/ice_ocean_SIS2/OM4_025/INPUT/hycom1_75_800m.nc</dataSource>
      </dataFile>
      <!-- Override the MOM_input in the MOM6_data xi include above --> 
      <dataFile label="input" target="INPUT/MOM_input" chksum="" size="" timestamp="">
         <dataSource site="ncrc">/ncrc/home1/Yongfei.Zhang/xml/SPEAR_include/MOM_input_C39_init</dataSource>
         <dataSource site="gfdl">/archive/William.Cooke/pdata/gfdl_G/SPEAR_MOM6/datasets/MOM_input_C39_init</dataSource>
      </dataFile>
      <!--SIS Input datasets-->
      <xi:include xpointer="xpointer(//freInclude[@name='SIS2_data']/input/node())"/>
      <dataFile label="input" target="INPUT/SIS_input" chksum="" size="" timestamp="">
         <dataSource site="ncrc">/lustre/f2/dev/William.Cooke/MOM6_datasets/LOAR4/SIS_input_C39_init</dataSource>
         <dataSource site="gfdl">/archive/William.Cooke/pdata/gfdl_G/SPEAR_MOM6/datasets/SIS_input_C39_init</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/KH_background_2d.nc">
         <dataSource site="ncrc">/lustre/f2/dev/William.Cooke/MOM6_datasets/Kh_BG_2D/Kh_background_5e3_50to90ns.nc</dataSource>
         <dataSource site="gfdl">/archive/William.Cooke/pdata/gfdl_G/SPEAR_MOM6/datasets/Kh_background_5e3_50to90ns.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/">
         <dataSource site="ncrc">/ncrc/home2/William.Cooke/decadal/topo_edits_011818.nc</dataSource>
         <dataSource site="gfdl">/archive/William.Cooke/pdata/gfdl_G/SPEAR_MOM6/topo/topo_edits_011818.nc</dataSource>
      </dataFile>
      <csh type="always"><![CDATA[
######BEGIN MOM6 and SIS2 layout setup################
##THIS HAS TO BE PART OF csh type=always###

touch $work/INPUT/MOM_override

cat > $work/INPUT/MOM_override << EOF
#override TOPO_EDITS_FILE = "topo_edits_011818.nc"
#override CHANNEL_LIST_FILE = MOM_channels_SPEAR
#override SALT_RESTORE_FILE = "salt_restore_PHC2.1degOM4.v20180716.nc"
#override FLUX_SST_CONST = 4.0
#override RESTORE_TEMPERATURE = TRUE
#override SST_RESTORE_FILE  = "temp_restore.nc" 
#override SST_RESTORE_VARIABLE = "temp"

NUM_DIAG_COORDS = 2             ! default = 1
                                ! The number of diagnostic vertical coordinates to use.
                                ! For each coordinate, an entry in DIAG_COORDS must be provided.
DIAG_COORDS = "z Z ZSTAR", "rho2 RHO2 RHO" !

DIAG_COORD_DEF_RHO2 = "RFNC1:35,999.5,1028,1028.5,8.,1038.,0.0078125" ! default = "WOA09"
                                ! Determines how to specify the coordinate
                                ! resolution. Valid options are:
                                !  PARAM       - use the vector-parameter DIAG_COORD_RES_RHO2
                                !  UNIFORM[:N] - uniformly distributed
                                !  FILE:string - read from a file. The string specifies
                                !                the filename and variable name, separated
                                !                by a comma or space, e.g. FILE:lev.nc,dz
                                !                or FILE:lev.nc,interfaces=zw
                                !  WOA09[:N]   - the WOA09 vertical grid (approximately)
                                !  FNC1:string - FNC1:dz_min,H_total,power,precision
                                !  HYBRID:string - read from a file. The string specifies
                                !                the filename and two variable names, separated
                                !                by a comma or space, for sigma-2 and dz. e.g.
                                !                HYBRID:vgrid.nc,sigma2,dz

EOF

# SIS_override_X is created offline and copied to the inputDir
cp /lustre/f2/dev/Yongfei.Zhang/SIS_overrides/combo_new/SIS_override_* $work/INPUT/

cat > $work/INPUT/MOM_layout << MOM_LAYOUT_EOF
#override IO_LAYOUT = $ocn_io_layout
#override LAYOUT    = $ocn_layout
#override MASKTABLE = $ocn_mask_table
MOM_LAYOUT_EOF

#scan auxiliary_nml
#set ICE_MASK_TABLE = `awk '/ice_mask_table/ {gsub(/=/," ");gsub(/,/," ");print $2}' $work/input.nml`
#set ICE_LAYOUT     = `awk '/ice_layout/     {gsub(/=/," ");           print $2,$3}' $work/input.nml`
#set ICE_IO_LAYOUT  = `awk '/ice_io_layout/  {gsub(/=/," ");           print $2,$3}' $work/input.nml`

cat > $work/INPUT/SIS_layout << SIS_LAYOUT_EOF
#override IO_LAYOUT = $ice_io_layout
#override LAYOUT    = $ice_layout
#override MASKTABLE = $ocn_mask_table
SIS_LAYOUT_EOF

######END MOM6 and SIS2 layout setup################

cd $work/INPUT

if ( $currentSeg == 1 ) then
     rm -f coupler.res
endif
cd $work

#------------------------------------------
## Find out whether to restart.
# MOM6 restart switch
if ( $currentSeg == 1 ) then
   set restart_flag = 'n'
else
   set restart_flag = 'r'
endif
   set restart_flag = 'r'
   set sis_restart_flag = 'r'
cd $work

#######IAF cycle mechanism
if ( $currentSeg == 1 ) then
   set fyear = 2018
endif
echo "Model year = $fyear"
#Current JRA dataset starts at 1958 and ends at 2018
#These numbers should be adjusted when the datasets start or length changes.
set JRA_START_YEAR = 2018
set JRA_LEN = 1
@ modulyr = ( $fyear - $JRA_START_YEAR ) % $JRA_LEN
@ forceyr = $JRA_START_YEAR + $modulyr
if ( $modulyr < 0 ) then
   @ forceyr = $forceyr + $JRA_LEN
endif
echo "Forcings file year = $forceyr"
@ forceyrp1 = $forceyr + 1

cd $work/INPUT/
ln -sf /lustre/f2/dev/Yongfei.Zhang/JRA55/huss_input4MIPs_atmosphericState_OMIP_MRI-JRA55-do_gr_${forceyr}.padded.nc JRA_huss.nc
ln -sf /lustre/f2/dev/Yongfei.Zhang/JRA55/prra_input4MIPs_atmosphericState_OMIP_MRI-JRA55-do_gr_${forceyr}.padded.nc JRA_prra.nc
ln -sf /lustre/f2/dev/Yongfei.Zhang/JRA55/prsn_input4MIPs_atmosphericState_OMIP_MRI-JRA55-do_gr_${forceyr}.padded.nc JRA_prsn.nc
ln -sf /lustre/f2/dev/Yongfei.Zhang/JRA55/psl_input4MIPs_atmosphericState_OMIP_MRI-JRA55-do_gr_${forceyr}.padded.nc JRA_psl.nc
ln -sf /lustre/f2/dev/Yongfei.Zhang/JRA55/rlds_input4MIPs_atmosphericState_OMIP_MRI-JRA55-do_gr_${forceyr}.padded.nc JRA_rlds.nc
ln -sf /lustre/f2/dev/Yongfei.Zhang/JRA55/rsds_input4MIPs_atmosphericState_OMIP_MRI-JRA55-do_gr_${forceyr}.padded.nc JRA_rsds.nc
ln -sf /lustre/f2/dev/Yongfei.Zhang/JRA55/tas_input4MIPs_atmosphericState_OMIP_MRI-JRA55-do_gr_${forceyr}.padded.nc JRA_tas.nc
ln -sf /lustre/f2/dev/Yongfei.Zhang/JRA55/uas_input4MIPs_atmosphericState_OMIP_MRI-JRA55-do_gr_${forceyr}.padded.nc JRA_uas.nc
ln -sf /lustre/f2/dev/Yongfei.Zhang/JRA55/vas_input4MIPs_atmosphericState_OMIP_MRI-JRA55-do_gr_${forceyr}.padded.nc JRA_vas.nc
ln -sf /lustre/f2/dev/gfdl/Xiaosong.Yang/restoring_SST_SPEAR/OISST_v2_highres/ice_corrected/SPEAR_lo_grid/sst_oidaily_icecorr_icec30_fill_${forceyr}.nc temp_restore.nc

cd $work
## Run the model
#------------------------------------------
###The following vars are set for the timing database ingestion tool only and are not necessary for a successful run
set OCN_MASK_TABLE  =  $ocn_mask_table
set OCN_LAYOUT    = $ocn_layout
set OCN_IO_LAYOUT = $ocn_io_layout
set ICE_LAYOUT    = $ice_layout
set ICE_IO_LAYOUT = $ice_io_layout
set atmos_npes = $atm_ranks
set ocean_npes = $ocn_ranks
set fv_layout = $atm_layout
set fv_io_layout  = $atm_io_layout
set land_layout   = $lnd_layout
set land_io_layout = $lnd_io_layout
set dummy  = `awk '/nxblocks/ {gsub(/=/," ");gsub(/,/," ");print $2}' $work/input.nml`
set nxblocks = $dummy
set dummy  = `awk '/nyblocks/ {gsub(/=/," ");gsub(/,/," ");print $2}' $work/input.nml`
set nyblocks = $dummy
]]>
    </csh>
  </input>
  <runtime>
    <production simTime="14" units="years" >
      <segment simTime="1" units="years"/>
      <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_O72_production']/node())"/>
    </production> 
      <regression name="debug_216">
        <run days="1" >
          <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A144x1_O72_debug']/node())"/>
          </run>
      </regression>
      <regression name="oneyear">
        <run months="12" >
      <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A288x2_O180_long']/node())"/>
        </run>
      </regression>
      <regression name="oneday_coldstart">
        <run days="1" >
      <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A288x2_O180']/node())"/>
        </run>
      </regression>
      <regression name="basic_prodsettings">
        <run days="5" >
      <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_O72']/node())"/>
        </run>
      </regression>
      <regression name="basic_debug">
        <run days="2" >
      <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_O32']/node())"/>
        </run>
      </regression>
      <regression name="test_albedo">
        <run months="12"
        overrideParams="atmos_model_nml:nxblocks=2;
                             atmos_model_nml:nyblocks=2;
                             ocean_albedo_nml:ocean_albedo_option=1;
                             fms_nml:clock_grain='ROUTINE';
                             random_number_streams_nml:force_use_of_temp_for_seed=.TRUE.;
                             icebergs_nml:make_calving_reproduce=.TRUE.;
                             xgrid_nml:make_exchange_reproduce=.TRUE.;">
      <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A288x2_O180']/node())"/>
        </run>
        <run months="12"
        overrideParams="atmos_model_nml:nxblocks=2;
                             atmos_model_nml:nyblocks=2;
                             ocean_albedo_nml:ocean_albedo_option=3;
                             fms_nml:clock_grain='ROUTINE';
                             random_number_streams_nml:force_use_of_temp_for_seed=.TRUE.;
                             icebergs_nml:make_calving_reproduce=.TRUE.;
                             xgrid_nml:make_exchange_reproduce=.TRUE.;">
      <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A288x2_O180']/node())"/>
        </run>
      </regression>
      <regression name="spinup_prodsettings">
        <run months="3" >
      <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A288x2_O180']/node())"/>
        </run>
      </regression>
      <xi:include xpointer="xpointer(//freInclude[@name='regression_OMP_c96']/runtime/node())"/>
      <regression name="rts_2day">
          <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A108x2_O216_rts_1x2day']/node())"/>
          <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_A108x2_O216_rts_2x1day']/node())"/>
      </regression>
  </runtime>
  <postProcess>
      <xi:include xpointer="xpointer(//freInclude[@name='OM4_postprocess']/postProcess/node())"/>
  </postProcess>
</experiment>



</experimentSuite>
